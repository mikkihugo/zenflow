{
  "key": "dc21ccb5a9093803d69d97286dbd8203",
  "value": [
    {
      "rule": "C003",
      "line": 103,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__result' uses uncommon abbreviation and double underscore prefix.",
      "suggestion": "Rename '__result' to 'queryResult' or 'result'.",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C003",
      "line": 182,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__cutoffTime' uses uncommon abbreviation and double underscore prefix.",
      "suggestion": "Rename '__cutoffTime' to 'cutoffTime'.",
      "codeSnippet": "let params:unknown = {};",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C003",
      "line": 183,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__result' uses uncommon abbreviation and double underscore prefix.",
      "suggestion": "Rename '__result' to 'deleteResult' or 'result'.",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C003",
      "line": 216,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__basicStats' uses uncommon abbreviation and double underscore prefix.",
      "suggestion": "Rename '__basicStats' to 'basicStats'.",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C003",
      "line": 222,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__domainsResult' uses uncommon abbreviation and double underscore prefix.",
      "suggestion": "Rename '__domainsResult' to 'domainsResult'.",
      "codeSnippet": "if (query.maxAge !== undefined) {",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 152,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context for error in 'cleanup'.",
      "suggestion": "Log error stack and relevant context (e.g., maxAge) in catch block.",
      "codeSnippet": "return null;",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 169,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context for error in 'getStats'.",
      "suggestion": "Log error stack and relevant context in catch block.",
      "codeSnippet": "lastAccessed:row.last_accessed,",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 185,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context for error in 'clearByQuality'.",
      "suggestion": "Log error stack and relevant context (e.g., minQuality) in catch block.",
      "codeSnippet": "// Use full-text search",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 201,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context for error in 'clearByAge'.",
      "suggestion": "Log error stack and relevant context (e.g., maxAgeMs) in catch block.",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S001",
      "line": 109,
      "column": 0,
      "severity": "warning",
      "message": "Access control error handling returns null on error, potentially leaking existence of entries or failing to deny by default.",
      "suggestion": "Instead of returning null on error, ensure access is denied and do not reveal resource existence. Consider throwing a generic access denied error.",
      "codeSnippet": "[",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S002",
      "line": 107,
      "column": 0,
      "severity": "warning",
      "message": "Resource access is controlled by id from client without verifying ownership or authorization.",
      "suggestion": "Add backend authorization logic to verify that the requesting user owns the resource before returning or modifying it.",
      "codeSnippet": "(id, query, response, metadata, timestamp, ttl, access_count, last_accessed, expires_at)",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S002",
      "line": 183,
      "column": 0,
      "severity": "warning",
      "message": "Delete operation uses id from client without verifying resource ownership.",
      "suggestion": "Implement backend checks to ensure the resource belongs to the current user before deleting.",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/services/knowledge/storage-backends/sqlite-backend.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    }
  ],
  "timestamp": 1756493219842,
  "version": "1.0.0",
  "fileHash": ""
}