{
  "key": "98415cfe3d0321edc6a6a6b75780c22f",
  "value": [
    {
      "rule": "C003",
      "line": 150,
      "column": 0,
      "severity": "warning",
      "message": "Variable '__help' uses uncommon abbreviation and double underscore; not descriptive.",
      "suggestion": "Rename '__help' to 'helpText' or 'metricDescription' for clarity.",
      "codeSnippet": "lastError:this.lastError  |  |  undefined,",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C006",
      "line": 179,
      "column": 0,
      "severity": "info",
      "message": "Function name 'sanitizeMetricName' is a verb-noun combination, but could be improved for clarity.",
      "suggestion": "Consider renaming to 'formatMetricNameForPrometheus' for explicitness.",
      "codeSnippet": "try {",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 43,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for initialization failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "}",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 73,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for export failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "return {",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 103,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for batch export failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "duration:Date.now() - startTime,",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 136,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for metrics endpoint failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "totalExported:this.exportCount,",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 145,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for custom metrics endpoint failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "lastSuccess?:number;",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 173,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for metric data processing failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "});",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 204,
      "column": 0,
      "severity": "warning",
      "message": "Using 'error' log level for Prometheus metric update failure; may not be critical.",
      "suggestion": "Use 'warn' log level unless the failure is unrecoverable.",
      "codeSnippet": "if (!data.data) return;",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 43,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context information for initialization error.",
      "suggestion": "Log error.stack and relevant context (e.g., config.name) in catch block.",
      "codeSnippet": "}",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 73,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context information for export error.",
      "suggestion": "Log error.stack and relevant context (e.g., data type, config.name) in catch block.",
      "codeSnippet": "return {",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 103,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context information for batch export error.",
      "suggestion": "Log error.stack and relevant context (e.g., number of items, config.name) in catch block.",
      "codeSnippet": "duration:Date.now() - startTime,",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 173,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context information for metric data processing error.",
      "suggestion": "Log error.stack and relevant context (e.g., data contents, service name) in catch block.",
      "codeSnippet": "});",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 204,
      "column": 0,
      "severity": "warning",
      "message": "Catch block does not log stack trace or context information for Prometheus metric update error.",
      "suggestion": "Log error.stack and relevant context (e.g., metric name, telemetryData) in catch block.",
      "codeSnippet": "if (!data.data) return;",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S001",
      "line": 52,
      "column": 0,
      "severity": "error",
      "message": "Access control errors (e.g., registry creation failure) are logged but not denied by default; error is rethrown without explicit deny logic.",
      "suggestion": "Ensure that any error during access control initialization results in a denied state (e.g., do not start exporter or expose endpoints if registry fails).",
      "codeSnippet": "",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S003",
      "line": 127,
      "column": 0,
      "severity": "error",
      "message": "Custom metrics endpoint path is taken directly from config without validation or allow list check, allowing potential open redirect or exposure.",
      "suggestion": "Validate customPath against a predefined allow list before registering the endpoint. Reject or warn if not allowed.",
      "codeSnippet": "}",
      "filePath": "/home/mhugo/code/zenflow/packages/integrations/otel-collector/src/exporters/prometheus-exporter.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    }
  ],
  "timestamp": 1756490823308,
  "version": "1.0.0",
  "fileHash": ""
}