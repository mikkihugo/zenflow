{
  "key": "42101d7b92f2796c1f45aedb7acaefff",
  "value": [
    {
      "rule": "C003",
      "line": 179,
      "column": 0,
      "severity": "warning",
      "message": "Variable name 'gate' is vague and does not clearly indicate its purpose.",
      "suggestion": "Rename 'gate' to 'approvalGateActor' or 'approvalGateInstance' for clarity.",
      "codeSnippet": "lastDecision:({ context, event}) => {",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C006",
      "line": 167,
      "column": 0,
      "severity": "warning",
      "message": "Function name 'createGate' is a noun-verb combination; should be verb-noun for clarity.",
      "suggestion": "Rename 'createGate' to 'registerGate' or 'initializeGate'.",
      "codeSnippet": "')        lastDecision: ({ context, event}) => {';",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C019",
      "line": 190,
      "column": 0,
      "severity": "info",
      "message": "Logger uses 'info' level for gate creation, which is appropriate. No violation detected.",
      "suggestion": "No action needed.",
      "codeSnippet": "logTransition: ({ context}, params:  { from: string, to: string}) => {",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "C029",
      "line": 196,
      "column": 0,
      "severity": "warning",
      "message": "Error thrown in catch block without logging the root cause or context.",
      "suggestion": "Log the error message and stack trace before throwing, including relevant context like gateId.",
      "codeSnippet": "currentRequest: context.currentRequest?.id,')';",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "code_quality",
      "categoryName": "Code Quality",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S001",
      "line": 112,
      "column": 0,
      "severity": "warning",
      "message": "Access control error handling may not securely deny access; fallback logic on error is unclear.",
      "suggestion": "Ensure that any error in approval decision logic results in a denied (not approved) state by default.",
      "codeSnippet": "};",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S002",
      "line": 180,
      "column": 0,
      "severity": "warning",
      "message": "Approval requests are accepted based on client-supplied 'id' without backend ownership verification.",
      "suggestion": "Verify resource ownership for each approval request on the backend before processing.",
      "codeSnippet": "if (event.type ==='AUTO_REJECT '&& context.currentRequest) {';",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    },
    {
      "rule": "S003",
      "line": 0,
      "column": 0,
      "severity": "warning",
      "message": "No allow list validation for dynamic URL redirects detected in the code.",
      "suggestion": "Implement an allow list for any dynamic URL redirects and validate user input before redirecting.",
      "codeSnippet": "/**",
      "filePath": "/home/mhugo/code/zenflow/packages/services/coordination/src/state-machines/approval-gate/approval-gate-machine.ts",
      "category": "security",
      "categoryName": "Security",
      "analysisMode": "medium",
      "confidence": 0.85
    }
  ],
  "timestamp": 1756492531287,
  "version": "1.0.0",
  "fileHash": ""
}