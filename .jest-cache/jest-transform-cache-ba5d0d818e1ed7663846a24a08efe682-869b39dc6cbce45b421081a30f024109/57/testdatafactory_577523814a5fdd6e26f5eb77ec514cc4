730a094f43d7282cea2e88a8550f99ba
/**
 * Test Data Factory - Reproducible Test Data Generation
 *
 * Creates realistic test data for both London and Classical TDD approaches
 */
export class TestDataFactory {
    seed;
    options;
    constructor(options = {}) {
        this.seed = options.seed ?? Date.now();
        this.options = options;
        this.initializeRandom();
    }
    /**
     * Create user test data
     */
    createUser(overrides = {}) {
        const id = this.generateId();
        const name = this.generateName();
        const email = this.generateEmail(name);
        return {
            id,
            name,
            email,
            preferences: {
                theme: this.randomChoice(['light', 'dark', 'auto']),
                language: this.randomChoice(['en', 'es', 'fr', 'de']),
                notifications: this.randomBoolean()
            },
            metadata: {
                createdAt: this.generateTimestamp(),
                lastLogin: this.generateTimestamp(),
                loginCount: this.randomInt(1, 100)
            },
            ...overrides
        };
    }
    /**
     * Create multiple users
     */
    createUsers(count, baseData = {}) {
        return Array.from({ length: count }, (_, index) => this.createUser({ ...baseData, id: `user-${index + 1}` }));
    }
    /**
     * Create project test data
     */
    createProject(overrides = {}) {
        const name = this.generateProjectName();
        const type = this.randomChoice(['typescript', 'javascript', 'python', 'rust']);
        return {
            name,
            path: `/projects/${name}`,
            type,
            structure: this.generateProjectStructure(type),
            dependencies: this.generateDependencies(type),
            ...overrides
        };
    }
    /**
     * Create swarm test data
     */
    createSwarm(overrides = {}) {
        const id = this.generateId();
        const topology = this.randomChoice(['mesh', 'hierarchical', 'ring', 'star']);
        const agentCount = this.randomInt(3, 8);
        return {
            id,
            topology,
            agents: this.createAgents(agentCount),
            configuration: {
                maxAgents: agentCount,
                strategy: this.randomChoice(['balanced', 'specialized', 'adaptive']),
                timeout: this.randomInt(30000, 120000)
            },
            ...overrides
        };
    }
    /**
     * Create agent test data
     */
    createAgent(overrides = {}) {
        const type = this.randomChoice(['researcher', 'coder', 'analyst', 'tester', 'coordinator']);
        return {
            id: this.generateId(),
            type,
            capabilities: this.generateCapabilities(type),
            state: this.randomChoice(['idle', 'working', 'error', 'completed']),
            ...overrides
        };
    }
    /**
     * Create multiple agents
     */
    createAgents(count, baseData = {}) {
        return Array.from({ length: count }, (_, index) => this.createAgent({ ...baseData, id: `agent-${index + 1}` }));
    }
    /**
     * Create MCP message test data
     */
    createMCPMessage(method = 'tools/call', params = {}) {
        return {
            jsonrpc: '2.0',
            id: this.randomInt(1, 1000),
            method,
            params: {
                name: this.randomChoice(['analyze', 'generate', 'optimize', 'test']),
                arguments: {
                    input: this.generateText(),
                    options: { verbose: this.randomBoolean() },
                    ...params
                }
            }
        };
    }
    /**
     * Create neural network test data
     */
    createNeuralTrainingData(size = 100) {
        return Array.from({ length: size }, () => ({
            input: Array.from({ length: 3 }, () => this.randomFloat(-1, 1)),
            output: Array.from({ length: 2 }, () => this.randomFloat(0, 1))
        }));
    }
    /**
     * Create performance test data
     */
    createPerformanceData(operations = 1000) {
        return {
            operations,
            data: Array.from({ length: operations }, (_, i) => ({
                id: i,
                payload: this.generateText(100),
                timestamp: Date.now() + i,
                metadata: { index: i, type: 'test' }
            }))
        };
    }
    /**
     * Create file system test structure
     */
    createFileSystemStructure() {
        return {
            'src/': {
                'index.ts': 'export * from "./lib";',
                'lib/': {
                    'core.ts': this.generateCode('typescript'),
                    'utils.ts': this.generateCode('typescript'),
                    'types.ts': 'export interface TestInterface {}'
                }
            },
            'tests/': {
                'unit/': {
                    'core.test.ts': this.generateTestCode('typescript')
                },
                'integration/': {
                    'api.test.ts': this.generateTestCode('typescript')
                }
            },
            'package.json': JSON.stringify({
                name: 'test-project',
                version: '1.0.0',
                scripts: {
                    test: 'jest',
                    build: 'tsc'
                }
            }, null, 2)
        };
    }
    /**
     * Create database seed data
     */
    createDatabaseSeed() {
        return {
            users: this.createUsers(10),
            projects: Array.from({ length: 5 }, () => this.createProject()),
            swarms: Array.from({ length: 3 }, () => this.createSwarm())
        };
    }
    /**
     * Reset the random seed for reproducible tests
     */
    resetSeed(newSeed) {
        this.seed = newSeed ?? this.options.seed ?? Date.now();
        this.initializeRandom();
    }
    initializeRandom() {
        // Simple seeded random number generator (LCG)
        let seed = this.seed;
        Math.random = () => {
            seed = (seed * 9301 + 49297) % 233280;
            return seed / 233280;
        };
    }
    generateId() {
        return `id-${this.randomInt(100000, 999999)}`;
    }
    generateName() {
        const firstNames = ['Alice', 'Bob', 'Carol', 'David', 'Eve', 'Frank', 'Grace', 'Henry'];
        const lastNames = ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis'];
        return `${this.randomChoice(firstNames)} ${this.randomChoice(lastNames)}`;
    }
    generateEmail(name) {
        const domain = this.randomChoice(['example.com', 'test.org', 'demo.net']);
        const username = name.toLowerCase().replace(' ', '.');
        return `${username}@${domain}`;
    }
    generateProjectName() {
        const adjectives = ['awesome', 'amazing', 'brilliant', 'creative', 'dynamic', 'elegant'];
        const nouns = ['project', 'app', 'service', 'tool', 'platform', 'system'];
        return `${this.randomChoice(adjectives)}-${this.randomChoice(nouns)}`;
    }
    generateProjectStructure(type) {
        const structures = {
            typescript: {
                'src/': { 'index.ts': '', 'types.ts': '', 'utils.ts': '' },
                'tests/': { 'index.test.ts': '' },
                'tsconfig.json': '',
                'package.json': ''
            },
            javascript: {
                'src/': { 'index.js': '', 'utils.js': '' },
                'tests/': { 'index.test.js': '' },
                'package.json': ''
            },
            python: {
                'src/': { '__init__.py': '', 'main.py': '', 'utils.py': '' },
                'tests/': { 'test_main.py': '' },
                'requirements.txt': '',
                'setup.py': ''
            },
            rust: {
                'src/': { 'main.rs': '', 'lib.rs': '' },
                'tests/': { 'integration_test.rs': '' },
                'Cargo.toml': ''
            }
        };
        return structures[type];
    }
    generateDependencies(type) {
        const dependencies = {
            typescript: ['@types/node', 'typescript', 'jest', '@jest/types'],
            javascript: ['jest', 'lodash', 'axios'],
            python: ['pytest', 'numpy', 'requests'],
            rust: ['serde', 'tokio', 'clap']
        };
        return dependencies[type];
    }
    generateCapabilities(type) {
        const capabilities = {
            researcher: ['web-search', 'document-analysis', 'data-extraction'],
            coder: ['code-generation', 'refactoring', 'testing'],
            analyst: ['data-analysis', 'pattern-recognition', 'reporting'],
            tester: ['test-generation', 'quality-assurance', 'bug-detection'],
            coordinator: ['task-management', 'workflow-optimization', 'team-coordination']
        };
        return capabilities[type];
    }
    generateText(length = 50) {
        const words = ['lorem', 'ipsum', 'dolor', 'sit', 'amet', 'consectetur', 'adipiscing', 'elit'];
        const result = [];
        for (let i = 0; i < length; i++) {
            result.push(this.randomChoice(words));
        }
        return result.join(' ');
    }
    generateCode(language) {
        const templates = {
            typescript: `
export function testFunction(input: string): string {
  return input.toUpperCase();
}

export class TestClass {
  private value: number;
  
  constructor(value: number = 0) {
    this.value = value;
  }
  
  getValue(): number {
    return this.value;
  }
}`,
            javascript: `
function testFunction(input) {
  return input.toUpperCase();
}

class TestClass {
  constructor(value = 0) {
    this.value = value;
  }
  
  getValue() {
    return this.value;
  }
}

module.exports = { testFunction, TestClass };`,
            python: `
def test_function(input_str):
    return input_str.upper()

class TestClass:
    def __init__(self, value=0):
        self.value = value
    
    def get_value(self):
        return self.value`,
            rust: `
pub fn test_function(input: &str) -> String {
    input.to_uppercase()
}

pub struct TestStruct {
    value: i32,
}

impl TestStruct {
    pub fn new(value: i32) -> Self {
        Self { value }
    }
    
    pub fn get_value(&self) -> i32 {
        self.value
    }
}`
        };
        return templates[language];
    }
    generateTestCode(language) {
        const templates = {
            typescript: `
import { testFunction, TestClass } from '../src/index';

describe('Test Suite', () => {
  it('should test function', () => {
    expect(testFunction('hello')).toBe('HELLO');
  });
  
  it('should test class', () => {
    const instance = new TestClass(42);
    expect(instance.getValue()).toBe(42);
  });
});`,
            javascript: `
const { testFunction, TestClass } = require('../src/index');

describe('Test Suite', () => {
  it('should test function', () => {
    expect(testFunction('hello')).toBe('HELLO');
  });
  
  it('should test class', () => {
    const instance = new TestClass(42);
    expect(instance.getValue()).toBe(42);
  });
});`
        };
        return templates[language];
    }
    generateTimestamp() {
        const now = Date.now();
        const oneYear = 365 * 24 * 60 * 60 * 1000;
        return now - this.randomInt(0, oneYear);
    }
    randomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    randomFloat(min, max) {
        return Math.random() * (max - min) + min;
    }
    randomBoolean() {
        return Math.random() < 0.5;
    }
    randomChoice(array) {
        return array[Math.floor(Math.random() * array.length)];
    }
}
// Convenience instance for easy use
export const testDataFactory = new TestDataFactory();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3NyYy9fX3Rlc3RzX18vaGVscGVycy90ZXN0LWRhdGEtZmFjdG9yeS50cyIsIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHO0FBVUgsTUFBTSxPQUFPLGVBQWU7SUFDbEIsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFrQjtJQUVqQyxZQUFZLFVBQTJCLEVBQUU7UUFDdkMsSUFBSSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUN2QyxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRUQ7O09BRUc7SUFDSCxVQUFVLENBQUMsWUFBbUMsRUFBRTtRQUM5QyxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDN0IsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ2pDLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFdkMsT0FBTztZQUNMLEVBQUU7WUFDRixJQUFJO1lBQ0osS0FBSztZQUNMLFdBQVcsRUFBRTtnQkFDWCxLQUFLLEVBQUUsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7Z0JBQ25ELFFBQVEsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBQ3JELGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFO2FBQ3BDO1lBQ0QsUUFBUSxFQUFFO2dCQUNSLFNBQVMsRUFBRSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7Z0JBQ25DLFNBQVMsRUFBRSxJQUFJLENBQUMsaUJBQWlCLEVBQUU7Z0JBQ25DLFVBQVUsRUFBRSxJQUFJLENB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QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN6RCxDQUFDO0NBQ0Y7QUFFRCxvQ0FBb0M7QUFDcEMsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFHLElBQUksZUFBZSxFQUFFLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3NyYy9fX3Rlc3RzX18vaGVscGVycy90ZXN0LWRhdGEtZmFjdG9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3QgRGF0YSBGYWN0b3J5IC0gUmVwcm9kdWNpYmxlIFRlc3QgRGF0YSBHZW5lcmF0aW9uXG4gKiBcbiAqIENyZWF0ZXMgcmVhbGlzdGljIHRlc3QgZGF0YSBmb3IgYm90aCBMb25kb24gYW5kIENsYXNzaWNhbCBUREQgYXBwcm9hY2hlc1xuICovXG5cbmltcG9ydCB0eXBlIHsgXG4gIFRlc3REYXRhT3B0aW9ucywgXG4gIFVzZXJUZXN0RGF0YSwgXG4gIFByb2plY3RUZXN0RGF0YSwgXG4gIFN3YXJtVGVzdERhdGEsIFxuICBBZ2VudFRlc3REYXRhIFxufSBmcm9tICcuL3R5cGVzLmpzJztcblxuZXhwb3J0IGNsYXNzIFRlc3REYXRhRmFjdG9yeSB7XG4gIHByaXZhdGUgc2VlZDogbnVtYmVyO1xuICBwcml2YXRlIG9wdGlvbnM6IFRlc3REYXRhT3B0aW9ucztcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBUZXN0RGF0YU9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuc2VlZCA9IG9wdGlvbnMuc2VlZCA/PyBEYXRlLm5vdygpO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy5pbml0aWFsaXplUmFuZG9tKCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIHVzZXIgdGVzdCBkYXRhXG4gICAqL1xuICBjcmVhdGVVc2VyKG92ZXJyaWRlczogUGFydGlhbDxVc2VyVGVzdERhdGE+ID0ge30pOiBVc2VyVGVzdERhdGEge1xuICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlkKCk7XG4gICAgY29uc3QgbmFtZSA9IHRoaXMuZ2VuZXJhdGVOYW1lKCk7XG4gICAgY29uc3QgZW1haWwgPSB0aGlzLmdlbmVyYXRlRW1haWwobmFtZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBuYW1lLFxuICAgICAgZW1haWwsXG4gICAgICBwcmVmZXJlbmNlczoge1xuICAgICAgICB0aGVtZTogdGhpcy5yYW5kb21DaG9pY2UoWydsaWdodCcsICdkYXJrJywgJ2F1dG8nXSksXG4gICAgICAgIGxhbmd1YWdlOiB0aGlzLnJhbmRvbUNob2ljZShbJ2VuJywgJ2VzJywgJ2ZyJywgJ2RlJ10pLFxuICAgICAgICBub3RpZmljYXRpb25zOiB0aGlzLnJhbmRvbUJvb2xlYW4oKVxuICAgICAgfSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIGNyZWF0ZWRBdDogdGhpcy5nZW5lcmF0ZVRpbWVzdGFtcCgpLFxuICAgICAgICBsYXN0TG9naW46IHRoaXMuZ2VuZXJhdGVUaW1lc3RhbXAoKSxcbiAgICAgICAgbG9naW5Db3VudDogdGhpcy5yYW5kb21JbnQoMSwgMTAwKVxuICAgICAgfSxcbiAgICAgIC4uLm92ZXJyaWRlc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIG11bHRpcGxlIHVzZXJzXG4gICAqL1xuICBjcmVhdGVVc2Vycyhjb3VudDogbnVtYmVyLCBiYXNlRGF0YTogUGFydGlhbDxVc2VyVGVzdERhdGE+ID0ge30pOiBVc2VyVGVzdERhdGFbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20oeyBsZW5ndGg6IGNvdW50IH0sIChfLCBpbmRleCkgPT4gXG4gICAgICB0aGlzLmNyZWF0ZVVzZXIoeyAuLi5iYXNlRGF0YSwgaWQ6IGB1c2VyLSR7aW5kZXggKyAxfWAgfSlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBwcm9qZWN0IHRlc3QgZGF0YVxuICAgKi9cbiAgY3JlYXRlUHJvamVjdChvdmVycmlkZXM6IFBhcnRpYWw8UHJvamVjdFRlc3REYXRhPiA9IHt9KTogUHJvamVjdFRlc3REYXRhIHtcbiAgICBjb25zdCBuYW1lID0gdGhpcy5nZW5lcmF0ZVByb2plY3ROYW1lKCk7XG4gICAgY29uc3QgdHlwZSA9IHRoaXMucmFuZG9tQ2hvaWNlKFsndHlwZXNjcmlwdCcsICdqYXZhc2NyaXB0JywgJ3B5dGhvbicsICdydXN0J10gYXMgY29uc3QpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBuYW1lLFxuICAgICAgcGF0aDogYC9wcm9qZWN0cy8ke25hbWV9YCxcbiAgICAgIHR5cGUsXG4gICAgICBzdHJ1Y3R1cmU6IHRoaXMuZ2VuZXJhdGVQcm9qZWN0U3RydWN0dXJlKHR5cGUpLFxuICAgICAgZGVwZW5kZW5jaWVzOiB0aGlzLmdlbmVyYXRlRGVwZW5kZW5jaWVzKHR5cGUpLFxuICAgICAgLi4ub3ZlcnJpZGVzXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgc3dhcm0gdGVzdCBkYXRhXG4gICAqL1xuICBjcmVhdGVTd2FybShvdmVycmlkZXM6IFBhcnRpYWw8U3dhcm1UZXN0RGF0YT4gPSB7fSk6IFN3YXJtVGVzdERhdGEge1xuICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlkKCk7XG4gICAgY29uc3QgdG9wb2xvZ3kgPSB0aGlzLnJhbmRvbUNob2ljZShbJ21lc2gnLCAnaGllcmFyY2hpY2FsJywgJ3JpbmcnLCAnc3RhciddIGFzIGNvbnN0KTtcbiAgICBjb25zdCBhZ2VudENvdW50ID0gdGhpcy5yYW5kb21JbnQoMywgOCk7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlkLFxuICAgICAgdG9wb2xvZ3ksXG4gICAgICBhZ2VudHM6IHRoaXMuY3JlYXRlQWdlbnRzKGFnZW50Q291bnQpLFxuICAgICAgY29uZmlndXJhdGlvbjoge1xuICAgICAgICBtYXhBZ2VudHM6IGFnZW50Q291bnQsXG4gICAgICAgIHN0cmF0ZWd5OiB0aGlzLnJhbmRvbUNob2ljZShbJ2JhbGFuY2VkJywgJ3NwZWNpYWxpemVkJywgJ2FkYXB0aXZlJ10pLFxuICAgICAgICB0aW1lb3V0OiB0aGlzLnJhbmRvbUludCgzMDAwMCwgMTIwMDAwKVxuICAgICAgfSxcbiAgICAgIC4uLm92ZXJyaWRlc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGFnZW50IHRlc3QgZGF0YVxuICAgKi9cbiAgY3JlYXRlQWdlbnQob3ZlcnJpZGVzOiBQYXJ0aWFsPEFnZW50VGVzdERhdGE+ID0ge30pOiBBZ2VudFRlc3REYXRhIHtcbiAgICBjb25zdCB0eXBlID0gdGhpcy5yYW5kb21DaG9pY2UoWydyZXNlYXJjaGVyJywgJ2NvZGVyJywgJ2FuYWx5c3QnLCAndGVzdGVyJywgJ2Nvb3JkaW5hdG9yJ10gYXMgY29uc3QpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpZDogdGhpcy5nZW5lcmF0ZUlkKCksXG4gICAgICB0eXBlLFxuICAgICAgY2FwYWJpbGl0aWVzOiB0aGlzLmdlbmVyYXRlQ2FwYWJpbGl0aWVzKHR5cGUpLFxuICAgICAgc3RhdGU6IHRoaXMucmFuZG9tQ2hvaWNlKFsnaWRsZScsICd3b3JraW5nJywgJ2Vycm9yJywgJ2NvbXBsZXRlZCddIGFzIGNvbnN0KSxcbiAgICAgIC4uLm92ZXJyaWRlc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIG11bHRpcGxlIGFnZW50c1xuICAgKi9cbiAgY3JlYXRlQWdlbnRzKGNvdW50OiBudW1iZXIsIGJhc2VEYXRhOiBQYXJ0aWFsPEFnZW50VGVzdERhdGE+ID0ge30pOiBBZ2VudFRlc3REYXRhW10ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb3VudCB9LCAoXywgaW5kZXgpID0+IFxuICAgICAgdGhpcy5jcmVhdGVBZ2VudCh7IC4uLmJhc2VEYXRhLCBpZDogYGFnZW50LSR7aW5kZXggKyAxfWAgfSlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBNQ1AgbWVzc2FnZSB0ZXN0IGRhdGFcbiAgICovXG4gIGNyZWF0ZU1DUE1lc3NhZ2UobWV0aG9kOiBzdHJpbmcgPSAndG9vbHMvY2FsbCcsIHBhcmFtczogYW55ID0ge30pIHtcbiAgICByZXR1cm4ge1xuICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICBpZDogdGhpcy5yYW5kb21JbnQoMSwgMTAwMCksXG4gICAgICBtZXRob2QsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgbmFtZTogdGhpcy5yYW5kb21DaG9pY2UoWydhbmFseXplJywgJ2dlbmVyYXRlJywgJ29wdGltaXplJywgJ3Rlc3QnXSksXG4gICAgICAgIGFyZ3VtZW50czoge1xuICAgICAgICAgIGlucHV0OiB0aGlzLmdlbmVyYXRlVGV4dCgpLFxuICAgICAgICAgIG9wdGlvbnM6IHsgdmVyYm9zZTogdGhpcy5yYW5kb21Cb29sZWFuKCkgfSxcbiAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIG5ldXJhbCBuZXR3b3JrIHRlc3QgZGF0YVxuICAgKi9cbiAgY3JlYXRlTmV1cmFsVHJhaW5pbmdEYXRhKHNpemU6IG51bWJlciA9IDEwMCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoOiBzaXplIH0sICgpID0+ICh7XG4gICAgICBpbnB1dDogQXJyYXkuZnJvbSh7IGxlbmd0aDogMyB9LCAoKSA9PiB0aGlzLnJhbmRvbUZsb2F0KC0xLCAxKSksXG4gICAgICBvdXRwdXQ6IEFycmF5LmZyb20oeyBsZW5ndGg6IDIgfSwgKCkgPT4gdGhpcy5yYW5kb21GbG9hdCgwLCAxKSlcbiAgICB9KSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIHBlcmZvcm1hbmNlIHRlc3QgZGF0YVxuICAgKi9cbiAgY3JlYXRlUGVyZm9ybWFuY2VEYXRhKG9wZXJhdGlvbnM6IG51bWJlciA9IDEwMDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgb3BlcmF0aW9ucyxcbiAgICAgIGRhdGE6IEFycmF5LmZyb20oeyBsZW5ndGg6IG9wZXJhdGlvbnMgfSwgKF8sIGkpID0+ICh7XG4gICAgICAgIGlkOiBpLFxuICAgICAgICBwYXlsb2FkOiB0aGlzLmdlbmVyYXRlVGV4dCgxMDApLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkgKyBpLFxuICAgICAgICBtZXRhZGF0YTogeyBpbmRleDogaSwgdHlwZTogJ3Rlc3QnIH1cbiAgICAgIH0pKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGZpbGUgc3lzdGVtIHRlc3Qgc3RydWN0dXJlXG4gICAqL1xuICBjcmVhdGVGaWxlU3lzdGVtU3RydWN0dXJlKCkge1xuICAgIHJldHVybiB7XG4gICAgICAnc3JjLyc6IHtcbiAgICAgICAgJ2luZGV4LnRzJzogJ2V4cG9ydCAqIGZyb20gXCIuL2xpYlwiOycsXG4gICAgICAgICdsaWIvJzoge1xuICAgICAgICAgICdjb3JlLnRzJzogdGhpcy5nZW5lcmF0ZUNvZGUoJ3R5cGVzY3JpcHQnKSxcbiAgICAgICAgICAndXRpbHMudHMnOiB0aGlzLmdlbmVyYXRlQ29kZSgndHlwZXNjcmlwdCcpLFxuICAgICAgICAgICd0eXBlcy50cyc6ICdleHBvcnQgaW50ZXJmYWNlIFRlc3RJbnRlcmZhY2Uge30nXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAndGVzdHMvJzoge1xuICAgICAgICAndW5pdC8nOiB7XG4gICAgICAgICAgJ2NvcmUudGVzdC50cyc6IHRoaXMuZ2VuZXJhdGVUZXN0Q29kZSgndHlwZXNjcmlwdCcpXG4gICAgICAgIH0sXG4gICAgICAgICdpbnRlZ3JhdGlvbi8nOiB7XG4gICAgICAgICAgJ2FwaS50ZXN0LnRzJzogdGhpcy5nZW5lcmF0ZVRlc3RDb2RlKCd0eXBlc2NyaXB0JylcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgICdwYWNrYWdlLmpzb24nOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgICAgICBzY3JpcHRzOiB7XG4gICAgICAgICAgdGVzdDogJ2plc3QnLFxuICAgICAgICAgIGJ1aWxkOiAndHNjJ1xuICAgICAgICB9XG4gICAgICB9LCBudWxsLCAyKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGRhdGFiYXNlIHNlZWQgZGF0YVxuICAgKi9cbiAgY3JlYXRlRGF0YWJhc2VTZWVkKCkge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VyczogdGhpcy5jcmVhdGVVc2VycygxMCksXG4gICAgICBwcm9qZWN0czogQXJyYXkuZnJvbSh7IGxlbmd0aDogNSB9LCAoKSA9PiB0aGlzLmNyZWF0ZVByb2plY3QoKSksXG4gICAgICBzd2FybXM6IEFycmF5LmZyb20oeyBsZW5ndGg6IDMgfSwgKCkgPT4gdGhpcy5jcmVhdGVTd2FybSgpKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgdGhlIHJhbmRvbSBzZWVkIGZvciByZXByb2R1Y2libGUgdGVzdHNcbiAgICovXG4gIHJlc2V0U2VlZChuZXdTZWVkPzogbnVtYmVyKSB7XG4gICAgdGhpcy5zZWVkID0gbmV3U2VlZCA/PyB0aGlzLm9wdGlvbnMuc2VlZCA/PyBEYXRlLm5vdygpO1xuICAgIHRoaXMuaW5pdGlhbGl6ZVJhbmRvbSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplUmFuZG9tKCkge1xuICAgIC8vIFNpbXBsZSBzZWVkZWQgcmFuZG9tIG51bWJlciBnZW5lcmF0b3IgKExDRylcbiAgICBsZXQgc2VlZCA9IHRoaXMuc2VlZDtcbiAgICBNYXRoLnJhbmRvbSA9ICgpID0+IHtcbiAgICAgIHNlZWQgPSAoc2VlZCAqIDkzMDEgKyA0OTI5NykgJSAyMzMyODA7XG4gICAgICByZXR1cm4gc2VlZCAvIDIzMzI4MDtcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUlkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBpZC0ke3RoaXMucmFuZG9tSW50KDEwMDAwMCwgOTk5OTk5KX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZU5hbWUoKTogc3RyaW5nIHtcbiAgICBjb25zdCBmaXJzdE5hbWVzID0gWydBbGljZScsICdCb2InLCAnQ2Fyb2wnLCAnRGF2aWQnLCAnRXZlJywgJ0ZyYW5rJywgJ0dyYWNlJywgJ0hlbnJ5J107XG4gICAgY29uc3QgbGFzdE5hbWVzID0gWydTbWl0aCcsICdKb2huc29uJywgJ1dpbGxpYW1zJywgJ0Jyb3duJywgJ0pvbmVzJywgJ0dhcmNpYScsICdNaWxsZXInLCAnRGF2aXMnXTtcbiAgICBcbiAgICByZXR1cm4gYCR7dGhpcy5yYW5kb21DaG9pY2UoZmlyc3ROYW1lcyl9ICR7dGhpcy5yYW5kb21DaG9pY2UobGFzdE5hbWVzKX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZUVtYWlsKG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgZG9tYWluID0gdGhpcy5yYW5kb21DaG9pY2UoWydleGFtcGxlLmNvbScsICd0ZXN0Lm9yZycsICdkZW1vLm5ldCddKTtcbiAgICBjb25zdCB1c2VybmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKCcgJywgJy4nKTtcbiAgICByZXR1cm4gYCR7dXNlcm5hbWV9QCR7ZG9tYWlufWA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUHJvamVjdE5hbWUoKTogc3RyaW5nIHtcbiAgICBjb25zdCBhZGplY3RpdmVzID0gWydhd2Vzb21lJywgJ2FtYXppbmcnLCAnYnJpbGxpYW50JywgJ2NyZWF0aXZlJywgJ2R5bmFtaWMnLCAnZWxlZ2FudCddO1xuICAgIGNvbnN0IG5vdW5zID0gWydwcm9qZWN0JywgJ2FwcCcsICdzZXJ2aWNlJywgJ3Rvb2wnLCAncGxhdGZvcm0nLCAnc3lzdGVtJ107XG4gICAgXG4gICAgcmV0dXJuIGAke3RoaXMucmFuZG9tQ2hvaWNlKGFkamVjdGl2ZXMpfS0ke3RoaXMucmFuZG9tQ2hvaWNlKG5vdW5zKX1gO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVByb2plY3RTdHJ1Y3R1cmUodHlwZTogUHJvamVjdFRlc3REYXRhWyd0eXBlJ10pIHtcbiAgICBjb25zdCBzdHJ1Y3R1cmVzID0ge1xuICAgICAgdHlwZXNjcmlwdDoge1xuICAgICAgICAnc3JjLyc6IHsgJ2luZGV4LnRzJzogJycsICd0eXBlcy50cyc6ICcnLCAndXRpbHMudHMnOiAnJyB9LFxuICAgICAgICAndGVzdHMvJzogeyAnaW5kZXgudGVzdC50cyc6ICcnIH0sXG4gICAgICAgICd0c2NvbmZpZy5qc29uJzogJycsXG4gICAgICAgICdwYWNrYWdlLmpzb24nOiAnJ1xuICAgICAgfSxcbiAgICAgIGphdmFzY3JpcHQ6IHtcbiAgICAgICAgJ3NyYy8nOiB7ICdpbmRleC5qcyc6ICcnLCAndXRpbHMuanMnOiAnJyB9LFxuICAgICAgICAndGVzdHMvJzogeyAnaW5kZXgudGVzdC5qcyc6ICcnIH0sXG4gICAgICAgICdwYWNrYWdlLmpzb24nOiAnJ1xuICAgICAgfSxcbiAgICAgIHB5dGhvbjoge1xuICAgICAgICAnc3JjLyc6IHsgJ19faW5pdF9fLnB5JzogJycsICdtYWluLnB5JzogJycsICd1dGlscy5weSc6ICcnIH0sXG4gICAgICAgICd0ZXN0cy8nOiB7ICd0ZXN0X21haW4ucHknOiAnJyB9LFxuICAgICAgICAncmVxdWlyZW1lbnRzLnR4dCc6ICcnLFxuICAgICAgICAnc2V0dXAucHknOiAnJ1xuICAgICAgfSxcbiAgICAgIHJ1c3Q6IHtcbiAgICAgICAgJ3NyYy8nOiB7ICdtYWluLnJzJzogJycsICdsaWIucnMnOiAnJyB9LFxuICAgICAgICAndGVzdHMvJzogeyAnaW50ZWdyYXRpb25fdGVzdC5ycyc6ICcnIH0sXG4gICAgICAgICdDYXJnby50b21sJzogJydcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBzdHJ1Y3R1cmVzW3R5cGVdO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZURlcGVuZGVuY2llcyh0eXBlOiBQcm9qZWN0VGVzdERhdGFbJ3R5cGUnXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBkZXBlbmRlbmNpZXMgPSB7XG4gICAgICB0eXBlc2NyaXB0OiBbJ0B0eXBlcy9ub2RlJywgJ3R5cGVzY3JpcHQnLCAnamVzdCcsICdAamVzdC90eXBlcyddLFxuICAgICAgamF2YXNjcmlwdDogWydqZXN0JywgJ2xvZGFzaCcsICdheGlvcyddLFxuICAgICAgcHl0aG9uOiBbJ3B5dGVzdCcsICdudW1weScsICdyZXF1ZXN0cyddLFxuICAgICAgcnVzdDogWydzZXJkZScsICd0b2tpbycsICdjbGFwJ11cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBkZXBlbmRlbmNpZXNbdHlwZV07XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ2FwYWJpbGl0aWVzKHR5cGU6IEFnZW50VGVzdERhdGFbJ3R5cGUnXSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBjYXBhYmlsaXRpZXMgPSB7XG4gICAgICByZXNlYXJjaGVyOiBbJ3dlYi1zZWFyY2gnLCAnZG9jdW1lbnQtYW5hbHlzaXMnLCAnZGF0YS1leHRyYWN0aW9uJ10sXG4gICAgICBjb2RlcjogWydjb2RlLWdlbmVyYXRpb24nLCAncmVmYWN0b3JpbmcnLCAndGVzdGluZyddLFxuICAgICAgYW5hbHlzdDogWydkYXRhLWFuYWx5c2lzJywgJ3BhdHRlcm4tcmVjb2duaXRpb24nLCAncmVwb3J0aW5nJ10sXG4gICAgICB0ZXN0ZXI6IFsndGVzdC1nZW5lcmF0aW9uJywgJ3F1YWxpdHktYXNzdXJhbmNlJywgJ2J1Zy1kZXRlY3Rpb24nXSxcbiAgICAgIGNvb3JkaW5hdG9yOiBbJ3Rhc2stbWFuYWdlbWVudCcsICd3b3JrZmxvdy1vcHRpbWl6YXRpb24nLCAndGVhbS1jb29yZGluYXRpb24nXVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIGNhcGFiaWxpdGllc1t0eXBlXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUZXh0KGxlbmd0aDogbnVtYmVyID0gNTApOiBzdHJpbmcge1xuICAgIGNvbnN0IHdvcmRzID0gWydsb3JlbScsICdpcHN1bScsICdkb2xvcicsICdzaXQnLCAnYW1ldCcsICdjb25zZWN0ZXR1cicsICdhZGlwaXNjaW5nJywgJ2VsaXQnXTtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHQucHVzaCh0aGlzLnJhbmRvbUNob2ljZSh3b3JkcykpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzdWx0LmpvaW4oJyAnKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVDb2RlKGxhbmd1YWdlOiAndHlwZXNjcmlwdCcgfCAnamF2YXNjcmlwdCcgfCAncHl0aG9uJyB8ICdydXN0Jyk6IHN0cmluZyB7XG4gICAgY29uc3QgdGVtcGxhdGVzID0ge1xuICAgICAgdHlwZXNjcmlwdDogYFxuZXhwb3J0IGZ1bmN0aW9uIHRlc3RGdW5jdGlvbihpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIGlucHV0LnRvVXBwZXJDYXNlKCk7XG59XG5cbmV4cG9ydCBjbGFzcyBUZXN0Q2xhc3Mge1xuICBwcml2YXRlIHZhbHVlOiBudW1iZXI7XG4gIFxuICBjb25zdHJ1Y3Rvcih2YWx1ZTogbnVtYmVyID0gMCkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuICBcbiAgZ2V0VmFsdWUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy52YWx1ZTtcbiAgfVxufWAsXG4gICAgICBqYXZhc2NyaXB0OiBgXG5mdW5jdGlvbiB0ZXN0RnVuY3Rpb24oaW5wdXQpIHtcbiAgcmV0dXJuIGlucHV0LnRvVXBwZXJDYXNlKCk7XG59XG5cbmNsYXNzIFRlc3RDbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHZhbHVlID0gMCkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuICBcbiAgZ2V0VmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IHRlc3RGdW5jdGlvbiwgVGVzdENsYXNzIH07YCxcbiAgICAgIHB5dGhvbjogYFxuZGVmIHRlc3RfZnVuY3Rpb24oaW5wdXRfc3RyKTpcbiAgICByZXR1cm4gaW5wdXRfc3RyLnVwcGVyKClcblxuY2xhc3MgVGVzdENsYXNzOlxuICAgIGRlZiBfX2luaXRfXyhzZWxmLCB2YWx1ZT0wKTpcbiAgICAgICAgc2VsZi52YWx1ZSA9IHZhbHVlXG4gICAgXG4gICAgZGVmIGdldF92YWx1ZShzZWxmKTpcbiAgICAgICAgcmV0dXJuIHNlbGYudmFsdWVgLFxuICAgICAgcnVzdDogYFxucHViIGZuIHRlc3RfZnVuY3Rpb24oaW5wdXQ6ICZzdHIpIC0+IFN0cmluZyB7XG4gICAgaW5wdXQudG9fdXBwZXJjYXNlKClcbn1cblxucHViIHN0cnVjdCBUZXN0U3RydWN0IHtcbiAgICB2YWx1ZTogaTMyLFxufVxuXG5pbXBsIFRlc3RTdHJ1Y3Qge1xuICAgIHB1YiBmbiBuZXcodmFsdWU6IGkzMikgLT4gU2VsZiB7XG4gICAgICAgIFNlbGYgeyB2YWx1ZSB9XG4gICAgfVxuICAgIFxuICAgIHB1YiBmbiBnZXRfdmFsdWUoJnNlbGYpIC0+IGkzMiB7XG4gICAgICAgIHNlbGYudmFsdWVcbiAgICB9XG59YFxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHRlbXBsYXRlc1tsYW5ndWFnZV07XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlVGVzdENvZGUobGFuZ3VhZ2U6ICd0eXBlc2NyaXB0JyB8ICdqYXZhc2NyaXB0Jyk6IHN0cmluZyB7XG4gICAgY29uc3QgdGVtcGxhdGVzID0ge1xuICAgICAgdHlwZXNjcmlwdDogYFxuaW1wb3J0IHsgdGVzdEZ1bmN0aW9uLCBUZXN0Q2xhc3MgfSBmcm9tICcuLi9zcmMvaW5kZXgnO1xuXG5kZXNjcmliZSgnVGVzdCBTdWl0ZScsICgpID0+IHtcbiAgaXQoJ3Nob3VsZCB0ZXN0IGZ1bmN0aW9uJywgKCkgPT4ge1xuICAgIGV4cGVjdCh0ZXN0RnVuY3Rpb24oJ2hlbGxvJykpLnRvQmUoJ0hFTExPJyk7XG4gIH0pO1xuICBcbiAgaXQoJ3Nob3VsZCB0ZXN0IGNsYXNzJywgKCkgPT4ge1xuICAgIGNvbnN0IGluc3RhbmNlID0gbmV3IFRlc3RDbGFzcyg0Mik7XG4gICAgZXhwZWN0KGluc3RhbmNlLmdldFZhbHVlKCkpLnRvQmUoNDIpO1xuICB9KTtcbn0pO2AsXG4gICAgICBqYXZhc2NyaXB0OiBgXG5jb25zdCB7IHRlc3RGdW5jdGlvbiwgVGVzdENsYXNzIH0gPSByZXF1aXJlKCcuLi9zcmMvaW5kZXgnKTtcblxuZGVzY3JpYmUoJ1Rlc3QgU3VpdGUnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgdGVzdCBmdW5jdGlvbicsICgpID0+IHtcbiAgICBleHBlY3QodGVzdEZ1bmN0aW9uKCdoZWxsbycpKS50b0JlKCdIRUxMTycpO1xuICB9KTtcbiAgXG4gIGl0KCdzaG91bGQgdGVzdCBjbGFzcycsICgpID0+IHtcbiAgICBjb25zdCBpbnN0YW5jZSA9IG5ldyBUZXN0Q2xhc3MoNDIpO1xuICAgIGV4cGVjdChpbnN0YW5jZS5nZXRWYWx1ZSgpKS50b0JlKDQyKTtcbiAgfSk7XG59KTtgXG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gdGVtcGxhdGVzW2xhbmd1YWdlXTtcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVUaW1lc3RhbXAoKTogbnVtYmVyIHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IG9uZVllYXIgPSAzNjUgKiAyNCAqIDYwICogNjAgKiAxMDAwO1xuICAgIHJldHVybiBub3cgLSB0aGlzLnJhbmRvbUludCgwLCBvbmVZZWFyKTtcbiAgfVxuXG4gIHByaXZhdGUgcmFuZG9tSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XG4gIH1cblxuICBwcml2YXRlIHJhbmRvbUZsb2F0KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSArIG1pbjtcbiAgfVxuXG4gIHByaXZhdGUgcmFuZG9tQm9vbGVhbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSA8IDAuNTtcbiAgfVxuXG4gIHByaXZhdGUgcmFuZG9tQ2hvaWNlPFQ+KGFycmF5OiByZWFkb25seSBUW10pOiBUIHtcbiAgICByZXR1cm4gYXJyYXlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXJyYXkubGVuZ3RoKV07XG4gIH1cbn1cblxuLy8gQ29udmVuaWVuY2UgaW5zdGFuY2UgZm9yIGVhc3kgdXNlXG5leHBvcnQgY29uc3QgdGVzdERhdGFGYWN0b3J5ID0gbmV3IFRlc3REYXRhRmFjdG9yeSgpOyJdLCJ2ZXJzaW9uIjozfQ==