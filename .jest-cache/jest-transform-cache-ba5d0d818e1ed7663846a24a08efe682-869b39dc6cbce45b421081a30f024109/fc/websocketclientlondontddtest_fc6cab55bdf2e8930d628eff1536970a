7ffb702b495fcef7abf9decc9e4774dd
/**
 * Claude-Zen WebSocket Client - London School TDD Tests
 *
 * Testing the Node.js 22 native WebSocket client using London School principles:
 * - Outside-in development from real-time communication requirements
 * - Mock-driven contracts for connection management
 * - Behavior verification for reconnection and error handling
 * - Focus on client-server interaction patterns
 */
import { jest, describe, it, expect, beforeEach, afterEach } from '@jest/globals';
// === MOCK DEPENDENCIES (London School Contract Definition) ===
// Mock Node.js WebSocket - Native WebSocket contract
const mockWebSocket = {
    connect: jest.fn(),
    send: jest.fn(),
    close: jest.fn(),
    on: jest.fn(),
    off: jest.fn(),
    readyState: 1, // OPEN
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
};
// Mock EventEmitter - Event handling contract
const mockEventEmitter = {
    emit: jest.fn(),
    on: jest.fn(),
    off: jest.fn(),
    removeAllListeners: jest.fn(),
};
// Mock Reconnection Manager - Connection resilience contract
const mockReconnectionManager = {
    shouldReconnect: jest.fn(),
    getReconnectDelay: jest.fn(),
    incrementAttempts: jest.fn(),
    resetAttempts: jest.fn(),
    isMaxAttemptsReached: jest.fn(),
};
// Mock Message Queue - Message buffering contract
const mockMessageQueue = {
    enqueue: jest.fn(),
    dequeue: jest.fn(),
    flush: jest.fn(),
    clear: jest.fn(),
    size: jest.fn(),
};
// Mock Heartbeat Manager - Connection health contract
const mockHeartbeatManager = {
    start: jest.fn(),
    stop: jest.fn(),
    ping: jest.fn(),
    onPong: jest.fn(),
    isHealthy: jest.fn(),
};
describe('Claude-Zen WebSocket Client - London School TDD', () => {
    // Mock WebSocket Client class (based on actual implementation structure)
    class MockWebSocketClient {
        ws;
        eventEmitter;
        reconnectionManager;
        messageQueue;
        heartbeatManager;
        url = '';
        options = {};
        constructor() {
            this.ws = null;
            this.eventEmitter = mockEventEmitter;
            this.reconnectionManager = mockReconnectionManager;
            this.messageQueue = mockMessageQueue;
            this.heartbeatManager = mockHeartbeatManager;
        }
        async connect(url, options = {}) {
            this.url = url;
            this.options = options;
            // Create WebSocket connection
            this.ws = mockWebSocket;
            await mockWebSocket.connect(url);
            // Setup event handlers
            mockWebSocket.on('open', this.handleOpen.bind(this));
            mockWebSocket.on('message', this.handleMessage.bind(this));
            mockWebSocket.on('close', this.handleClose.bind(this));
            mockWebSocket.on('error', this.handleError.bind(this));
            // Start heartbeat if enabled
            if (options.heartbeat) {
                mockHeartbeatManager.start();
            }
            return Promise.resolve();
        }
        async send(data) {
            if (this.isConnected()) {
                return mockWebSocket.send(JSON.stringify(data));
            }
            else {
                // Queue message for when connection is restored
                mockMessageQueue.enqueue(data);
                return Promise.resolve();
            }
        }
        isConnected() {
            return this.ws && mockWebSocket.readyState === mockWebSocket.OPEN;
        }
        handleOpen() {
            mockEventEmitter.emit('connected');
            mockReconnectionManager.resetAttempts();
            mockMessageQueue.flush();
        }
        handleMessage(data) {
            const parsed = JSON.parse(data);
            mockEventEmitter.emit('message', parsed);
        }
        handleClose(code, reason) {
            mockEventEmitter.emit('disconnected', { code, reason });
            mockHeartbeatManager.stop();
            if (mockReconnectionManager.shouldReconnect({ code, reason })) {
                this.attemptReconnection();
            }
        }
        handleError(error) {
            mockEventEmitter.emit('error', error);
        }
        async attemptReconnection() {
            if (!mockReconnectionManager.isMaxAttemptsReached()) {
                const delay = mockReconnectionManager.getReconnectDelay(1);
                mockReconnectionManager.incrementAttempts();
                setTimeout(() => {
                    this.connect(this.url, this.options);
                }, delay);
            }
        }
        on(event, handler) {
            mockEventEmitter.on(event, handler);
        }
    }
    describe('ðŸŽ¯ Acceptance Tests - Real-time Communication', () => {
        describe('User Story: WebSocket Connection Management', () => {
            it('should establish connection with proper event handling setup', async () => {
                // Arrange - Mock successful connection
                mockWebSocket.connect.mockResolvedValue(undefined);
                mockWebSocket.on.mockImplementation((event, handler) => {
                    // Simulate immediate connection success
                    if (event === 'open') {
                        setTimeout(() => handler(), 0);
                    }
                });
                mockHeartbeatManager.start.mockImplementation(() => { });
                const client = new MockWebSocketClient();
                const connectionHandler = jest.fn();
                client.on('connected', connectionHandler);
                // Act - Connect to WebSocket server
                await client.connect('ws://localhost:4000', {
                    heartbeat: true,
                    reconnect: true
                });
                // Assert - Verify connection establishment conversation
                expect(mockWebSocket.connect).toHaveBeenCalledWith('ws://localhost:4000');
                expect(mockWebSocket.on).toHaveBeenCalledWith('open', expect.any(Function));
                expect(mockWebSocket.on).toHaveBeenCalledWith('message', expect.any(Function));
                expect(mockWebSocket.on).toHaveBeenCalledWith('close', expect.any(Function));
                expect(mockWebSocket.on).toHaveBeenCalledWith('error', expect.any(Function));
                expect(mockHeartbeatManager.start).toHaveBeenCalled();
            });
        });
        describe('User Story: Message Transmission with Queuing', () => {
            it('should send messages immediately when connected, queue when disconnected', async () => {
                // Arrange - Mock connection states
                mockWebSocket.readyState = mockWebSocket.OPEN;
                mockWebSocket.send.mockResolvedValue(undefined);
                mockMessageQueue.enqueue.mockImplementation(() => { });
                const client = new MockWebSocketClient();
                client['ws'] = mockWebSocket; // Simulate connected state
                const connectedMessage = { type: 'task-update', data: { status: 'completed' } };
                const disconnectedMessage = { type: 'queen-status', data: { id: 'arch-001' } };
                // Act - Send message when connected
                await client.send(connectedMessage);
                // Simulate disconnection
                mockWebSocket.readyState = mockWebSocket.CLOSED;
                // Send message when disconnected
                await client.send(disconnectedMessage);
                // Assert - Verify message handling conversation
                expect(mockWebSocket.send).toHaveBeenCalledWith(JSON.stringify(connectedMessage));
                expect(mockMessageQueue.enqueue).toHaveBeenCalledWith(disconnectedMessage);
            });
        });
        describe('User Story: Automatic Reconnection with Backoff', () => {
            it('should handle connection loss with intelligent reconnection strategy', async () => {
                // Arrange - Mock reconnection logic
                mockReconnectionManager.shouldReconnect.mockReturnValue(true);
                mockReconnectionManager.isMaxAttemptsReached.mockReturnValue(false);
                mockReconnectionManager.getReconnectDelay.mockReturnValue(1000);
                mockReconnectionManager.incrementAttempts.mockImplementation(() => { });
                const client = new MockWebSocketClient();
                // Simulate connection established
                mockWebSocket.on.mockImplementation((event, handler) => {
                    if (event === 'close') {
                        // Store close handler for later invocation
                        setTimeout(() => handler(1006, 'Connection lost'), 0);
                    }
                });
                await client.connect('ws://localhost:4000', { reconnect: true });
                // Wait for close event to trigger reconnection logic
                await new Promise(resolve => setTimeout(resolve, 10));
                // Assert - Verify reconnection conversation
                expect(mockReconnectionManager.shouldReconnect).toHaveBeenCalledWith({
                    code: 1006,
                    reason: 'Connection lost'
                });
                expect(mockReconnectionManager.isMaxAttemptsReached).toHaveBeenCalled();
                expect(mockReconnectionManager.getReconnectDelay).toHaveBeenCalledWith(1);
                expect(mockReconnectionManager.incrementAttempts).toHaveBeenCalled();
            });
        });
    });
    describe('ðŸ”— Contract Verification - Component Integration', () => {
        describe('Heartbeat Integration', () => {
            it('should coordinate heartbeat with connection lifecycle', async () => {
                // Arrange - Mock heartbeat coordination
                mockHeartbeatManager.start.mockImplementation(() => { });
                mockHeartbeatManager.stop.mockImplementation(() => { });
                mockHeartbeatManager.ping.mockImplementation(() => { });
                mockHeartbeatManager.isHealthy.mockReturnValue(true);
                const client = new MockWebSocketClient();
                // Mock connection open/close events
                mockWebSocket.on.mockImplementation((event, handler) => {
                    if (event === 'open') {
                        setTimeout(() => handler(), 0);
                    }
                    else if (event === 'close') {
                        setTimeout(() => handler(1000, 'Normal closure'), 100);
                    }
                });
                // Act - Connect and then disconnect
                await client.connect('ws://localhost:4000', { heartbeat: true });
                // Simulate close event
                await new Promise(resolve => setTimeout(resolve, 150));
                // Assert - Verify heartbeat lifecycle conversation
                expect(mockHeartbeatManager.start).toHaveBeenCalled();
                expect(mockHeartbeatManager.stop).toHaveBeenCalled();
            });
        });
        describe('Message Queue Integration', () => {
            it('should flush queued messages upon reconnection', async () => {
                // Arrange - Mock queue flush on reconnection
                mockMessageQueue.flush.mockImplementation(() => { });
                mockMessageQueue.enqueue.mockImplementation(() => { });
                mockReconnectionManager.resetAttempts.mockImplementation(() => { });
                const client = new MockWebSocketClient();
                // Mock successful reconnection
                mockWebSocket.on.mockImplementation((event, handler) => {
                    if (event === 'open') {
                        setTimeout(() => handler(), 0);
                    }
                });
                // Act - Simulate reconnection
                await client.connect('ws://localhost:4000');
                // Wait for open event
                await new Promise(resolve => setTimeout(resolve, 10));
                // Assert - Verify message queue integration conversation
                expect(mockMessageQueue.flush).toHaveBeenCalled();
                expect(mockReconnectionManager.resetAttempts).toHaveBeenCalled();
            });
        });
    });
    describe('ðŸ§ª London School Patterns - WebSocket Communication', () => {
        it('should demonstrate event-driven interaction testing', () => {
            // London School: Test HOW events flow through the system
            const mockEventBus = {
                subscribe: jest.fn(),
                publish: jest.fn(),
                unsubscribe: jest.fn()
            };
            const eventDrivenClient = {
                setupEventHandlers: () => {
                    mockEventBus.subscribe('connection-status', (status) => {
                        if (status === 'connected') {
                            mockEventBus.publish('ready-for-messages', true);
                        }
                    });
                    mockEventBus.subscribe('message-received', (message) => {
                        mockEventBus.publish('message-processed', message.id);
                    });
                }
            };
            // Act - Setup event handling
            eventDrivenClient.setupEventHandlers();
            // Simulate events
            mockEventBus.subscribe.mock.calls[0][1]('connected');
            mockEventBus.subscribe.mock.calls[1][1]({ id: 'msg-123', data: 'test' });
            // Assert - Verify event interaction conversation
            expect(mockEventBus.subscribe).toHaveBeenCalledWith('connection-status', expect.any(Function));
            expect(mockEventBus.subscribe).toHaveBeenCalledWith('message-received', expect.any(Function));
            expect(mockEventBus.publish).toHaveBeenCalledWith('ready-for-messages', true);
            expect(mockEventBus.publish).toHaveBeenCalledWith('message-processed', 'msg-123');
        });
        it('should use mocks to drive connection resilience design', () => {
            // London School: Mocks help discover optimal resilience patterns
            const mockResilienceStrategy = {
                evaluateConnectionHealth: jest.fn(),
                determineReconnectionStrategy: jest.fn(),
                executeRecoveryPlan: jest.fn()
            };
            const resilientClient = {
                handleConnectionIssue: async (issue) => {
                    const health = mockResilienceStrategy.evaluateConnectionHealth(issue);
                    const strategy = mockResilienceStrategy.determineReconnectionStrategy(health);
                    return mockResilienceStrategy.executeRecoveryPlan(strategy);
                }
            };
            // Mock the resilience conversation
            mockResilienceStrategy.evaluateConnectionHealth.mockReturnValue({ severity: 'moderate' });
            mockResilienceStrategy.determineReconnectionStrategy.mockReturnValue({ type: 'exponential-backoff' });
            mockResilienceStrategy.executeRecoveryPlan.mockResolvedValue({ success: true });
            // Act - Test resilience design
            const connectionIssue = { type: 'timeout', duration: 5000 };
            resilientClient.handleConnectionIssue(connectionIssue);
            // Assert - Verify resilience interface exists and behaves correctly
            expect(mockResilienceStrategy.evaluateConnectionHealth).toHaveBeenCalledWith(connectionIssue);
            expect(mockResilienceStrategy.determineReconnectionStrategy).toHaveBeenCalledWith({ severity: 'moderate' });
            expect(mockResilienceStrategy.executeRecoveryPlan).toHaveBeenCalledWith({ type: 'exponential-backoff' });
        });
    });
    // Clean test isolation - London School principle
    beforeEach(() => {
        jest.clearAllMocks();
        // Reset WebSocket state
        mockWebSocket.readyState = mockWebSocket.CLOSED;
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3NyYy9fX3Rlc3RzX18vaW50ZWdyYXRpb24vd2Vic29ja2V0LWNsaWVudC1sb25kb24tdGRkLnRlc3QudHMiLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7O0dBUUc7QUFFSCxPQUFPLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFbEYsZ0VBQWdFO0FBRWhFLHFEQUFxRDtBQUNyRCxNQUFNLGFBQWEsR0FBRztJQUNwQixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNsQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hCLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2IsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZCxVQUFVLEVBQUUsQ0FBQyxFQUFFLE9BQU87SUFDdEIsVUFBVSxFQUFFLENBQUM7SUFDYixJQUFJLEVBQUUsQ0FBQztJQUNQLE9BQU8sRUFBRSxDQUFDO0lBQ1YsTUFBTSxFQUFFLENBQUM7Q0FDVixDQUFDO0FBRUYsOENBQThDO0FBQzlDLE1BQU0sZ0JBQWdCLEdBQUc7SUFDdkIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZixFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNiLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2Qsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUM5QixDQUFDO0FBRUYsNkRBQTZEO0FBQzdELE1BQU0sdUJBQXVCLEdBQUc7SUFDOUIsZUFBZSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDMUIsaUJBQWlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM1QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFB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RXZELG9FQUFvRTtZQUNwRSxNQUFNLENBQUMsc0JBQXNCLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUM5RixNQUFNLENBQUMsc0JBQXNCLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO1lBQzVHLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLEVBQUUsSUFBSSxFQUFFLHFCQUFxQixFQUFFLENBQUMsQ0FBQztRQUMzRyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsaURBQWlEO0lBQ2pELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDckIsd0JBQXdCO1FBQ3hCLGFBQWEsQ0FBQyxVQUFVLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQztJQUNsRCxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDekIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9taHVnby9jb2RlL2NsYXVkZS1jb2RlLWZsb3cvc3JjL19fdGVzdHNfXy9pbnRlZ3JhdGlvbi93ZWJzb2NrZXQtY2xpZW50LWxvbmRvbi10ZGQudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENsYXVkZS1aZW4gV2ViU29ja2V0IENsaWVudCAtIExvbmRvbiBTY2hvb2wgVEREIFRlc3RzXG4gKiBcbiAqIFRlc3RpbmcgdGhlIE5vZGUuanMgMjIgbmF0aXZlIFdlYlNvY2tldCBjbGllbnQgdXNpbmcgTG9uZG9uIFNjaG9vbCBwcmluY2lwbGVzOlxuICogLSBPdXRzaWRlLWluIGRldmVsb3BtZW50IGZyb20gcmVhbC10aW1lIGNvbW11bmljYXRpb24gcmVxdWlyZW1lbnRzXG4gKiAtIE1vY2stZHJpdmVuIGNvbnRyYWN0cyBmb3IgY29ubmVjdGlvbiBtYW5hZ2VtZW50XG4gKiAtIEJlaGF2aW9yIHZlcmlmaWNhdGlvbiBmb3IgcmVjb25uZWN0aW9uIGFuZCBlcnJvciBoYW5kbGluZ1xuICogLSBGb2N1cyBvbiBjbGllbnQtc2VydmVyIGludGVyYWN0aW9uIHBhdHRlcm5zXG4gKi9cblxuaW1wb3J0IHsgamVzdCwgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuXG4vLyA9PT0gTU9DSyBERVBFTkRFTkNJRVMgKExvbmRvbiBTY2hvb2wgQ29udHJhY3QgRGVmaW5pdGlvbikgPT09XG5cbi8vIE1vY2sgTm9kZS5qcyBXZWJTb2NrZXQgLSBOYXRpdmUgV2ViU29ja2V0IGNvbnRyYWN0XG5jb25zdCBtb2NrV2ViU29ja2V0ID0ge1xuICBjb25uZWN0OiBqZXN0LmZuKCksXG4gIHNlbmQ6IGplc3QuZm4oKSxcbiAgY2xvc2U6IGplc3QuZm4oKSxcbiAgb246IGplc3QuZm4oKSxcbiAgb2ZmOiBqZXN0LmZuKCksXG4gIHJlYWR5U3RhdGU6IDEsIC8vIE9QRU5cbiAgQ09OTkVDVElORzogMCxcbiAgT1BFTjogMSxcbiAgQ0xPU0lORzogMixcbiAgQ0xPU0VEOiAzLFxufTtcblxuLy8gTW9jayBFdmVudEVtaXR0ZXIgLSBFdmVudCBoYW5kbGluZyBjb250cmFjdFxuY29uc3QgbW9ja0V2ZW50RW1pdHRlciA9IHtcbiAgZW1pdDogamVzdC5mbigpLFxuICBvbjogamVzdC5mbigpLFxuICBvZmY6IGplc3QuZm4oKSxcbiAgcmVtb3ZlQWxsTGlzdGVuZXJzOiBqZXN0LmZuKCksXG59O1xuXG4vLyBNb2NrIFJlY29ubmVjdGlvbiBNYW5hZ2VyIC0gQ29ubmVjdGlvbiByZXNpbGllbmNlIGNvbnRyYWN0XG5jb25zdCBtb2NrUmVjb25uZWN0aW9uTWFuYWdlciA9IHtcbiAgc2hvdWxkUmVjb25uZWN0OiBqZXN0LmZuKCksXG4gIGdldFJlY29ubmVjdERlbGF5OiBqZXN0LmZuKCksXG4gIGluY3JlbWVudEF0dGVtcHRzOiBqZXN0LmZuKCksXG4gIHJlc2V0QXR0ZW1wdHM6IGplc3QuZm4oKSxcbiAgaXNNYXhBdHRlbXB0c1JlYWNoZWQ6IGplc3QuZm4oKSxcbn07XG5cbi8vIE1vY2sgTWVzc2FnZSBRdWV1ZSAtIE1lc3NhZ2UgYnVmZmVyaW5nIGNvbnRyYWN0XG5jb25zdCBtb2NrTWVzc2FnZVF1ZXVlID0ge1xuICBlbnF1ZXVlOiBqZXN0LmZuKCksXG4gIGRlcXVldWU6IGplc3QuZm4oKSxcbiAgZmx1c2g6IGplc3QuZm4oKSxcbiAgY2xlYXI6IGplc3QuZm4oKSxcbiAgc2l6ZTogamVzdC5mbigpLFxufTtcblxuLy8gTW9jayBIZWFydGJlYXQgTWFuYWdlciAtIENvbm5lY3Rpb24gaGVhbHRoIGNvbnRyYWN0XG5jb25zdCBtb2NrSGVhcnRiZWF0TWFuYWdlciA9IHtcbiAgc3RhcnQ6IGplc3QuZm4oKSxcbiAgc3RvcDogamVzdC5mbigpLFxuICBwaW5nOiBqZXN0LmZuKCksXG4gIG9uUG9uZzogamVzdC5mbigpLFxuICBpc0hlYWx0aHk6IGplc3QuZm4oKSxcbn07XG5cbi8vID09PSBDT05UUkFDVCBJTlRFUkZBQ0VTID09PVxuXG5pbnRlcmZhY2UgV2ViU29ja2V0Q2xpZW50Q29udHJhY3Qge1xuICBjb25uZWN0KHVybDogc3RyaW5nLCBvcHRpb25zPzogYW55KTogUHJvbWlzZTx2b2lkPjtcbiAgc2VuZChkYXRhOiBhbnkpOiBQcm9taXNlPHZvaWQ+O1xuICBkaXNjb25uZWN0KCk6IFByb21pc2U8dm9pZD47XG4gIGlzQ29ubmVjdGVkKCk6IGJvb2xlYW47XG4gIG9uKGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEZ1bmN0aW9uKTogdm9pZDtcbiAgb2ZmKGV2ZW50OiBzdHJpbmcsIGhhbmRsZXI6IEZ1bmN0aW9uKTogdm9pZDtcbn1cblxuaW50ZXJmYWNlIFJlY29ubmVjdGlvbkNvbnRyYWN0IHtcbiAgc2hvdWxkUmVjb25uZWN0KGVycm9yOiBhbnkpOiBib29sZWFuO1xuICBnZXRSZWNvbm5lY3REZWxheShhdHRlbXB0OiBudW1iZXIpOiBudW1iZXI7XG4gIGhhbmRsZVJlY29ubmVjdGlvbigpOiBQcm9taXNlPHZvaWQ+O1xufVxuXG5pbnRlcmZhY2UgTWVzc2FnZVF1ZXVlQ29udHJhY3Qge1xuICBlbnF1ZXVlKG1lc3NhZ2U6IGFueSk6IHZvaWQ7XG4gIGZsdXNoKCk6IFByb21pc2U8dm9pZD47XG4gIGNsZWFyKCk6IHZvaWQ7XG59XG5cbmRlc2NyaWJlKCdDbGF1ZGUtWmVuIFdlYlNvY2tldCBDbGllbnQgLSBMb25kb24gU2Nob29sIFRERCcsICgpID0+IHtcbiAgXG4gIC8vIE1vY2sgV2ViU29ja2V0IENsaWVudCBjbGFzcyAoYmFzZWQgb24gYWN0dWFsIGltcGxlbWVudGF0aW9uIHN0cnVjdHVyZSlcbiAgY2xhc3MgTW9ja1dlYlNvY2tldENsaWVudCB7XG4gICAgcHJpdmF0ZSB3czogYW55O1xuICAgIHByaXZhdGUgZXZlbnRFbWl0dGVyOiBhbnk7XG4gICAgcHJpdmF0ZSByZWNvbm5lY3Rpb25NYW5hZ2VyOiBhbnk7XG4gICAgcHJpdmF0ZSBtZXNzYWdlUXVldWU6IGFueTtcbiAgICBwcml2YXRlIGhlYXJ0YmVhdE1hbmFnZXI6IGFueTtcbiAgICBwcml2YXRlIHVybDogc3RyaW5nID0gJyc7XG4gICAgcHJpdmF0ZSBvcHRpb25zOiBhbnkgPSB7fTtcbiAgICBcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgIHRoaXMud3MgPSBudWxsO1xuICAgICAgdGhpcy5ldmVudEVtaXR0ZXIgPSBtb2NrRXZlbnRFbWl0dGVyO1xuICAgICAgdGhpcy5yZWNvbm5lY3Rpb25NYW5hZ2VyID0gbW9ja1JlY29ubmVjdGlvbk1hbmFnZXI7XG4gICAgICB0aGlzLm1lc3NhZ2VRdWV1ZSA9IG1vY2tNZXNzYWdlUXVldWU7XG4gICAgICB0aGlzLmhlYXJ0YmVhdE1hbmFnZXIgPSBtb2NrSGVhcnRiZWF0TWFuYWdlcjtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgY29ubmVjdCh1cmw6IHN0cmluZywgb3B0aW9uczogYW55ID0ge30pIHtcbiAgICAgIHRoaXMudXJsID0gdXJsO1xuICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIFdlYlNvY2tldCBjb25uZWN0aW9uXG4gICAgICB0aGlzLndzID0gbW9ja1dlYlNvY2tldDtcbiAgICAgIGF3YWl0IG1vY2tXZWJTb2NrZXQuY29ubmVjdCh1cmwpO1xuICAgICAgXG4gICAgICAvLyBTZXR1cCBldmVudCBoYW5kbGVyc1xuICAgICAgbW9ja1dlYlNvY2tldC5vbignb3BlbicsIHRoaXMuaGFuZGxlT3Blbi5iaW5kKHRoaXMpKTtcbiAgICAgIG1vY2tXZWJTb2NrZXQub24oJ21lc3NhZ2UnLCB0aGlzLmhhbmRsZU1lc3NhZ2UuYmluZCh0aGlzKSk7XG4gICAgICBtb2NrV2ViU29ja2V0Lm9uKCdjbG9zZScsIHRoaXMuaGFuZGxlQ2xvc2UuYmluZCh0aGlzKSk7XG4gICAgICBtb2NrV2ViU29ja2V0Lm9uKCdlcnJvcicsIHRoaXMuaGFuZGxlRXJyb3IuYmluZCh0aGlzKSk7XG4gICAgICBcbiAgICAgIC8vIFN0YXJ0IGhlYXJ0YmVhdCBpZiBlbmFibGVkXG4gICAgICBpZiAob3B0aW9ucy5oZWFydGJlYXQpIHtcbiAgICAgICAgbW9ja0hlYXJ0YmVhdE1hbmFnZXIuc3RhcnQoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBcbiAgICBhc3luYyBzZW5kKGRhdGE6IGFueSkge1xuICAgICAgaWYgKHRoaXMuaXNDb25uZWN0ZWQoKSkge1xuICAgICAgICByZXR1cm4gbW9ja1dlYlNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFF1ZXVlIG1lc3NhZ2UgZm9yIHdoZW4gY29ubmVjdGlvbiBpcyByZXN0b3JlZFxuICAgICAgICBtb2NrTWVzc2FnZVF1ZXVlLmVucXVldWUoZGF0YSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgaXNDb25uZWN0ZWQoKTogYm9vbGVhbiB7XG4gICAgICByZXR1cm4gdGhpcy53cyAmJiBtb2NrV2ViU29ja2V0LnJlYWR5U3RhdGUgPT09IG1vY2tXZWJTb2NrZXQuT1BFTjtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBoYW5kbGVPcGVuKCkge1xuICAgICAgbW9ja0V2ZW50RW1pdHRlci5lbWl0KCdjb25uZWN0ZWQnKTtcbiAgICAgIG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLnJlc2V0QXR0ZW1wdHMoKTtcbiAgICAgIG1vY2tNZXNzYWdlUXVldWUuZmx1c2goKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBoYW5kbGVNZXNzYWdlKGRhdGE6IGFueSkge1xuICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIG1vY2tFdmVudEVtaXR0ZXIuZW1pdCgnbWVzc2FnZScsIHBhcnNlZCk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgaGFuZGxlQ2xvc2UoY29kZTogbnVtYmVyLCByZWFzb246IHN0cmluZykge1xuICAgICAgbW9ja0V2ZW50RW1pdHRlci5lbWl0KCdkaXNjb25uZWN0ZWQnLCB7IGNvZGUsIHJlYXNvbiB9KTtcbiAgICAgIG1vY2tIZWFydGJlYXRNYW5hZ2VyLnN0b3AoKTtcbiAgICAgIFxuICAgICAgaWYgKG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLnNob3VsZFJlY29ubmVjdCh7IGNvZGUsIHJlYXNvbiB9KSkge1xuICAgICAgICB0aGlzLmF0dGVtcHRSZWNvbm5lY3Rpb24oKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBoYW5kbGVFcnJvcihlcnJvcjogYW55KSB7XG4gICAgICBtb2NrRXZlbnRFbWl0dGVyLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIGFzeW5jIGF0dGVtcHRSZWNvbm5lY3Rpb24oKSB7XG4gICAgICBpZiAoIW1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLmlzTWF4QXR0ZW1wdHNSZWFjaGVkKCkpIHtcbiAgICAgICAgY29uc3QgZGVsYXkgPSBtb2NrUmVjb25uZWN0aW9uTWFuYWdlci5nZXRSZWNvbm5lY3REZWxheSgxKTtcbiAgICAgICAgbW9ja1JlY29ubmVjdGlvbk1hbmFnZXIuaW5jcmVtZW50QXR0ZW1wdHMoKTtcbiAgICAgICAgXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY29ubmVjdCh0aGlzLnVybCwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBvbihldmVudDogc3RyaW5nLCBoYW5kbGVyOiBGdW5jdGlvbikge1xuICAgICAgbW9ja0V2ZW50RW1pdHRlci5vbihldmVudCwgaGFuZGxlcik7XG4gICAgfVxuICB9XG5cbiAgZGVzY3JpYmUoJ/Cfjq8gQWNjZXB0YW5jZSBUZXN0cyAtIFJlYWwtdGltZSBDb21tdW5pY2F0aW9uJywgKCkgPT4ge1xuICAgIFxuICAgIGRlc2NyaWJlKCdVc2VyIFN0b3J5OiBXZWJTb2NrZXQgQ29ubmVjdGlvbiBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBlc3RhYmxpc2ggY29ubmVjdGlvbiB3aXRoIHByb3BlciBldmVudCBoYW5kbGluZyBzZXR1cCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZSAtIE1vY2sgc3VjY2Vzc2Z1bCBjb25uZWN0aW9uXG4gICAgICAgIG1vY2tXZWJTb2NrZXQuY29ubmVjdC5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuICAgICAgICBtb2NrV2ViU29ja2V0Lm9uLm1vY2tJbXBsZW1lbnRhdGlvbigoZXZlbnQsIGhhbmRsZXIpID0+IHtcbiAgICAgICAgICAvLyBTaW11bGF0ZSBpbW1lZGlhdGUgY29ubmVjdGlvbiBzdWNjZXNzXG4gICAgICAgICAgaWYgKGV2ZW50ID09PSAnb3BlbicpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gaGFuZGxlcigpLCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBtb2NrSGVhcnRiZWF0TWFuYWdlci5zdGFydC5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE1vY2tXZWJTb2NrZXRDbGllbnQoKTtcbiAgICAgICAgY29uc3QgY29ubmVjdGlvbkhhbmRsZXIgPSBqZXN0LmZuKCk7XG4gICAgICAgIGNsaWVudC5vbignY29ubmVjdGVkJywgY29ubmVjdGlvbkhhbmRsZXIpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWN0IC0gQ29ubmVjdCB0byBXZWJTb2NrZXQgc2VydmVyXG4gICAgICAgIGF3YWl0IGNsaWVudC5jb25uZWN0KCd3czovL2xvY2FsaG9zdDo0MDAwJywgeyBcbiAgICAgICAgICBoZWFydGJlYXQ6IHRydWUsXG4gICAgICAgICAgcmVjb25uZWN0OiB0cnVlIFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSBjb25uZWN0aW9uIGVzdGFibGlzaG1lbnQgY29udmVyc2F0aW9uXG4gICAgICAgIGV4cGVjdChtb2NrV2ViU29ja2V0LmNvbm5lY3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd3czovL2xvY2FsaG9zdDo0MDAwJyk7XG4gICAgICAgIGV4cGVjdChtb2NrV2ViU29ja2V0Lm9uKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnb3BlbicsIGV4cGVjdC5hbnkoRnVuY3Rpb24pKTtcbiAgICAgICAgZXhwZWN0KG1vY2tXZWJTb2NrZXQub24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdtZXNzYWdlJywgZXhwZWN0LmFueShGdW5jdGlvbikpO1xuICAgICAgICBleHBlY3QobW9ja1dlYlNvY2tldC5vbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2Nsb3NlJywgZXhwZWN0LmFueShGdW5jdGlvbikpO1xuICAgICAgICBleHBlY3QobW9ja1dlYlNvY2tldC5vbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ2Vycm9yJywgZXhwZWN0LmFueShGdW5jdGlvbikpO1xuICAgICAgICBleHBlY3QobW9ja0hlYXJ0YmVhdE1hbmFnZXIuc3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ1VzZXIgU3Rvcnk6IE1lc3NhZ2UgVHJhbnNtaXNzaW9uIHdpdGggUXVldWluZycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgc2VuZCBtZXNzYWdlcyBpbW1lZGlhdGVseSB3aGVuIGNvbm5lY3RlZCwgcXVldWUgd2hlbiBkaXNjb25uZWN0ZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIGNvbm5lY3Rpb24gc3RhdGVzXG4gICAgICAgIG1vY2tXZWJTb2NrZXQucmVhZHlTdGF0ZSA9IG1vY2tXZWJTb2NrZXQuT1BFTjtcbiAgICAgICAgbW9ja1dlYlNvY2tldC5zZW5kLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCk7XG4gICAgICAgIG1vY2tNZXNzYWdlUXVldWUuZW5xdWV1ZS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY2xpZW50ID0gbmV3IE1vY2tXZWJTb2NrZXRDbGllbnQoKTtcbiAgICAgICAgY2xpZW50Wyd3cyddID0gbW9ja1dlYlNvY2tldDsgLy8gU2ltdWxhdGUgY29ubmVjdGVkIHN0YXRlXG4gICAgICAgIFxuICAgICAgICBjb25zdCBjb25uZWN0ZWRNZXNzYWdlID0geyB0eXBlOiAndGFzay11cGRhdGUnLCBkYXRhOiB7IHN0YXR1czogJ2NvbXBsZXRlZCcgfSB9O1xuICAgICAgICBjb25zdCBkaXNjb25uZWN0ZWRNZXNzYWdlID0geyB0eXBlOiAncXVlZW4tc3RhdHVzJywgZGF0YTogeyBpZDogJ2FyY2gtMDAxJyB9IH07XG4gICAgICAgIFxuICAgICAgICAvLyBBY3QgLSBTZW5kIG1lc3NhZ2Ugd2hlbiBjb25uZWN0ZWRcbiAgICAgICAgYXdhaXQgY2xpZW50LnNlbmQoY29ubmVjdGVkTWVzc2FnZSk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaW11bGF0ZSBkaXNjb25uZWN0aW9uXG4gICAgICAgIG1vY2tXZWJTb2NrZXQucmVhZHlTdGF0ZSA9IG1vY2tXZWJTb2NrZXQuQ0xPU0VEO1xuICAgICAgICBcbiAgICAgICAgLy8gU2VuZCBtZXNzYWdlIHdoZW4gZGlzY29ubmVjdGVkXG4gICAgICAgIGF3YWl0IGNsaWVudC5zZW5kKGRpc2Nvbm5lY3RlZE1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IG1lc3NhZ2UgaGFuZGxpbmcgY29udmVyc2F0aW9uXG4gICAgICAgIGV4cGVjdChtb2NrV2ViU29ja2V0LnNlbmQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KGNvbm5lY3RlZE1lc3NhZ2UpXG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrTWVzc2FnZVF1ZXVlLmVucXVldWUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGRpc2Nvbm5lY3RlZE1lc3NhZ2UpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnVXNlciBTdG9yeTogQXV0b21hdGljIFJlY29ubmVjdGlvbiB3aXRoIEJhY2tvZmYnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25uZWN0aW9uIGxvc3Mgd2l0aCBpbnRlbGxpZ2VudCByZWNvbm5lY3Rpb24gc3RyYXRlZ3knLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIHJlY29ubmVjdGlvbiBsb2dpY1xuICAgICAgICBtb2NrUmVjb25uZWN0aW9uTWFuYWdlci5zaG91bGRSZWNvbm5lY3QubW9ja1JldHVyblZhbHVlKHRydWUpO1xuICAgICAgICBtb2NrUmVjb25uZWN0aW9uTWFuYWdlci5pc01heEF0dGVtcHRzUmVhY2hlZC5tb2NrUmV0dXJuVmFsdWUoZmFsc2UpO1xuICAgICAgICBtb2NrUmVjb25uZWN0aW9uTWFuYWdlci5nZXRSZWNvbm5lY3REZWxheS5tb2NrUmV0dXJuVmFsdWUoMTAwMCk7XG4gICAgICAgIG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLmluY3JlbWVudEF0dGVtcHRzLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjbGllbnQgPSBuZXcgTW9ja1dlYlNvY2tldENsaWVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2ltdWxhdGUgY29ubmVjdGlvbiBlc3RhYmxpc2hlZFxuICAgICAgICBtb2NrV2ViU29ja2V0Lm9uLm1vY2tJbXBsZW1lbnRhdGlvbigoZXZlbnQsIGhhbmRsZXIpID0+IHtcbiAgICAgICAgICBpZiAoZXZlbnQgPT09ICdjbG9zZScpIHtcbiAgICAgICAgICAgIC8vIFN0b3JlIGNsb3NlIGhhbmRsZXIgZm9yIGxhdGVyIGludm9jYXRpb25cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gaGFuZGxlcigxMDA2LCAnQ29ubmVjdGlvbiBsb3N0JyksIDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBhd2FpdCBjbGllbnQuY29ubmVjdCgnd3M6Ly9sb2NhbGhvc3Q6NDAwMCcsIHsgcmVjb25uZWN0OiB0cnVlIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gV2FpdCBmb3IgY2xvc2UgZXZlbnQgdG8gdHJpZ2dlciByZWNvbm5lY3Rpb24gbG9naWNcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgcmVjb25uZWN0aW9uIGNvbnZlcnNhdGlvblxuICAgICAgICBleHBlY3QobW9ja1JlY29ubmVjdGlvbk1hbmFnZXIuc2hvdWxkUmVjb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgICAgY29kZTogMTAwNixcbiAgICAgICAgICByZWFzb246ICdDb25uZWN0aW9uIGxvc3QnXG4gICAgICAgIH0pO1xuICAgICAgICBleHBlY3QobW9ja1JlY29ubmVjdGlvbk1hbmFnZXIuaXNNYXhBdHRlbXB0c1JlYWNoZWQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgZXhwZWN0KG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLmdldFJlY29ubmVjdERlbGF5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgxKTtcbiAgICAgICAgZXhwZWN0KG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLmluY3JlbWVudEF0dGVtcHRzKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ/CflJcgQ29udHJhY3QgVmVyaWZpY2F0aW9uIC0gQ29tcG9uZW50IEludGVncmF0aW9uJywgKCkgPT4ge1xuICAgIFxuICAgIGRlc2NyaWJlKCdIZWFydGJlYXQgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGNvb3JkaW5hdGUgaGVhcnRiZWF0IHdpdGggY29ubmVjdGlvbiBsaWZlY3ljbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIGhlYXJ0YmVhdCBjb29yZGluYXRpb25cbiAgICAgICAgbW9ja0hlYXJ0YmVhdE1hbmFnZXIuc3RhcnQubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgICAgICAgbW9ja0hlYXJ0YmVhdE1hbmFnZXIuc3RvcC5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xuICAgICAgICBtb2NrSGVhcnRiZWF0TWFuYWdlci5waW5nLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgICAgIG1vY2tIZWFydGJlYXRNYW5hZ2VyLmlzSGVhbHRoeS5tb2NrUmV0dXJuVmFsdWUodHJ1ZSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBjbGllbnQgPSBuZXcgTW9ja1dlYlNvY2tldENsaWVudCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gTW9jayBjb25uZWN0aW9uIG9wZW4vY2xvc2UgZXZlbnRzXG4gICAgICAgIG1vY2tXZWJTb2NrZXQub24ubW9ja0ltcGxlbWVudGF0aW9uKChldmVudCwgaGFuZGxlcikgPT4ge1xuICAgICAgICAgIGlmIChldmVudCA9PT0gJ29wZW4nKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGhhbmRsZXIoKSwgMCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChldmVudCA9PT0gJ2Nsb3NlJykge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBoYW5kbGVyKDEwMDAsICdOb3JtYWwgY2xvc3VyZScpLCAxMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBY3QgLSBDb25uZWN0IGFuZCB0aGVuIGRpc2Nvbm5lY3RcbiAgICAgICAgYXdhaXQgY2xpZW50LmNvbm5lY3QoJ3dzOi8vbG9jYWxob3N0OjQwMDAnLCB7IGhlYXJ0YmVhdDogdHJ1ZSB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNpbXVsYXRlIGNsb3NlIGV2ZW50XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxNTApKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSBoZWFydGJlYXQgbGlmZWN5Y2xlIGNvbnZlcnNhdGlvblxuICAgICAgICBleHBlY3QobW9ja0hlYXJ0YmVhdE1hbmFnZXIuc3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgZXhwZWN0KG1vY2tIZWFydGJlYXRNYW5hZ2VyLnN0b3ApLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ01lc3NhZ2UgUXVldWUgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGZsdXNoIHF1ZXVlZCBtZXNzYWdlcyB1cG9uIHJlY29ubmVjdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZSAtIE1vY2sgcXVldWUgZmx1c2ggb24gcmVjb25uZWN0aW9uXG4gICAgICAgIG1vY2tNZXNzYWdlUXVldWUuZmx1c2gubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgICAgICAgbW9ja01lc3NhZ2VRdWV1ZS5lbnF1ZXVlLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiB7fSk7XG4gICAgICAgIG1vY2tSZWNvbm5lY3Rpb25NYW5hZ2VyLnJlc2V0QXR0ZW1wdHMubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBNb2NrV2ViU29ja2V0Q2xpZW50KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNb2NrIHN1Y2Nlc3NmdWwgcmVjb25uZWN0aW9uXG4gICAgICAgIG1vY2tXZWJTb2NrZXQub24ubW9ja0ltcGxlbWVudGF0aW9uKChldmVudCwgaGFuZGxlcikgPT4ge1xuICAgICAgICAgIGlmIChldmVudCA9PT0gJ29wZW4nKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGhhbmRsZXIoKSwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFjdCAtIFNpbXVsYXRlIHJlY29ubmVjdGlvblxuICAgICAgICBhd2FpdCBjbGllbnQuY29ubmVjdCgnd3M6Ly9sb2NhbGhvc3Q6NDAwMCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gV2FpdCBmb3Igb3BlbiBldmVudFxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTApKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSBtZXNzYWdlIHF1ZXVlIGludGVncmF0aW9uIGNvbnZlcnNhdGlvblxuICAgICAgICBleHBlY3QobW9ja01lc3NhZ2VRdWV1ZS5mbHVzaCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBleHBlY3QobW9ja1JlY29ubmVjdGlvbk1hbmFnZXIucmVzZXRBdHRlbXB0cykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCfwn6eqIExvbmRvbiBTY2hvb2wgUGF0dGVybnMgLSBXZWJTb2NrZXQgQ29tbXVuaWNhdGlvbicsICgpID0+IHtcbiAgICBcbiAgICBpdCgnc2hvdWxkIGRlbW9uc3RyYXRlIGV2ZW50LWRyaXZlbiBpbnRlcmFjdGlvbiB0ZXN0aW5nJywgKCkgPT4ge1xuICAgICAgLy8gTG9uZG9uIFNjaG9vbDogVGVzdCBIT1cgZXZlbnRzIGZsb3cgdGhyb3VnaCB0aGUgc3lzdGVtXG4gICAgICBjb25zdCBtb2NrRXZlbnRCdXMgPSB7XG4gICAgICAgIHN1YnNjcmliZTogamVzdC5mbigpLFxuICAgICAgICBwdWJsaXNoOiBqZXN0LmZuKCksXG4gICAgICAgIHVuc3Vic2NyaWJlOiBqZXN0LmZuKClcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGNvbnN0IGV2ZW50RHJpdmVuQ2xpZW50ID0ge1xuICAgICAgICBzZXR1cEV2ZW50SGFuZGxlcnM6ICgpID0+IHtcbiAgICAgICAgICBtb2NrRXZlbnRCdXMuc3Vic2NyaWJlKCdjb25uZWN0aW9uLXN0YXR1cycsIChzdGF0dXMpID0+IHtcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09ICdjb25uZWN0ZWQnKSB7XG4gICAgICAgICAgICAgIG1vY2tFdmVudEJ1cy5wdWJsaXNoKCdyZWFkeS1mb3ItbWVzc2FnZXMnLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBtb2NrRXZlbnRCdXMuc3Vic2NyaWJlKCdtZXNzYWdlLXJlY2VpdmVkJywgKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIG1vY2tFdmVudEJ1cy5wdWJsaXNoKCdtZXNzYWdlLXByb2Nlc3NlZCcsIG1lc3NhZ2UuaWQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBBY3QgLSBTZXR1cCBldmVudCBoYW5kbGluZ1xuICAgICAgZXZlbnREcml2ZW5DbGllbnQuc2V0dXBFdmVudEhhbmRsZXJzKCk7XG4gICAgICBcbiAgICAgIC8vIFNpbXVsYXRlIGV2ZW50c1xuICAgICAgbW9ja0V2ZW50QnVzLnN1YnNjcmliZS5tb2NrLmNhbGxzWzBdWzFdKCdjb25uZWN0ZWQnKTtcbiAgICAgIG1vY2tFdmVudEJ1cy5zdWJzY3JpYmUubW9jay5jYWxsc1sxXVsxXSh7IGlkOiAnbXNnLTEyMycsIGRhdGE6ICd0ZXN0JyB9KTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IGV2ZW50IGludGVyYWN0aW9uIGNvbnZlcnNhdGlvblxuICAgICAgZXhwZWN0KG1vY2tFdmVudEJ1cy5zdWJzY3JpYmUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdjb25uZWN0aW9uLXN0YXR1cycsIGV4cGVjdC5hbnkoRnVuY3Rpb24pKTtcbiAgICAgIGV4cGVjdChtb2NrRXZlbnRCdXMuc3Vic2NyaWJlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnbWVzc2FnZS1yZWNlaXZlZCcsIGV4cGVjdC5hbnkoRnVuY3Rpb24pKTtcbiAgICAgIGV4cGVjdChtb2NrRXZlbnRCdXMucHVibGlzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3JlYWR5LWZvci1tZXNzYWdlcycsIHRydWUpO1xuICAgICAgZXhwZWN0KG1vY2tFdmVudEJ1cy5wdWJsaXNoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnbWVzc2FnZS1wcm9jZXNzZWQnLCAnbXNnLTEyMycpO1xuICAgIH0pO1xuICAgIFxuICAgIGl0KCdzaG91bGQgdXNlIG1vY2tzIHRvIGRyaXZlIGNvbm5lY3Rpb24gcmVzaWxpZW5jZSBkZXNpZ24nLCAoKSA9PiB7XG4gICAgICAvLyBMb25kb24gU2Nob29sOiBNb2NrcyBoZWxwIGRpc2NvdmVyIG9wdGltYWwgcmVzaWxpZW5jZSBwYXR0ZXJuc1xuICAgICAgY29uc3QgbW9ja1Jlc2lsaWVuY2VTdHJhdGVneSA9IHtcbiAgICAgICAgZXZhbHVhdGVDb25uZWN0aW9uSGVhbHRoOiBqZXN0LmZuKCksXG4gICAgICAgIGRldGVybWluZVJlY29ubmVjdGlvblN0cmF0ZWd5OiBqZXN0LmZuKCksXG4gICAgICAgIGV4ZWN1dGVSZWNvdmVyeVBsYW46IGplc3QuZm4oKVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzaWxpZW50Q2xpZW50ID0ge1xuICAgICAgICBoYW5kbGVDb25uZWN0aW9uSXNzdWU6IGFzeW5jIChpc3N1ZTogYW55KSA9PiB7XG4gICAgICAgICAgY29uc3QgaGVhbHRoID0gbW9ja1Jlc2lsaWVuY2VTdHJhdGVneS5ldmFsdWF0ZUNvbm5lY3Rpb25IZWFsdGgoaXNzdWUpO1xuICAgICAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gbW9ja1Jlc2lsaWVuY2VTdHJhdGVneS5kZXRlcm1pbmVSZWNvbm5lY3Rpb25TdHJhdGVneShoZWFsdGgpO1xuICAgICAgICAgIHJldHVybiBtb2NrUmVzaWxpZW5jZVN0cmF0ZWd5LmV4ZWN1dGVSZWNvdmVyeVBsYW4oc3RyYXRlZ3kpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBNb2NrIHRoZSByZXNpbGllbmNlIGNvbnZlcnNhdGlvblxuICAgICAgbW9ja1Jlc2lsaWVuY2VTdHJhdGVneS5ldmFsdWF0ZUNvbm5lY3Rpb25IZWFsdGgubW9ja1JldHVyblZhbHVlKHsgc2V2ZXJpdHk6ICdtb2RlcmF0ZScgfSk7XG4gICAgICBtb2NrUmVzaWxpZW5jZVN0cmF0ZWd5LmRldGVybWluZVJlY29ubmVjdGlvblN0cmF0ZWd5Lm1vY2tSZXR1cm5WYWx1ZSh7IHR5cGU6ICdleHBvbmVudGlhbC1iYWNrb2ZmJyB9KTtcbiAgICAgIG1vY2tSZXNpbGllbmNlU3RyYXRlZ3kuZXhlY3V0ZVJlY292ZXJ5UGxhbi5tb2NrUmVzb2x2ZWRWYWx1ZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgICBcbiAgICAgIC8vIEFjdCAtIFRlc3QgcmVzaWxpZW5jZSBkZXNpZ25cbiAgICAgIGNvbnN0IGNvbm5lY3Rpb25Jc3N1ZSA9IHsgdHlwZTogJ3RpbWVvdXQnLCBkdXJhdGlvbjogNTAwMCB9O1xuICAgICAgcmVzaWxpZW50Q2xpZW50LmhhbmRsZUNvbm5lY3Rpb25Jc3N1ZShjb25uZWN0aW9uSXNzdWUpO1xuICAgICAgXG4gICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgcmVzaWxpZW5jZSBpbnRlcmZhY2UgZXhpc3RzIGFuZCBiZWhhdmVzIGNvcnJlY3RseVxuICAgICAgZXhwZWN0KG1vY2tSZXNpbGllbmNlU3RyYXRlZ3kuZXZhbHVhdGVDb25uZWN0aW9uSGVhbHRoKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjb25uZWN0aW9uSXNzdWUpO1xuICAgICAgZXhwZWN0KG1vY2tSZXNpbGllbmNlU3RyYXRlZ3kuZGV0ZXJtaW5lUmVjb25uZWN0aW9uU3RyYXRlZ3kpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgc2V2ZXJpdHk6ICdtb2RlcmF0ZScgfSk7XG4gICAgICBleHBlY3QobW9ja1Jlc2lsaWVuY2VTdHJhdGVneS5leGVjdXRlUmVjb3ZlcnlQbGFuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHR5cGU6ICdleHBvbmVudGlhbC1iYWNrb2ZmJyB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gQ2xlYW4gdGVzdCBpc29sYXRpb24gLSBMb25kb24gU2Nob29sIHByaW5jaXBsZVxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgICAvLyBSZXNldCBXZWJTb2NrZXQgc3RhdGVcbiAgICBtb2NrV2ViU29ja2V0LnJlYWR5U3RhdGUgPSBtb2NrV2ViU29ja2V0LkNMT1NFRDtcbiAgfSk7XG4gIFxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9