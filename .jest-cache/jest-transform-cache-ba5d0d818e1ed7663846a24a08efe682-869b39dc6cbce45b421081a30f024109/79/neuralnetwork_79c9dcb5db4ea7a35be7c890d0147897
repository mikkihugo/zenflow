3b1ef039bc2d07600a94101c07587911
// neural-network.ts - TypeScript wrapper for WASM neural network functionality
let wasmModule = null;
export async function initializeNeuralWasm() {
    if (wasmModule)
        return wasmModule;
    try {
        // Dynamic import of WASM module
        const { default: init, ...exports } = await import('../wasm/ruv_swarm_wasm.js');
        await init();
        wasmModule = exports;
        return wasmModule;
    }
    catch (error) {
        throw new Error(`Failed to initialize WASM neural module: ${error}`);
    }
}
export class NeuralNetwork {
    wasm;
    network;
    constructor(wasm, config) {
        this.wasm = wasm;
        this.network = new wasm.WasmNeuralNetwork(config);
    }
    async run(inputs) {
        return this.network.run(new Float32Array(inputs));
    }
    getWeights() {
        return this.network.get_weights();
    }
    setWeights(weights) {
        this.network.set_weights(weights);
    }
    getInfo() {
        return this.network.get_network_info();
    }
    setTrainingData(data) {
        this.network.set_training_data(data);
    }
    // Getter method to access the internal network for training
    getInternalNetwork() {
        return this.network;
    }
}
export class NeuralTrainer {
    wasm;
    trainer;
    constructor(wasm, config) {
        this.wasm = wasm;
        this.trainer = new wasm.WasmTrainer(config);
    }
    async trainEpoch(network, data) {
        return this.trainer.train_epoch(network.getInternalNetwork(), data);
    }
    async trainUntilTarget(network, data, targetError, maxEpochs) {
        return this.trainer.train_until_target(network.getInternalNetwork(), data, targetError, maxEpochs);
    }
    getTrainingHistory() {
        return this.trainer.get_training_history();
    }
    getAlgorithmInfo() {
        return this.trainer.get_algorithm_info();
    }
}
export class AgentNeuralManager {
    wasm;
    manager;
    constructor(wasm) {
        this.wasm = wasm;
        this.manager = new wasm.AgentNeuralNetworkManager();
    }
    async createAgentNetwork(config) {
        return this.manager.create_agent_network(config);
    }
    async trainAgentNetwork(agentId, data) {
        return this.manager.train_agent_network(agentId, data);
    }
    async getAgentInference(agentId, inputs) {
        return this.manager.get_agent_inference(agentId, new Float32Array(inputs));
    }
    async getAgentCognitiveState(agentId) {
        return this.manager.get_agent_cognitive_state(agentId);
    }
    async fineTuneDuringExecution(agentId, experienceData) {
        return this.manager.fine_tune_during_execution(agentId, experienceData);
    }
}
export class ActivationFunctions {
    static async getAll(wasm) {
        return wasm.ActivationFunctionManager.get_all_functions();
    }
    static async test(wasm, name, input, steepness = 1.0) {
        return wasm.ActivationFunctionManager.test_activation_function(name, input, steepness);
    }
    static async compare(wasm, input) {
        return wasm.ActivationFunctionManager.compare_functions(input);
    }
    static async getProperties(wasm, name) {
        return wasm.ActivationFunctionManager.get_function_properties(name);
    }
}
export class CascadeTrainer {
    wasm;
    trainer;
    constructor(wasm, config, network, data) {
        this.wasm = wasm;
        this.trainer = new wasm.WasmCascadeTrainer(config || this.getDefaultConfig(), network.getInternalNetwork(), data);
    }
    async train() {
        return this.trainer.train();
    }
    getConfig() {
        return this.trainer.get_config();
    }
    static getDefaultConfig(wasm) {
        return wasm.WasmCascadeTrainer.create_default_config();
    }
    getDefaultConfig() {
        return CascadeTrainer.getDefaultConfig(this.wasm);
    }
}
// High-level helper functions
export async function createNeuralNetwork(config) {
    const wasm = await initializeNeuralWasm();
    return new NeuralNetwork(wasm, config);
}
export async function createTrainer(config) {
    const wasm = await initializeNeuralWasm();
    return new NeuralTrainer(wasm, config);
}
export async function createAgentNeuralManager() {
    const wasm = await initializeNeuralWasm();
    return new AgentNeuralManager(wasm);
}
// Export activation function names for convenience
export const ACTIVATION_FUNCTIONS = {
    LINEAR: 'linear',
    SIGMOID: 'sigmoid',
    SIGMOID_SYMMETRIC: 'sigmoid_symmetric',
    TANH: 'tanh',
    GAUSSIAN: 'gaussian',
    GAUSSIAN_SYMMETRIC: 'gaussian_symmetric',
    ELLIOT: 'elliot',
    ELLIOT_SYMMETRIC: 'elliot_symmetric',
    RELU: 'relu',
    RELU_LEAKY: 'relu_leaky',
    COS: 'cos',
    COS_SYMMETRIC: 'cos_symmetric',
    SIN: 'sin',
    SIN_SYMMETRIC: 'sin_symmetric',
    THRESHOLD: 'threshold',
    THRESHOLD_SYMMETRIC: 'threshold_symmetric',
    LINEAR_PIECE: 'linear_piece',
    LINEAR_PIECE_SYMMETRIC: 'linear_piece_symmetric',
};
// Export training algorithm names
export const TRAINING_ALGORITHMS = {
    INCREMENTAL_BACKPROP: 'incremental_backprop',
    BATCH_BACKPROP: 'batch_backprop',
    RPROP: 'rprop',
    QUICKPROP: 'quickprop',
    SARPROP: 'sarprop',
};
// Export cognitive patterns
export const COGNITIVE_PATTERNS = {
    CONVERGENT: 'convergent',
    DIVERGENT: 'divergent',
    LATERAL: 'lateral',
    SYSTEMS: 'systems',
    CRITICAL: 'critical',
    ABSTRACT: 'abstract',
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3J1di1GQU5OLXplbi9ydXYtc3dhcm0temVuL25wbS9zcmMvbmV1cmFsLW5ldHdvcmsudHMiLCJtYXBwaW5ncyI6IkFBQUEsK0VBQStFO0FBaUcvRSxJQUFJLFVBQVUsR0FBUSxJQUFJLENBQUM7QUFFM0IsTUFBTSxDQUFDLEtBQUssVUFBVSxvQkFBb0I7SUFDeEMsSUFBSSxVQUFVO1FBQUUsT0FBTyxVQUFVLENBQUM7SUFFbEMsSUFBSSxDQUFDO1FBQ0gsZ0NBQWdDO1FBQ2hDLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLEdBQUcsT0FBTyxFQUFFLEdBQUcsTUFBTSxNQUFNLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUNoRixNQUFNLElBQUksRUFBRSxDQUFDO1FBQ2IsVUFBVSxHQUFHLE9BQU8sQ0FBQztRQUNyQixPQUFPLFVBQVUsQ0FBQztJQUNwQixDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLE1BQU0sSUFBSSxLQUFLLENBQUMsNENBQTRDLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDdkUsQ0FBQztBQUNILENBQUM7QUFFRCxNQUFNLE9BQU8sYUFBYTtJQUdKO0lBRlosT0FBTyxDQUFNO0lBRXJCLFlBQW9CLElBQVMsRUFBRSxNQUFxQjtRQUFoQyxTQUFJLEdBQUosSUFBSSxDQUFLO1FBQzNCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxJQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVELEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBZ0I7UUFDeEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFFRCxVQUFVO1FBQ1IsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3BDLENBQUM7SUFFRCxVQUFVLENBQUMsT0FBcUI7UUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVELE9BQU87UUFDTCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUN6QyxDQUFDO0lBRUQsZUFBZSxDQUFDLElBQXdCO1FBQ3RDLElBQUksQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELDREQUE0RDtJQUM1RCxrQkFBa0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3RCLENBQUM7Q0FDRjtBQUVELE1BQU0sT0FBTyxhQUFhO0lBR0o7SUFGWixPQUFPLENBQU07SUFFckIsWUFBb0IsSUFBUyxFQUFFLE1BQXNCO1FBQWpDLFNBQUksR0FBSixJQUFJLENBQUs7UUFDM0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDOUMsQ0FBQztJQUVELEtBQUssQ0FBQyxVQUFVLENBQUMsT0FBc0IsRUFBRSxJQUF3QjtRQUMvRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RFLENBQUM7SUFFRCxLQUFLLENBQUMsZ0JBQWdCLENBQ3BCLE9BQXNCLEVBQ3RCLElBQXdCLEVBQ3hCLFdBQW1CLEVBQ25CLFNBQWlCO1FBRWpCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ3JHLENBQUM7SUFFRCxrQkFBa0I7UUFDaEIsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLENBQUM7SUFDN0MsQ0FBQztJQUVELGdCQUFnQjtRQUNkLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzNDLENBQUM7Q0FDRjtBQUVELE1BQU0sT0FBTyxrQkFBa0I7SUFHVDtJQUZaLE9BQU8sQ0FBTTtJQUVyQixZQUFvQixJQUFTO1FBQVQsU0FBSSxHQUFKLElBQUksQ0FBSztRQUMzQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLHlCQUF5QixFQUFFLENBQUM7SUFDdEQsQ0FBQztJQUVELEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxNQUEwQjtRQUNqRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUVELEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFlLEVBQUUsSUFBd0I7UUFDL0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsS0FBSyxDQUFDLGlCQUFpQixDQUFDLE9BQWUsRUFBRSxNQUFnQjtRQUN2RCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsT0FBTyxFQUFFLElBQUksWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDN0UsQ0FBQztJQUVELEtBQUssQ0FBQyxzQkFBc0IsQ0FBQyxPQUFlO1FBQzFDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsS0FBSyxDQUFDLHVCQUF1QixDQUFDLE9BQWUsRUFBRSxjQUFtQjtRQUNoRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsMEJBQTBCLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQyxDQUFDO0lBQzFFLENBQUM7Q0FDRjtBQUVELE1BQU0sT0FBTyxtQkFBbUI7SUFDOUIsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBUztRQUMzQixPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0lBQzVELENBQUM7SUFFRCxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFTLEVBQUUsSUFBWSxFQUFFLEtBQWEsRUFBRSxZQUFvQixHQUFHO1FBQy9FLE9BQU8sSUFBSSxDQUFDLHlCQUF5QixDQUFDLHdCQUF3QixDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDekYsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQVMsRUFBRSxLQUFhO1FBQzNDLE9BQU8sSUFBSSxDQUFDLHlCQUF5QixDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFTLEVBQUUsSUFBWTtRQUNoRCxPQUFPLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN0RSxDQUFDO0NBQ0Y7QUFFRCxNQUFNLE9BQU8sY0FBYztJQUdMO0lBRlosT0FBTyxDQUFNO0lBRXJCLFlBQW9CLElBQVMsRUFBRSxNQUE0QixFQUFFLE9BQXNCLEVBQUUsSUFBd0I7UUFBekYsU0FBSSxHQUFKLElBQUksQ0FBSztRQUMzQixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxPQUFPLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNwSCxDQUFDO0lBRUQsS0FBSyxDQUFDLEtBQUs7UUFDVCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDOUIsQ0FBQztJQUVELFNBQVM7UUFDUCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDbkMsQ0FBQztJQUVELE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFTO1FBQy9CLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDekQsQ0FBQztJQUVPLGdCQUFnQjtRQUN0QixPQUFPLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEQsQ0FBQztDQUNGO0FBRUQsOEJBQThCO0FBQzlCLE1BQU0sQ0FBQyxLQUFLLFVBQVUsbUJBQW1CLENBQUMsTUFBcUI7SUFDN0QsTUFBTSxJQUFJLEdBQUcsTUFBTSxvQkFBb0IsRUFBRSxDQUFDO0lBQzFDLE9BQU8sSUFBSSxhQUFhLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQ3pDLENBQUM7QUFFRCxNQUFNLENBQUMsS0FBSyxVQUFVLGFBQWEsQ0FBQyxNQUFzQjtJQUN4RCxNQUFNLElBQUksR0FBRyxNQUFNLG9CQUFvQixFQUFFLENBQUM7SUFDMUMsT0FBTyxJQUFJLGFBQWEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDekMsQ0FBQztBQUVELE1BQU0sQ0FBQyxLQUFLLFVBQVUsd0JBQXdCO0lBQzVDLE1BQU0sSUFBSSxHQUFHLE1BQU0sb0JBQW9CLEVBQUUsQ0FBQztJQUMxQyxPQUFPLElBQUksa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVELG1EQUFtRDtBQUNuRCxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBRztJQUNsQyxNQUFNLEVBQUUsUUFBUTtJQUNoQixPQUFPLEVBQUUsU0FBUztJQUNsQixpQkFBaUIsRUFBRSxtQkFBbUI7SUFDdEMsSUFBSSxFQUFFLE1BQU07SUFDWixRQUFRLEVBQUUsVUFBVTtJQUNwQixrQkFBa0IsRUFBRSxvQkFBb0I7SUFDeEMsTUFBTSxFQUFFLFFBQVE7SUFDaEIsZ0JBQWdCLEVBQUUsa0JBQWtCO0lBQ3BDLElBQUksRUFBRSxNQUFNO0lBQ1osVUFBVSxFQUFFLFlBQVk7SUFDeEIsR0FBRyxFQUFFLEtBQUs7SUFDVixhQUFhLEVBQUUsZUFBZTtJQUM5QixHQUFHLEVBQUUsS0FBSztJQUNWLGFBQWEsRUFBRSxlQUFlO0lBQzlCLFNBQVMsRUFBRSxXQUFXO0lBQ3RCLG1CQUFtQixFQUFFLHFCQUFxQjtJQUMxQyxZQUFZLEVBQUUsY0FBYztJQUM1QixzQkFBc0IsRUFBRSx3QkFBd0I7Q0FDeEMsQ0FBQztBQUVYLGtDQUFrQztBQUNsQyxNQUFNLENBQUMsTUFBTSxtQkFBbUIsR0FBRztJQUNqQyxvQkFBb0IsRUFBRSxzQkFBc0I7SUFDNUMsY0FBYyxFQUFFLGdCQUFnQjtJQUNoQyxLQUFLLEVBQUUsT0FBTztJQUNkLFNBQVMsRUFBRSxXQUFXO0lBQ3RCLE9BQU8sRUFBRSxTQUFTO0NBQ1YsQ0FBQztBQUVYLDRCQUE0QjtBQUM1QixNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRztJQUNoQyxVQUFVLEVBQUUsWUFBWTtJQUN4QixTQUFTLEVBQUUsV0FBVztJQUN0QixPQUFPLEVBQUUsU0FBUztJQUNsQixPQUFPLEVBQUUsU0FBUztJQUNsQixRQUFRLEVBQUUsVUFBVTtJQUNwQixRQUFRLEVBQUUsVUFBVTtDQUNaLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3J1di1GQU5OLXplbi9ydXYtc3dhcm0temVuL25wbS9zcmMvbmV1cmFsLW5ldHdvcmsudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbmV1cmFsLW5ldHdvcmsudHMgLSBUeXBlU2NyaXB0IHdyYXBwZXIgZm9yIFdBU00gbmV1cmFsIG5ldHdvcmsgZnVuY3Rpb25hbGl0eVxuXG5leHBvcnQgaW50ZXJmYWNlIE5ldHdvcmtDb25maWcge1xuICBpbnB1dFNpemU6IG51bWJlcjtcbiAgaGlkZGVuTGF5ZXJzOiBMYXllckNvbmZpZ1tdO1xuICBvdXRwdXRTaXplOiBudW1iZXI7XG4gIG91dHB1dEFjdGl2YXRpb246IHN0cmluZztcbiAgY29ubmVjdGlvblJhdGU/OiBudW1iZXI7XG4gIHJhbmRvbVNlZWQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGF5ZXJDb25maWcge1xuICBzaXplOiBudW1iZXI7XG4gIGFjdGl2YXRpb246IHN0cmluZztcbiAgc3RlZXBuZXNzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYWluaW5nRGF0YUNvbmZpZyB7XG4gIGlucHV0czogbnVtYmVyW11bXTtcbiAgb3V0cHV0czogbnVtYmVyW11bXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUcmFpbmluZ0NvbmZpZyB7XG4gIGFsZ29yaXRobTogJ2luY3JlbWVudGFsX2JhY2twcm9wJyB8ICdiYXRjaF9iYWNrcHJvcCcgfCAncnByb3AnIHwgJ3F1aWNrcHJvcCcgfCAnc2FycHJvcCc7XG4gIGxlYXJuaW5nUmF0ZT86IG51bWJlcjtcbiAgbW9tZW50dW0/OiBudW1iZXI7XG4gIG1heEVwb2NoczogbnVtYmVyO1xuICB0YXJnZXRFcnJvcjogbnVtYmVyO1xuICB2YWxpZGF0aW9uU3BsaXQ/OiBudW1iZXI7XG4gIGVhcmx5U3RvcHBpbmc/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFnZW50TmV0d29ya0NvbmZpZyB7XG4gIGFnZW50SWQ6IHN0cmluZztcbiAgYWdlbnRUeXBlOiBzdHJpbmc7XG4gIGNvZ25pdGl2ZVBhdHRlcm46ICdjb252ZXJnZW50JyB8ICdkaXZlcmdlbnQnIHwgJ2xhdGVyYWwnIHwgJ3N5c3RlbXMnIHwgJ2NyaXRpY2FsJyB8ICdhYnN0cmFjdCc7XG4gIGlucHV0U2l6ZTogbnVtYmVyO1xuICBvdXRwdXRTaXplOiBudW1iZXI7XG4gIHRhc2tTcGVjaWFsaXphdGlvbj86IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhc2NhZGVDb25maWcge1xuICBtYXhIaWRkZW5OZXVyb25zOiBudW1iZXI7XG4gIG51bUNhbmRpZGF0ZXM6IG51bWJlcjtcbiAgb3V0cHV0TWF4RXBvY2hzOiBudW1iZXI7XG4gIGNhbmRpZGF0ZU1heEVwb2NoczogbnVtYmVyO1xuICBvdXRwdXRMZWFybmluZ1JhdGU6IG51bWJlcjtcbiAgY2FuZGlkYXRlTGVhcm5pbmdSYXRlOiBudW1iZXI7XG4gIG91dHB1dFRhcmdldEVycm9yOiBudW1iZXI7XG4gIGNhbmRpZGF0ZVRhcmdldENvcnJlbGF0aW9uOiBudW1iZXI7XG4gIG1pbkNvcnJlbGF0aW9uSW1wcm92ZW1lbnQ6IG51bWJlcjtcbiAgY2FuZGlkYXRlV2VpZ2h0TWluOiBudW1iZXI7XG4gIGNhbmRpZGF0ZVdlaWdodE1heDogbnVtYmVyO1xuICBjYW5kaWRhdGVBY3RpdmF0aW9uczogc3RyaW5nW107XG4gIHZlcmJvc2U6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTmV0d29ya0luZm8ge1xuICBudW1MYXllcnM6IG51bWJlcjtcbiAgbnVtSW5wdXRzOiBudW1iZXI7XG4gIG51bU91dHB1dHM6IG51bWJlcjtcbiAgdG90YWxOZXVyb25zOiBudW1iZXI7XG4gIHRvdGFsQ29ubmVjdGlvbnM6IG51bWJlcjtcbiAgbWV0cmljczoge1xuICAgIHRyYWluaW5nRXJyb3I6IG51bWJlcjtcbiAgICB2YWxpZGF0aW9uRXJyb3I6IG51bWJlcjtcbiAgICBlcG9jaHNUcmFpbmVkOiBudW1iZXI7XG4gICAgdG90YWxDb25uZWN0aW9uczogbnVtYmVyO1xuICAgIG1lbW9yeVVzYWdlOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJhaW5pbmdSZXN1bHQge1xuICBjb252ZXJnZWQ6IGJvb2xlYW47XG4gIGZpbmFsRXJyb3I6IG51bWJlcjtcbiAgZXBvY2hzOiBudW1iZXI7XG4gIHRhcmdldEVycm9yOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29nbml0aXZlU3RhdGUge1xuICBhZ2VudElkOiBzdHJpbmc7XG4gIGNvZ25pdGl2ZVBhdHRlcm46IGFueTtcbiAgbmV1cmFsQXJjaGl0ZWN0dXJlOiB7XG4gICAgbGF5ZXJzOiBudW1iZXI7XG4gICAgbmV1cm9uczogbnVtYmVyO1xuICAgIGNvbm5lY3Rpb25zOiBudW1iZXI7XG4gIH07XG4gIHRyYWluaW5nUHJvZ3Jlc3M6IHtcbiAgICBlcG9jaHNUcmFpbmVkOiBudW1iZXI7XG4gICAgY3VycmVudExvc3M6IG51bWJlcjtcbiAgICBiZXN0TG9zczogbnVtYmVyO1xuICAgIGlzVHJhaW5pbmc6IGJvb2xlYW47XG4gIH07XG4gIHBlcmZvcm1hbmNlOiBhbnk7XG4gIGFkYXB0YXRpb25IaXN0b3J5TGVuZ3RoOiBudW1iZXI7XG59XG5cbmxldCB3YXNtTW9kdWxlOiBhbnkgPSBudWxsO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZU5ldXJhbFdhc20oKSB7XG4gIGlmICh3YXNtTW9kdWxlKSByZXR1cm4gd2FzbU1vZHVsZTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gRHluYW1pYyBpbXBvcnQgb2YgV0FTTSBtb2R1bGVcbiAgICBjb25zdCB7IGRlZmF1bHQ6IGluaXQsIC4uLmV4cG9ydHMgfSA9IGF3YWl0IGltcG9ydCgnLi4vd2FzbS9ydXZfc3dhcm1fd2FzbS5qcycpO1xuICAgIGF3YWl0IGluaXQoKTtcbiAgICB3YXNtTW9kdWxlID0gZXhwb3J0cztcbiAgICByZXR1cm4gd2FzbU1vZHVsZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBpbml0aWFsaXplIFdBU00gbmV1cmFsIG1vZHVsZTogJHtlcnJvcn1gKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTmV1cmFsTmV0d29yayB7XG4gIHByaXZhdGUgbmV0d29yazogYW55O1xuICBcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB3YXNtOiBhbnksIGNvbmZpZzogTmV0d29ya0NvbmZpZykge1xuICAgIHRoaXMubmV0d29yayA9IG5ldyB3YXNtLldhc21OZXVyYWxOZXR3b3JrKGNvbmZpZyk7XG4gIH1cbiAgXG4gIGFzeW5jIHJ1bihpbnB1dHM6IG51bWJlcltdKTogUHJvbWlzZTxudW1iZXJbXT4ge1xuICAgIHJldHVybiB0aGlzLm5ldHdvcmsucnVuKG5ldyBGbG9hdDMyQXJyYXkoaW5wdXRzKSk7XG4gIH1cbiAgXG4gIGdldFdlaWdodHMoKTogRmxvYXQzMkFycmF5IHtcbiAgICByZXR1cm4gdGhpcy5uZXR3b3JrLmdldF93ZWlnaHRzKCk7XG4gIH1cbiAgXG4gIHNldFdlaWdodHMod2VpZ2h0czogRmxvYXQzMkFycmF5KTogdm9pZCB7XG4gICAgdGhpcy5uZXR3b3JrLnNldF93ZWlnaHRzKHdlaWdodHMpO1xuICB9XG4gIFxuICBnZXRJbmZvKCk6IE5ldHdvcmtJbmZvIHtcbiAgICByZXR1cm4gdGhpcy5uZXR3b3JrLmdldF9uZXR3b3JrX2luZm8oKTtcbiAgfVxuICBcbiAgc2V0VHJhaW5pbmdEYXRhKGRhdGE6IFRyYWluaW5nRGF0YUNvbmZpZyk6IHZvaWQge1xuICAgIHRoaXMubmV0d29yay5zZXRfdHJhaW5pbmdfZGF0YShkYXRhKTtcbiAgfVxuICBcbiAgLy8gR2V0dGVyIG1ldGhvZCB0byBhY2Nlc3MgdGhlIGludGVybmFsIG5ldHdvcmsgZm9yIHRyYWluaW5nXG4gIGdldEludGVybmFsTmV0d29yaygpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLm5ldHdvcms7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE5ldXJhbFRyYWluZXIge1xuICBwcml2YXRlIHRyYWluZXI6IGFueTtcbiAgXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgd2FzbTogYW55LCBjb25maWc6IFRyYWluaW5nQ29uZmlnKSB7XG4gICAgdGhpcy50cmFpbmVyID0gbmV3IHdhc20uV2FzbVRyYWluZXIoY29uZmlnKTtcbiAgfVxuICBcbiAgYXN5bmMgdHJhaW5FcG9jaChuZXR3b3JrOiBOZXVyYWxOZXR3b3JrLCBkYXRhOiBUcmFpbmluZ0RhdGFDb25maWcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHJldHVybiB0aGlzLnRyYWluZXIudHJhaW5fZXBvY2gobmV0d29yay5nZXRJbnRlcm5hbE5ldHdvcmsoKSwgZGF0YSk7XG4gIH1cbiAgXG4gIGFzeW5jIHRyYWluVW50aWxUYXJnZXQoXG4gICAgbmV0d29yazogTmV1cmFsTmV0d29yayxcbiAgICBkYXRhOiBUcmFpbmluZ0RhdGFDb25maWcsXG4gICAgdGFyZ2V0RXJyb3I6IG51bWJlcixcbiAgICBtYXhFcG9jaHM6IG51bWJlcixcbiAgKTogUHJvbWlzZTxUcmFpbmluZ1Jlc3VsdD4ge1xuICAgIHJldHVybiB0aGlzLnRyYWluZXIudHJhaW5fdW50aWxfdGFyZ2V0KG5ldHdvcmsuZ2V0SW50ZXJuYWxOZXR3b3JrKCksIGRhdGEsIHRhcmdldEVycm9yLCBtYXhFcG9jaHMpO1xuICB9XG4gIFxuICBnZXRUcmFpbmluZ0hpc3RvcnkoKTogYW55W10ge1xuICAgIHJldHVybiB0aGlzLnRyYWluZXIuZ2V0X3RyYWluaW5nX2hpc3RvcnkoKTtcbiAgfVxuICBcbiAgZ2V0QWxnb3JpdGhtSW5mbygpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLnRyYWluZXIuZ2V0X2FsZ29yaXRobV9pbmZvKCk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFnZW50TmV1cmFsTWFuYWdlciB7XG4gIHByaXZhdGUgbWFuYWdlcjogYW55O1xuICBcbiAgY29uc3RydWN0b3IocHJpdmF0ZSB3YXNtOiBhbnkpIHtcbiAgICB0aGlzLm1hbmFnZXIgPSBuZXcgd2FzbS5BZ2VudE5ldXJhbE5ldHdvcmtNYW5hZ2VyKCk7XG4gIH1cbiAgXG4gIGFzeW5jIGNyZWF0ZUFnZW50TmV0d29yayhjb25maWc6IEFnZW50TmV0d29ya0NvbmZpZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMubWFuYWdlci5jcmVhdGVfYWdlbnRfbmV0d29yayhjb25maWcpO1xuICB9XG4gIFxuICBhc3luYyB0cmFpbkFnZW50TmV0d29yayhhZ2VudElkOiBzdHJpbmcsIGRhdGE6IFRyYWluaW5nRGF0YUNvbmZpZyk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMubWFuYWdlci50cmFpbl9hZ2VudF9uZXR3b3JrKGFnZW50SWQsIGRhdGEpO1xuICB9XG4gIFxuICBhc3luYyBnZXRBZ2VudEluZmVyZW5jZShhZ2VudElkOiBzdHJpbmcsIGlucHV0czogbnVtYmVyW10pOiBQcm9taXNlPG51bWJlcltdPiB7XG4gICAgcmV0dXJuIHRoaXMubWFuYWdlci5nZXRfYWdlbnRfaW5mZXJlbmNlKGFnZW50SWQsIG5ldyBGbG9hdDMyQXJyYXkoaW5wdXRzKSk7XG4gIH1cbiAgXG4gIGFzeW5jIGdldEFnZW50Q29nbml0aXZlU3RhdGUoYWdlbnRJZDogc3RyaW5nKTogUHJvbWlzZTxDb2duaXRpdmVTdGF0ZT4ge1xuICAgIHJldHVybiB0aGlzLm1hbmFnZXIuZ2V0X2FnZW50X2NvZ25pdGl2ZV9zdGF0ZShhZ2VudElkKTtcbiAgfVxuICBcbiAgYXN5bmMgZmluZVR1bmVEdXJpbmdFeGVjdXRpb24oYWdlbnRJZDogc3RyaW5nLCBleHBlcmllbmNlRGF0YTogYW55KTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5tYW5hZ2VyLmZpbmVfdHVuZV9kdXJpbmdfZXhlY3V0aW9uKGFnZW50SWQsIGV4cGVyaWVuY2VEYXRhKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWN0aXZhdGlvbkZ1bmN0aW9ucyB7XG4gIHN0YXRpYyBhc3luYyBnZXRBbGwod2FzbTogYW55KTogUHJvbWlzZTxbc3RyaW5nLCBzdHJpbmddW10+IHtcbiAgICByZXR1cm4gd2FzbS5BY3RpdmF0aW9uRnVuY3Rpb25NYW5hZ2VyLmdldF9hbGxfZnVuY3Rpb25zKCk7XG4gIH1cbiAgXG4gIHN0YXRpYyBhc3luYyB0ZXN0KHdhc206IGFueSwgbmFtZTogc3RyaW5nLCBpbnB1dDogbnVtYmVyLCBzdGVlcG5lc3M6IG51bWJlciA9IDEuMCk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgcmV0dXJuIHdhc20uQWN0aXZhdGlvbkZ1bmN0aW9uTWFuYWdlci50ZXN0X2FjdGl2YXRpb25fZnVuY3Rpb24obmFtZSwgaW5wdXQsIHN0ZWVwbmVzcyk7XG4gIH1cbiAgXG4gIHN0YXRpYyBhc3luYyBjb21wYXJlKHdhc206IGFueSwgaW5wdXQ6IG51bWJlcik6IFByb21pc2U8UmVjb3JkPHN0cmluZywgbnVtYmVyPj4ge1xuICAgIHJldHVybiB3YXNtLkFjdGl2YXRpb25GdW5jdGlvbk1hbmFnZXIuY29tcGFyZV9mdW5jdGlvbnMoaW5wdXQpO1xuICB9XG4gIFxuICBzdGF0aWMgYXN5bmMgZ2V0UHJvcGVydGllcyh3YXNtOiBhbnksIG5hbWU6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHdhc20uQWN0aXZhdGlvbkZ1bmN0aW9uTWFuYWdlci5nZXRfZnVuY3Rpb25fcHJvcGVydGllcyhuYW1lKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ2FzY2FkZVRyYWluZXIge1xuICBwcml2YXRlIHRyYWluZXI6IGFueTtcbiAgXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgd2FzbTogYW55LCBjb25maWc6IENhc2NhZGVDb25maWcgfCBudWxsLCBuZXR3b3JrOiBOZXVyYWxOZXR3b3JrLCBkYXRhOiBUcmFpbmluZ0RhdGFDb25maWcpIHtcbiAgICB0aGlzLnRyYWluZXIgPSBuZXcgd2FzbS5XYXNtQ2FzY2FkZVRyYWluZXIoY29uZmlnIHx8IHRoaXMuZ2V0RGVmYXVsdENvbmZpZygpLCBuZXR3b3JrLmdldEludGVybmFsTmV0d29yaygpLCBkYXRhKTtcbiAgfVxuICBcbiAgYXN5bmMgdHJhaW4oKTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy50cmFpbmVyLnRyYWluKCk7XG4gIH1cbiAgXG4gIGdldENvbmZpZygpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLnRyYWluZXIuZ2V0X2NvbmZpZygpO1xuICB9XG4gIFxuICBzdGF0aWMgZ2V0RGVmYXVsdENvbmZpZyh3YXNtOiBhbnkpOiBDYXNjYWRlQ29uZmlnIHtcbiAgICByZXR1cm4gd2FzbS5XYXNtQ2FzY2FkZVRyYWluZXIuY3JlYXRlX2RlZmF1bHRfY29uZmlnKCk7XG4gIH1cbiAgXG4gIHByaXZhdGUgZ2V0RGVmYXVsdENvbmZpZygpOiBDYXNjYWRlQ29uZmlnIHtcbiAgICByZXR1cm4gQ2FzY2FkZVRyYWluZXIuZ2V0RGVmYXVsdENvbmZpZyh0aGlzLndhc20pO1xuICB9XG59XG5cbi8vIEhpZ2gtbGV2ZWwgaGVscGVyIGZ1bmN0aW9uc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU5ldXJhbE5ldHdvcmsoY29uZmlnOiBOZXR3b3JrQ29uZmlnKTogUHJvbWlzZTxOZXVyYWxOZXR3b3JrPiB7XG4gIGNvbnN0IHdhc20gPSBhd2FpdCBpbml0aWFsaXplTmV1cmFsV2FzbSgpO1xuICByZXR1cm4gbmV3IE5ldXJhbE5ldHdvcmsod2FzbSwgY29uZmlnKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRyYWluZXIoY29uZmlnOiBUcmFpbmluZ0NvbmZpZyk6IFByb21pc2U8TmV1cmFsVHJhaW5lcj4ge1xuICBjb25zdCB3YXNtID0gYXdhaXQgaW5pdGlhbGl6ZU5ldXJhbFdhc20oKTtcbiAgcmV0dXJuIG5ldyBOZXVyYWxUcmFpbmVyKHdhc20sIGNvbmZpZyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVBZ2VudE5ldXJhbE1hbmFnZXIoKTogUHJvbWlzZTxBZ2VudE5ldXJhbE1hbmFnZXI+IHtcbiAgY29uc3Qgd2FzbSA9IGF3YWl0IGluaXRpYWxpemVOZXVyYWxXYXNtKCk7XG4gIHJldHVybiBuZXcgQWdlbnROZXVyYWxNYW5hZ2VyKHdhc20pO1xufVxuXG4vLyBFeHBvcnQgYWN0aXZhdGlvbiBmdW5jdGlvbiBuYW1lcyBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCBjb25zdCBBQ1RJVkFUSU9OX0ZVTkNUSU9OUyA9IHtcbiAgTElORUFSOiAnbGluZWFyJyxcbiAgU0lHTU9JRDogJ3NpZ21vaWQnLFxuICBTSUdNT0lEX1NZTU1FVFJJQzogJ3NpZ21vaWRfc3ltbWV0cmljJyxcbiAgVEFOSDogJ3RhbmgnLFxuICBHQVVTU0lBTjogJ2dhdXNzaWFuJyxcbiAgR0FVU1NJQU5fU1lNTUVUUklDOiAnZ2F1c3NpYW5fc3ltbWV0cmljJyxcbiAgRUxMSU9UOiAnZWxsaW90JyxcbiAgRUxMSU9UX1NZTU1FVFJJQzogJ2VsbGlvdF9zeW1tZXRyaWMnLFxuICBSRUxVOiAncmVsdScsXG4gIFJFTFVfTEVBS1k6ICdyZWx1X2xlYWt5JyxcbiAgQ09TOiAnY29zJyxcbiAgQ09TX1NZTU1FVFJJQzogJ2Nvc19zeW1tZXRyaWMnLFxuICBTSU46ICdzaW4nLFxuICBTSU5fU1lNTUVUUklDOiAnc2luX3N5bW1ldHJpYycsXG4gIFRIUkVTSE9MRDogJ3RocmVzaG9sZCcsXG4gIFRIUkVTSE9MRF9TWU1NRVRSSUM6ICd0aHJlc2hvbGRfc3ltbWV0cmljJyxcbiAgTElORUFSX1BJRUNFOiAnbGluZWFyX3BpZWNlJyxcbiAgTElORUFSX1BJRUNFX1NZTU1FVFJJQzogJ2xpbmVhcl9waWVjZV9zeW1tZXRyaWMnLFxufSBhcyBjb25zdDtcblxuLy8gRXhwb3J0IHRyYWluaW5nIGFsZ29yaXRobSBuYW1lc1xuZXhwb3J0IGNvbnN0IFRSQUlOSU5HX0FMR09SSVRITVMgPSB7XG4gIElOQ1JFTUVOVEFMX0JBQ0tQUk9QOiAnaW5jcmVtZW50YWxfYmFja3Byb3AnLFxuICBCQVRDSF9CQUNLUFJPUDogJ2JhdGNoX2JhY2twcm9wJyxcbiAgUlBST1A6ICdycHJvcCcsXG4gIFFVSUNLUFJPUDogJ3F1aWNrcHJvcCcsXG4gIFNBUlBST1A6ICdzYXJwcm9wJyxcbn0gYXMgY29uc3Q7XG5cbi8vIEV4cG9ydCBjb2duaXRpdmUgcGF0dGVybnNcbmV4cG9ydCBjb25zdCBDT0dOSVRJVkVfUEFUVEVSTlMgPSB7XG4gIENPTlZFUkdFTlQ6ICdjb252ZXJnZW50JyxcbiAgRElWRVJHRU5UOiAnZGl2ZXJnZW50JyxcbiAgTEFURVJBTDogJ2xhdGVyYWwnLFxuICBTWVNURU1TOiAnc3lzdGVtcycsXG4gIENSSVRJQ0FMOiAnY3JpdGljYWwnLFxuICBBQlNUUkFDVDogJ2Fic3RyYWN0Jyxcbn0gYXMgY29uc3Q7Il0sInZlcnNpb24iOjN9