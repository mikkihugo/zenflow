8435002e32f49b5ffb67a35d902f03e9
/**
 * MCP Request/Response Handling - TDD London Style
 *
 * Tests request/response handling mechanisms using London School principles:
 * - Mock message routing and processing components
 * - Test request lifecycle and response generation
 * - Verify error handling and timeout scenarios
 * - Focus on interaction patterns and communication flow
 */
import { jest, describe, it, expect, beforeEach, afterEach } from '@jest/globals';
// === MOCK DEPENDENCIES (London School Contract Definition) ===
const mockRequestRouter = {
    route: jest.fn(),
    addHandler: jest.fn(),
    removeHandler: jest.fn(),
    getHandler: jest.fn()
};
const mockResponseBuilder = {
    buildSuccessResponse: jest.fn(),
    buildErrorResponse: jest.fn(),
    buildNotificationResponse: jest.fn()
};
const mockRequestValidator = {
    validate: jest.fn(),
    validateParams: jest.fn(),
    validateMethod: jest.fn()
};
const mockToolExecutor = {
    execute: jest.fn(),
    getExecutionContext: jest.fn(),
    setExecutionTimeout: jest.fn()
};
const mockLogger = {
    debug: jest.fn(),
    info: jest.fn(),
    warn: jest.fn(),
    error: jest.fn()
};
const mockMetricsCollector = {
    recordRequest: jest.fn(),
    recordResponse: jest.fn(),
    recordLatency: jest.fn(),
    recordError: jest.fn()
};
const mockSessionManager = {
    getSession: jest.fn(),
    createSession: jest.fn(),
    updateActivity: jest.fn(),
    isSessionActive: jest.fn()
};
// === MOCK IMPLEMENTATION ===
class MockMCPRequestHandler {
    router;
    responseBuilder;
    validator;
    toolExecutor;
    logger;
    metricsCollector;
    sessionManager;
    requestTimeout = 30000; // 30 seconds
    metrics = {
        totalRequests: 0,
        successfulRequests: 0,
        failedRequests: 0,
        averageResponseTime: 0,
        timeouts: 0
    };
    constructor(router = mockRequestRouter, responseBuilder = mockResponseBuilder, validator = mockRequestValidator, toolExecutor = mockToolExecutor, logger = mockLogger, metricsCollector = mockMetricsCollector, sessionManager = mockSessionManager) {
        this.router = router;
        this.responseBuilder = responseBuilder;
        this.validator = validator;
        this.toolExecutor = toolExecutor;
        this.logger = logger;
        this.metricsCollector = metricsCollector;
        this.sessionManager = sessionManager;
    }
    async handleRequest(request, context) {
        const startTime = Date.now();
        this.logger.info('Handling MCP request', {
            id: request.id,
            method: request.method,
            sessionId: context.sessionId
        });
        this.metricsCollector.recordRequest(request.method);
        this.sessionManager.updateActivity(context.sessionId);
        try {
            // Validate request
            const validation = this.validator.validate(request);
            if (!validation.valid) {
                const errorResponse = this.createErrorResponse(request.id, {
                    code: -32602,
                    message: 'Invalid params',
                    data: validation.errors
                });
                this.recordRequestCompletion(startTime, false);
                return errorResponse;
            }
            // Route and execute request
            const response = await this.routeRequest(request, context);
            this.recordRequestCompletion(startTime, true);
            this.logger.info('Request completed successfully', {
                id: request.id,
                duration: Date.now() - startTime
            });
            return response;
        }
        catch (error) {
            this.logger.error('Request handling failed', {
                id: request.id,
                error: error.message
            });
            const errorResponse = this.createErrorResponse(request.id, {
                code: -32603,
                message: 'Internal error',
                data: { error: error.message }
            });
            this.recordRequestCompletion(startTime, false);
            return errorResponse;
        }
    }
    async handleNotification(notification, context) {
        this.logger.debug('Handling MCP notification', {
            method: notification.method,
            sessionId: context.sessionId
        });
        this.sessionManager.updateActivity(context.sessionId);
        try {
            await this.routeNotification(notification, context);
            this.logger.debug('Notification handled successfully', { method: notification.method });
        }
        catch (error) {
            this.logger.error('Notification handling failed', {
                method: notification.method,
                error: error.message
            });
        }
    }
    async routeRequest(request, context) {
        const handler = this.router.getHandler(request.method);
        if (!handler) {
            throw new Error(`No handler found for method: ${request.method}`);
        }
        const result = await Promise.race([
            handler(request.params, context),
            this.createTimeoutPromise()
        ]);
        if (result === 'TIMEOUT') {
            this.metrics.timeouts++;
            throw new Error('Request timeout');
        }
        return this.createSuccessResponse(request.id, result);
    }
    async routeNotification(notification, context) {
        const handler = this.router.getHandler(notification.method);
        if (handler) {
            await handler(notification.params, context);
        }
        else {
            this.logger.warn('No handler for notification', { method: notification.method });
        }
    }
    createSuccessResponse(id, result) {
        return this.responseBuilder.buildSuccessResponse(id, result);
    }
    createErrorResponse(id, error) {
        return this.responseBuilder.buildErrorResponse(id, error);
    }
    createNotificationAck(method) {
        this.logger.debug('Notification acknowledged', { method });
    }
    addRoute(method, handler) {
        this.router.addHandler(method, handler);
        this.logger.debug('Route added', { method });
    }
    setRequestTimeout(timeout) {
        this.requestTimeout = timeout;
    }
    getRequestMetrics() {
        return { ...this.metrics };
    }
    createTimeoutPromise() {
        return new Promise(resolve => {
            setTimeout(() => resolve('TIMEOUT'), this.requestTimeout);
        });
    }
    recordRequestCompletion(startTime, success) {
        const duration = Date.now() - startTime;
        this.metrics.totalRequests++;
        if (success) {
            this.metrics.successfulRequests++;
        }
        else {
            this.metrics.failedRequests++;
        }
        // Update rolling average
        const totalCompleted = this.metrics.successfulRequests + this.metrics.failedRequests;
        this.metrics.averageResponseTime =
            (this.metrics.averageResponseTime * (totalCompleted - 1) + duration) / totalCompleted;
        this.metricsCollector.recordLatency(duration);
        if (!success) {
            this.metricsCollector.recordError('request_failed');
        }
    }
}
describe('MCP Request/Response Handling - London TDD', () => {
    describe('🎯 Acceptance Tests - Request Processing', () => {
        describe('User Story: Handle Standard MCP Requests', () => {
            it('should process tools/list request successfully', async () => {
                // Arrange - Mock tools/list handling
                mockRequestValidator.validate.mockReturnValue({ valid: true, errors: [] });
                mockRequestRouter.getHandler.mockReturnValue(async () => {
                    return {
                        tools: [
                            {
                                name: 'test_tool',
                                description: 'Test tool',
                                inputSchema: { type: 'object' }
                            }
                        ]
                    };
                });
                mockResponseBuilder.buildSuccessResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'tools-1',
                    result: {
                        tools: [{
                                name: 'test_tool',
                                description: 'Test tool',
                                inputSchema: { type: 'object' }
                            }]
                    }
                });
                mockSessionManager.updateActivity.mockReturnValue(undefined);
                const handler = new MockMCPRequestHandler();
                const toolsListRequest = {
                    jsonrpc: '2.0',
                    id: 'tools-1',
                    method: 'tools/list',
                    params: {}
                };
                const context = {
                    sessionId: 'session-123',
                    logger: mockLogger
                };
                // Act - Handle tools/list request
                const response = await handler.handleRequest(toolsListRequest, context);
                // Assert - Verify request processing conversation
                expect(mockLogger.info).toHaveBeenCalledWith('Handling MCP request', {
                    id: 'tools-1',
                    method: 'tools/list',
                    sessionId: 'session-123'
                });
                expect(mockRequestValidator.validate).toHaveBeenCalledWith(toolsListRequest);
                expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('tools/list');
                expect(mockSessionManager.updateActivity).toHaveBeenCalledWith('session-123');
                expect(mockMetricsCollector.recordRequest).toHaveBeenCalledWith('tools/list');
                expect(mockResponseBuilder.buildSuccessResponse).toHaveBeenCalledWith('tools-1', expect.objectContaining({ tools: expect.any(Array) }));
                expect(response.jsonrpc).toBe('2.0');
                expect(response.id).toBe('tools-1');
                expect(response.result).toBeDefined();
            });
            it('should process tools/call request with proper execution context', async () => {
                // Arrange - Mock tools/call handling
                mockRequestValidator.validate.mockReturnValue({ valid: true, errors: [] });
                mockRequestRouter.getHandler.mockReturnValue(async (params, context) => {
                    // Simulate tool execution
                    const toolResult = await mockToolExecutor.execute(params.name, params.arguments);
                    return toolResult;
                });
                mockToolExecutor.execute.mockResolvedValue({
                    content: [
                        {
                            type: 'text',
                            text: 'Analysis complete: Found 5 issues in codebase'
                        }
                    ]
                });
                mockResponseBuilder.buildSuccessResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'tool-call-1',
                    result: {
                        content: [{
                                type: 'text',
                                text: 'Analysis complete: Found 5 issues in codebase'
                            }]
                    }
                });
                const handler = new MockMCPRequestHandler();
                const toolCallRequest = {
                    jsonrpc: '2.0',
                    id: 'tool-call-1',
                    method: 'tools/call',
                    params: {
                        name: 'analyze_code',
                        arguments: {
                            codebase: '/path/to/project',
                            language: 'typescript'
                        }
                    }
                };
                const context = {
                    sessionId: 'session-456',
                    agentId: 'agent-789',
                    logger: mockLogger
                };
                // Act - Handle tool call
                const response = await handler.handleRequest(toolCallRequest, context);
                // Assert - Verify tool execution conversation
                expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('tools/call');
                expect(mockToolExecutor.execute).toHaveBeenCalledWith('analyze_code', {
                    codebase: '/path/to/project',
                    language: 'typescript'
                });
                expect(response.result).toBeDefined();
                expect(response.result.content[0].text).toContain('Analysis complete');
            });
        });
        describe('User Story: Handle Request Validation Errors', () => {
            it('should return validation error for invalid request', async () => {
                // Arrange - Mock validation failure
                mockRequestValidator.validate.mockReturnValue({
                    valid: false,
                    errors: ['Method is required', 'Invalid JSON-RPC format']
                });
                mockResponseBuilder.buildErrorResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'invalid-1',
                    error: {
                        code: -32602,
                        message: 'Invalid params',
                        data: ['Method is required', 'Invalid JSON-RPC format']
                    }
                });
                const handler = new MockMCPRequestHandler();
                const invalidRequest = {
                    jsonrpc: '2.0',
                    id: 'invalid-1',
                    method: '', // Invalid: empty method
                    params: 'invalid-params' // Invalid: should be object
                };
                const context = {
                    sessionId: 'session-error',
                    logger: mockLogger
                };
                // Act - Handle invalid request
                const response = await handler.handleRequest(invalidRequest, context);
                // Assert - Verify validation error handling
                expect(mockRequestValidator.validate).toHaveBeenCalledWith(invalidRequest);
                expect(mockResponseBuilder.buildErrorResponse).toHaveBeenCalledWith('invalid-1', {
                    code: -32602,
                    message: 'Invalid params',
                    data: ['Method is required', 'Invalid JSON-RPC format']
                });
                expect(response.error).toBeDefined();
                expect(response.error.code).toBe(-32602);
            });
            it('should handle method not found errors', async () => {
                // Arrange - Mock method not found
                mockRequestValidator.validate.mockReturnValue({ valid: true, errors: [] });
                mockRequestRouter.getHandler.mockReturnValue(null); // No handler found
                mockResponseBuilder.buildErrorResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'not-found-1',
                    error: {
                        code: -32603,
                        message: 'Internal error',
                        data: { error: 'No handler found for method: unknown/method' }
                    }
                });
                const handler = new MockMCPRequestHandler();
                const unknownMethodRequest = {
                    jsonrpc: '2.0',
                    id: 'not-found-1',
                    method: 'unknown/method',
                    params: {}
                };
                const context = {
                    sessionId: 'session-unknown',
                    logger: mockLogger
                };
                // Act - Handle unknown method request
                const response = await handler.handleRequest(unknownMethodRequest, context);
                // Assert - Verify method not found handling
                expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('unknown/method');
                expect(mockLogger.error).toHaveBeenCalledWith('Request handling failed', expect.objectContaining({
                    id: 'not-found-1',
                    error: expect.stringContaining('No handler found')
                }));
                expect(response.error).toBeDefined();
                expect(response.error.code).toBe(-32603);
            });
        });
    });
    describe('🔔 Acceptance Tests - Notification Handling', () => {
        describe('User Story: Process MCP Notifications', () => {
            it('should handle notifications without response', async () => {
                // Arrange - Mock notification handling
                mockRequestRouter.getHandler.mockReturnValue(async (params, context) => {
                    // Simulate notification processing
                    mockLogger.info('Processing notification', { params, sessionId: context.sessionId });
                    return undefined; // Notifications don't return responses
                });
                const handler = new MockMCPRequestHandler();
                const logNotification = {
                    jsonrpc: '2.0',
                    method: 'notifications/message',
                    params: {
                        level: 'info',
                        message: 'Task completed successfully',
                        logger: 'agent-executor'
                    }
                };
                const context = {
                    sessionId: 'session-notification',
                    logger: mockLogger
                };
                // Act - Handle notification
                await handler.handleNotification(logNotification, context);
                // Assert - Verify notification processing conversation
                expect(mockLogger.debug).toHaveBeenCalledWith('Handling MCP notification', {
                    method: 'notifications/message',
                    sessionId: 'session-notification'
                });
                expect(mockSessionManager.updateActivity).toHaveBeenCalledWith('session-notification');
                expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('notifications/message');
                expect(mockLogger.debug).toHaveBeenCalledWith('Notification handled successfully', { method: 'notifications/message' });
            });
            it('should handle notifications for unknown methods gracefully', async () => {
                // Arrange - Mock unknown notification method
                mockRequestRouter.getHandler.mockReturnValue(null); // No handler
                const handler = new MockMCPRequestHandler();
                const unknownNotification = {
                    jsonrpc: '2.0',
                    method: 'unknown/notification',
                    params: { data: 'test' }
                };
                const context = {
                    sessionId: 'session-unknown-notification',
                    logger: mockLogger
                };
                // Act - Handle unknown notification
                await handler.handleNotification(unknownNotification, context);
                // Assert - Verify graceful handling of unknown notifications
                expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('unknown/notification');
                expect(mockLogger.warn).toHaveBeenCalledWith('No handler for notification', { method: 'unknown/notification' });
                // Should not throw error for unknown notifications
            });
        });
    });
    describe('⏱️ Acceptance Tests - Timeout Handling', () => {
        describe('User Story: Handle Request Timeouts', () => {
            it('should timeout long-running requests', async () => {
                // Arrange - Mock long-running request that times out
                mockRequestValidator.validate.mockReturnValue({ valid: true, errors: [] });
                mockRequestRouter.getHandler.mockReturnValue(async () => {
                    // Simulate long-running operation that exceeds timeout
                    await new Promise(resolve => setTimeout(resolve, 100)); // Short delay for test
                    return { result: 'completed' };
                });
                mockResponseBuilder.buildErrorResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'timeout-1',
                    error: {
                        code: -32603,
                        message: 'Internal error',
                        data: { error: 'Request timeout' }
                    }
                });
                const handler = new MockMCPRequestHandler();
                handler.setRequestTimeout(50); // Very short timeout for test
                const longRunningRequest = {
                    jsonrpc: '2.0',
                    id: 'timeout-1',
                    method: 'long/operation',
                    params: { duration: 1000 }
                };
                const context = {
                    sessionId: 'session-timeout',
                    logger: mockLogger
                };
                // Act - Handle request that should timeout
                const response = await handler.handleRequest(longRunningRequest, context);
                // Assert - Verify timeout handling
                expect(mockLogger.error).toHaveBeenCalledWith('Request handling failed', expect.objectContaining({
                    id: 'timeout-1',
                    error: 'Request timeout'
                }));
                expect(response.error).toBeDefined();
                expect(response.error.data.error).toBe('Request timeout');
                const metrics = handler.getRequestMetrics();
                expect(metrics.timeouts).toBe(1);
            });
        });
    });
    describe('🔗 Contract Verification - Response Building', () => {
        describe('Response Construction', () => {
            it('should build proper success responses', async () => {
                // Arrange - Mock response building
                const expectedResult = { status: 'success', data: { count: 42 } };
                mockResponseBuilder.buildSuccessResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'success-1',
                    result: expectedResult
                });
                const handler = new MockMCPRequestHandler();
                // Act - Build success response
                const response = handler.createSuccessResponse('success-1', expectedResult);
                // Assert - Verify success response construction
                expect(mockResponseBuilder.buildSuccessResponse).toHaveBeenCalledWith('success-1', expectedResult);
                expect(response.jsonrpc).toBe('2.0');
                expect(response.id).toBe('success-1');
                expect(response.result).toEqual(expectedResult);
            });
            it('should build proper error responses', async () => {
                // Arrange - Mock error response building
                const errorDetails = {
                    code: -32000,
                    message: 'Server error',
                    data: { context: 'database connection failed' }
                };
                mockResponseBuilder.buildErrorResponse.mockReturnValue({
                    jsonrpc: '2.0',
                    id: 'error-1',
                    error: errorDetails
                });
                const handler = new MockMCPRequestHandler();
                // Act - Build error response
                const response = handler.createErrorResponse('error-1', errorDetails);
                // Assert - Verify error response construction
                expect(mockResponseBuilder.buildErrorResponse).toHaveBeenCalledWith('error-1', errorDetails);
                expect(response.jsonrpc).toBe('2.0');
                expect(response.id).toBe('error-1');
                expect(response.error).toEqual(errorDetails);
            });
        });
    });
    describe('🧪 London School Patterns - Request Lifecycle', () => {
        it('should demonstrate complete request/response lifecycle', async () => {
            // Arrange - Mock complete request lifecycle
            mockRequestValidator.validate.mockReturnValue({ valid: true, errors: [] });
            mockRequestRouter.getHandler.mockReturnValue(async (params, context) => {
                return { processed: true, sessionId: context.sessionId };
            });
            mockResponseBuilder.buildSuccessResponse.mockReturnValue({
                jsonrpc: '2.0',
                id: 'lifecycle-1',
                result: { processed: true, sessionId: 'session-lifecycle' }
            });
            mockSessionManager.updateActivity.mockReturnValue(undefined);
            const handler = new MockMCPRequestHandler();
            const lifecycleRequest = {
                jsonrpc: '2.0',
                id: 'lifecycle-1',
                method: 'test/lifecycle',
                params: { test: true }
            };
            const context = {
                sessionId: 'session-lifecycle',
                logger: mockLogger
            };
            // Act - Process complete request lifecycle
            const response = await handler.handleRequest(lifecycleRequest, context);
            // Assert - Verify complete lifecycle conversation (London School focus)
            expect(mockLogger.info).toHaveBeenCalledWith('Handling MCP request', expect.objectContaining({ id: 'lifecycle-1', method: 'test/lifecycle' }));
            expect(mockMetricsCollector.recordRequest).toHaveBeenCalledWith('test/lifecycle');
            expect(mockSessionManager.updateActivity).toHaveBeenCalledWith('session-lifecycle');
            expect(mockRequestValidator.validate).toHaveBeenCalledWith(lifecycleRequest);
            expect(mockRequestRouter.getHandler).toHaveBeenCalledWith('test/lifecycle');
            expect(mockResponseBuilder.buildSuccessResponse).toHaveBeenCalledWith('lifecycle-1', expect.objectContaining({ processed: true }));
            expect(mockMetricsCollector.recordLatency).toHaveBeenCalledWith(expect.any(Number));
            expect(mockLogger.info).toHaveBeenCalledWith('Request completed successfully', expect.objectContaining({ id: 'lifecycle-1' }));
            expect(response.result.processed).toBe(true);
            const metrics = handler.getRequestMetrics();
            expect(metrics.totalRequests).toBe(1);
            expect(metrics.successfulRequests).toBe(1);
        });
    });
    // Clean test isolation - London School principle
    beforeEach(() => {
        jest.clearAllMocks();
    });
    afterEach(() => {
        jest.restoreAllMocks();
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvbWh1Z28vY29kZS9jbGF1ZGUtY29kZS1mbG93L3NyYy9fX3Rlc3RzX18vdW5pdC9sb25kb24vbWNwLXByb3RvY29sL3JlcXVlc3QtcmVzcG9uc2UtaGFuZGxpbmcudGVzdC50cyIsIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7R0FRRztBQUVILE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQVdsRixnRUFBZ0U7QUFFaEUsTUFBTSxpQkFBaUIsR0FBRztJQUN4QixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNoQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNyQixhQUFhLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN4QixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUN0QixDQUFDO0FBRUYsTUFBTSxtQkFBbUIsR0FBRztJQUMxQixvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQy9CLGtCQUFrQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDN0IseUJBQXlCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNyQyxDQUFDO0FBRUYsTUFBTSxvQkFBb0IsR0FBRztJQUMzQixRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNuQixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN6QixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUMxQixDQUFDO0FBRUYsTUFBTSxnQkFBZ0IsR0FBRztJQUN2QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNsQixtQkFBbUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzlCLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7Q0FDL0IsQ0FBQztBQUVGLE1BQU0sVUFBVSxHQUFHO0lBQ2pCLEtBQUssRUFBRSxJQUFJ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LEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ3BGLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQzFDLGdDQUFnQyxFQUNoQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxFQUFFLEVBQUUsYUFBYSxFQUFFLENBQUMsQ0FDL0MsQ0FBQztZQUVGLE1BQU0sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUU3QyxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUM1QyxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN0QyxNQUFNLENBQUMsT0FBTyxDQUFDLGtCQUFrQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxpREFBaUQ7SUFDakQsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7SUFDekIsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9taHVnby9jb2RlL2NsYXVkZS1jb2RlLWZsb3cvc3JjL19fdGVzdHNfXy91bml0L2xvbmRvbi9tY3AtcHJvdG9jb2wvcmVxdWVzdC1yZXNwb25zZS1oYW5kbGluZy50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTUNQIFJlcXVlc3QvUmVzcG9uc2UgSGFuZGxpbmcgLSBUREQgTG9uZG9uIFN0eWxlXG4gKiBcbiAqIFRlc3RzIHJlcXVlc3QvcmVzcG9uc2UgaGFuZGxpbmcgbWVjaGFuaXNtcyB1c2luZyBMb25kb24gU2Nob29sIHByaW5jaXBsZXM6XG4gKiAtIE1vY2sgbWVzc2FnZSByb3V0aW5nIGFuZCBwcm9jZXNzaW5nIGNvbXBvbmVudHNcbiAqIC0gVGVzdCByZXF1ZXN0IGxpZmVjeWNsZSBhbmQgcmVzcG9uc2UgZ2VuZXJhdGlvblxuICogLSBWZXJpZnkgZXJyb3IgaGFuZGxpbmcgYW5kIHRpbWVvdXQgc2NlbmFyaW9zXG4gKiAtIEZvY3VzIG9uIGludGVyYWN0aW9uIHBhdHRlcm5zIGFuZCBjb21tdW5pY2F0aW9uIGZsb3dcbiAqL1xuXG5pbXBvcnQgeyBqZXN0LCBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoIH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgdHlwZSB7XG4gIE1DUFJlcXVlc3QsXG4gIE1DUFJlc3BvbnNlLFxuICBNQ1BOb3RpZmljYXRpb24sXG4gIE1DUEVycm9yLFxuICBNQ1BUb29sQ2FsbCxcbiAgTUNQVG9vbFJlc3VsdCxcbiAgTUNQQ29udGV4dFxufSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy90eXBlcyc7XG5cbi8vID09PSBNT0NLIERFUEVOREVOQ0lFUyAoTG9uZG9uIFNjaG9vbCBDb250cmFjdCBEZWZpbml0aW9uKSA9PT1cblxuY29uc3QgbW9ja1JlcXVlc3RSb3V0ZXIgPSB7XG4gIHJvdXRlOiBqZXN0LmZuKCksXG4gIGFkZEhhbmRsZXI6IGplc3QuZm4oKSxcbiAgcmVtb3ZlSGFuZGxlcjogamVzdC5mbigpLFxuICBnZXRIYW5kbGVyOiBqZXN0LmZuKClcbn07XG5cbmNvbnN0IG1vY2tSZXNwb25zZUJ1aWxkZXIgPSB7XG4gIGJ1aWxkU3VjY2Vzc1Jlc3BvbnNlOiBqZXN0LmZuKCksXG4gIGJ1aWxkRXJyb3JSZXNwb25zZTogamVzdC5mbigpLFxuICBidWlsZE5vdGlmaWNhdGlvblJlc3BvbnNlOiBqZXN0LmZuKClcbn07XG5cbmNvbnN0IG1vY2tSZXF1ZXN0VmFsaWRhdG9yID0ge1xuICB2YWxpZGF0ZTogamVzdC5mbigpLFxuICB2YWxpZGF0ZVBhcmFtczogamVzdC5mbigpLFxuICB2YWxpZGF0ZU1ldGhvZDogamVzdC5mbigpXG59O1xuXG5jb25zdCBtb2NrVG9vbEV4ZWN1dG9yID0ge1xuICBleGVjdXRlOiBqZXN0LmZuKCksXG4gIGdldEV4ZWN1dGlvbkNvbnRleHQ6IGplc3QuZm4oKSxcbiAgc2V0RXhlY3V0aW9uVGltZW91dDogamVzdC5mbigpXG59O1xuXG5jb25zdCBtb2NrTG9nZ2VyID0ge1xuICBkZWJ1ZzogamVzdC5mbigpLFxuICBpbmZvOiBqZXN0LmZuKCksXG4gIHdhcm46IGplc3QuZm4oKSxcbiAgZXJyb3I6IGplc3QuZm4oKVxufTtcblxuY29uc3QgbW9ja01ldHJpY3NDb2xsZWN0b3IgPSB7XG4gIHJlY29yZFJlcXVlc3Q6IGplc3QuZm4oKSxcbiAgcmVjb3JkUmVzcG9uc2U6IGplc3QuZm4oKSxcbiAgcmVjb3JkTGF0ZW5jeTogamVzdC5mbigpLFxuICByZWNvcmRFcnJvcjogamVzdC5mbigpXG59O1xuXG5jb25zdCBtb2NrU2Vzc2lvbk1hbmFnZXIgPSB7XG4gIGdldFNlc3Npb246IGplc3QuZm4oKSxcbiAgY3JlYXRlU2Vzc2lvbjogamVzdC5mbigpLFxuICB1cGRhdGVBY3Rpdml0eTogamVzdC5mbigpLFxuICBpc1Nlc3Npb25BY3RpdmU6IGplc3QuZm4oKVxufTtcblxuLy8gPT09IENPTlRSQUNUIElOVEVSRkFDRVMgPT09XG5cbmludGVyZmFjZSBSZXF1ZXN0SGFuZGxlckNvbnRyYWN0IHtcbiAgaGFuZGxlUmVxdWVzdChyZXF1ZXN0OiBNQ1BSZXF1ZXN0LCBjb250ZXh0OiBNQ1BDb250ZXh0KTogUHJvbWlzZTxNQ1BSZXNwb25zZT47XG4gIGhhbmRsZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb246IE1DUE5vdGlmaWNhdGlvbiwgY29udGV4dDogTUNQQ29udGV4dCk6IFByb21pc2U8dm9pZD47XG4gIHNldFJlcXVlc3RUaW1lb3V0KHRpbWVvdXQ6IG51bWJlcik6IHZvaWQ7XG4gIGdldFJlcXVlc3RNZXRyaWNzKCk6IFJlcXVlc3RNZXRyaWNzO1xufVxuXG5pbnRlcmZhY2UgUmVxdWVzdE1ldHJpY3Mge1xuICB0b3RhbFJlcXVlc3RzOiBudW1iZXI7XG4gIHN1Y2Nlc3NmdWxSZXF1ZXN0czogbnVtYmVyO1xuICBmYWlsZWRSZXF1ZXN0czogbnVtYmVyO1xuICBhdmVyYWdlUmVzcG9uc2VUaW1lOiBudW1iZXI7XG4gIHRpbWVvdXRzOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBSZXNwb25zZUJ1aWxkZXJDb250cmFjdCB7XG4gIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShpZDogc3RyaW5nIHwgbnVtYmVyLCByZXN1bHQ6IHVua25vd24pOiBNQ1BSZXNwb25zZTtcbiAgY3JlYXRlRXJyb3JSZXNwb25zZShpZDogc3RyaW5nIHwgbnVtYmVyLCBlcnJvcjogTUNQRXJyb3IpOiBNQ1BSZXNwb25zZTtcbiAgY3JlYXRlTm90aWZpY2F0aW9uQWNrKG1ldGhvZDogc3RyaW5nKTogdm9pZDtcbn1cblxuaW50ZXJmYWNlIFJvdXRpbmdDb250cmFjdCB7XG4gIGFkZFJvdXRlKG1ldGhvZDogc3RyaW5nLCBoYW5kbGVyOiBSZXF1ZXN0SGFuZGxlcik6IHZvaWQ7XG4gIHJvdXRlUmVxdWVzdChyZXF1ZXN0OiBNQ1BSZXF1ZXN0LCBjb250ZXh0OiBNQ1BDb250ZXh0KTogUHJvbWlzZTxNQ1BSZXNwb25zZT47XG4gIHJvdXRlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbjogTUNQTm90aWZpY2F0aW9uLCBjb250ZXh0OiBNQ1BDb250ZXh0KTogUHJvbWlzZTx2b2lkPjtcbn1cblxudHlwZSBSZXF1ZXN0SGFuZGxlciA9IChwYXJhbXM6IHVua25vd24sIGNvbnRleHQ6IE1DUENvbnRleHQpID0+IFByb21pc2U8dW5rbm93bj47XG5cbi8vID09PSBNT0NLIElNUExFTUVOVEFUSU9OID09PVxuXG5jbGFzcyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIgaW1wbGVtZW50cyBSZXF1ZXN0SGFuZGxlckNvbnRyYWN0LCBSZXNwb25zZUJ1aWxkZXJDb250cmFjdCwgUm91dGluZ0NvbnRyYWN0IHtcbiAgcHJpdmF0ZSByZXF1ZXN0VGltZW91dCA9IDMwMDAwOyAvLyAzMCBzZWNvbmRzXG4gIHByaXZhdGUgbWV0cmljczogUmVxdWVzdE1ldHJpY3MgPSB7XG4gICAgdG90YWxSZXF1ZXN0czogMCxcbiAgICBzdWNjZXNzZnVsUmVxdWVzdHM6IDAsXG4gICAgZmFpbGVkUmVxdWVzdHM6IDAsXG4gICAgYXZlcmFnZVJlc3BvbnNlVGltZTogMCxcbiAgICB0aW1lb3V0czogMFxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcm91dGVyID0gbW9ja1JlcXVlc3RSb3V0ZXIsXG4gICAgcHJpdmF0ZSByZXNwb25zZUJ1aWxkZXIgPSBtb2NrUmVzcG9uc2VCdWlsZGVyLFxuICAgIHByaXZhdGUgdmFsaWRhdG9yID0gbW9ja1JlcXVlc3RWYWxpZGF0b3IsXG4gICAgcHJpdmF0ZSB0b29sRXhlY3V0b3IgPSBtb2NrVG9vbEV4ZWN1dG9yLFxuICAgIHByaXZhdGUgbG9nZ2VyID0gbW9ja0xvZ2dlcixcbiAgICBwcml2YXRlIG1ldHJpY3NDb2xsZWN0b3IgPSBtb2NrTWV0cmljc0NvbGxlY3RvcixcbiAgICBwcml2YXRlIHNlc3Npb25NYW5hZ2VyID0gbW9ja1Nlc3Npb25NYW5hZ2VyXG4gICkge31cblxuICBhc3luYyBoYW5kbGVSZXF1ZXN0KHJlcXVlc3Q6IE1DUFJlcXVlc3QsIGNvbnRleHQ6IE1DUENvbnRleHQpOiBQcm9taXNlPE1DUFJlc3BvbnNlPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLmxvZ2dlci5pbmZvKCdIYW5kbGluZyBNQ1AgcmVxdWVzdCcsIHsgXG4gICAgICBpZDogcmVxdWVzdC5pZCwgXG4gICAgICBtZXRob2Q6IHJlcXVlc3QubWV0aG9kLFxuICAgICAgc2Vzc2lvbklkOiBjb250ZXh0LnNlc3Npb25JZCBcbiAgICB9KTtcblxuICAgIHRoaXMubWV0cmljc0NvbGxlY3Rvci5yZWNvcmRSZXF1ZXN0KHJlcXVlc3QubWV0aG9kKTtcbiAgICB0aGlzLnNlc3Npb25NYW5hZ2VyLnVwZGF0ZUFjdGl2aXR5KGNvbnRleHQuc2Vzc2lvbklkKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBWYWxpZGF0ZSByZXF1ZXN0XG4gICAgICBjb25zdCB2YWxpZGF0aW9uID0gdGhpcy52YWxpZGF0b3IudmFsaWRhdGUocmVxdWVzdCk7XG4gICAgICBpZiAoIXZhbGlkYXRpb24udmFsaWQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JSZXNwb25zZSA9IHRoaXMuY3JlYXRlRXJyb3JSZXNwb25zZShyZXF1ZXN0LmlkLCB7XG4gICAgICAgICAgY29kZTogLTMyNjAyLFxuICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHBhcmFtcycsXG4gICAgICAgICAgZGF0YTogdmFsaWRhdGlvbi5lcnJvcnNcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlY29yZFJlcXVlc3RDb21wbGV0aW9uKHN0YXJ0VGltZSwgZmFsc2UpO1xuICAgICAgICByZXR1cm4gZXJyb3JSZXNwb25zZTtcbiAgICAgIH1cblxuICAgICAgLy8gUm91dGUgYW5kIGV4ZWN1dGUgcmVxdWVzdFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnJvdXRlUmVxdWVzdChyZXF1ZXN0LCBjb250ZXh0KTtcbiAgICAgIFxuICAgICAgdGhpcy5yZWNvcmRSZXF1ZXN0Q29tcGxldGlvbihzdGFydFRpbWUsIHRydWUpO1xuICAgICAgdGhpcy5sb2dnZXIuaW5mbygnUmVxdWVzdCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JywgeyBcbiAgICAgICAgaWQ6IHJlcXVlc3QuaWQsIFxuICAgICAgICBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZSBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ1JlcXVlc3QgaGFuZGxpbmcgZmFpbGVkJywgeyBcbiAgICAgICAgaWQ6IHJlcXVlc3QuaWQsIFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBlcnJvclJlc3BvbnNlID0gdGhpcy5jcmVhdGVFcnJvclJlc3BvbnNlKHJlcXVlc3QuaWQsIHtcbiAgICAgICAgY29kZTogLTMyNjAzLFxuICAgICAgICBtZXNzYWdlOiAnSW50ZXJuYWwgZXJyb3InLFxuICAgICAgICBkYXRhOiB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICB0aGlzLnJlY29yZFJlcXVlc3RDb21wbGV0aW9uKHN0YXJ0VGltZSwgZmFsc2UpO1xuICAgICAgcmV0dXJuIGVycm9yUmVzcG9uc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbjogTUNQTm90aWZpY2F0aW9uLCBjb250ZXh0OiBNQ1BDb250ZXh0KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5sb2dnZXIuZGVidWcoJ0hhbmRsaW5nIE1DUCBub3RpZmljYXRpb24nLCB7IFxuICAgICAgbWV0aG9kOiBub3RpZmljYXRpb24ubWV0aG9kLFxuICAgICAgc2Vzc2lvbklkOiBjb250ZXh0LnNlc3Npb25JZCBcbiAgICB9KTtcblxuICAgIHRoaXMuc2Vzc2lvbk1hbmFnZXIudXBkYXRlQWN0aXZpdHkoY29udGV4dC5zZXNzaW9uSWQpO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucm91dGVOb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBjb250ZXh0KTtcbiAgICAgIHRoaXMubG9nZ2VyLmRlYnVnKCdOb3RpZmljYXRpb24gaGFuZGxlZCBzdWNjZXNzZnVsbHknLCB7IG1ldGhvZDogbm90aWZpY2F0aW9uLm1ldGhvZCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoJ05vdGlmaWNhdGlvbiBoYW5kbGluZyBmYWlsZWQnLCB7IFxuICAgICAgICBtZXRob2Q6IG5vdGlmaWNhdGlvbi5tZXRob2QsIFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJvdXRlUmVxdWVzdChyZXF1ZXN0OiBNQ1BSZXF1ZXN0LCBjb250ZXh0OiBNQ1BDb250ZXh0KTogUHJvbWlzZTxNQ1BSZXNwb25zZT4ge1xuICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLnJvdXRlci5nZXRIYW5kbGVyKHJlcXVlc3QubWV0aG9kKTtcbiAgICBpZiAoIWhhbmRsZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gaGFuZGxlciBmb3VuZCBmb3IgbWV0aG9kOiAke3JlcXVlc3QubWV0aG9kfWApO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbXG4gICAgICBoYW5kbGVyKHJlcXVlc3QucGFyYW1zLCBjb250ZXh0KSxcbiAgICAgIHRoaXMuY3JlYXRlVGltZW91dFByb21pc2UoKVxuICAgIF0pO1xuXG4gICAgaWYgKHJlc3VsdCA9PT0gJ1RJTUVPVVQnKSB7XG4gICAgICB0aGlzLm1ldHJpY3MudGltZW91dHMrKztcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWVzdCB0aW1lb3V0Jyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlU3VjY2Vzc1Jlc3BvbnNlKHJlcXVlc3QuaWQsIHJlc3VsdCk7XG4gIH1cblxuICBhc3luYyByb3V0ZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb246IE1DUE5vdGlmaWNhdGlvbiwgY29udGV4dDogTUNQQ29udGV4dCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGhhbmRsZXIgPSB0aGlzLnJvdXRlci5nZXRIYW5kbGVyKG5vdGlmaWNhdGlvbi5tZXRob2QpO1xuICAgIGlmIChoYW5kbGVyKSB7XG4gICAgICBhd2FpdCBoYW5kbGVyKG5vdGlmaWNhdGlvbi5wYXJhbXMsIGNvbnRleHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvZ2dlci53YXJuKCdObyBoYW5kbGVyIGZvciBub3RpZmljYXRpb24nLCB7IG1ldGhvZDogbm90aWZpY2F0aW9uLm1ldGhvZCB9KTtcbiAgICB9XG4gIH1cblxuICBjcmVhdGVTdWNjZXNzUmVzcG9uc2UoaWQ6IHN0cmluZyB8IG51bWJlciwgcmVzdWx0OiB1bmtub3duKTogTUNQUmVzcG9uc2Uge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlQnVpbGRlci5idWlsZFN1Y2Nlc3NSZXNwb25zZShpZCwgcmVzdWx0KTtcbiAgfVxuXG4gIGNyZWF0ZUVycm9yUmVzcG9uc2UoaWQ6IHN0cmluZyB8IG51bWJlciwgZXJyb3I6IE1DUEVycm9yKTogTUNQUmVzcG9uc2Uge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNlQnVpbGRlci5idWlsZEVycm9yUmVzcG9uc2UoaWQsIGVycm9yKTtcbiAgfVxuXG4gIGNyZWF0ZU5vdGlmaWNhdGlvbkFjayhtZXRob2Q6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMubG9nZ2VyLmRlYnVnKCdOb3RpZmljYXRpb24gYWNrbm93bGVkZ2VkJywgeyBtZXRob2QgfSk7XG4gIH1cblxuICBhZGRSb3V0ZShtZXRob2Q6IHN0cmluZywgaGFuZGxlcjogUmVxdWVzdEhhbmRsZXIpOiB2b2lkIHtcbiAgICB0aGlzLnJvdXRlci5hZGRIYW5kbGVyKG1ldGhvZCwgaGFuZGxlcik7XG4gICAgdGhpcy5sb2dnZXIuZGVidWcoJ1JvdXRlIGFkZGVkJywgeyBtZXRob2QgfSk7XG4gIH1cblxuICBzZXRSZXF1ZXN0VGltZW91dCh0aW1lb3V0OiBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnJlcXVlc3RUaW1lb3V0ID0gdGltZW91dDtcbiAgfVxuXG4gIGdldFJlcXVlc3RNZXRyaWNzKCk6IFJlcXVlc3RNZXRyaWNzIHtcbiAgICByZXR1cm4geyAuLi50aGlzLm1ldHJpY3MgfTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVGltZW91dFByb21pc2UoKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHJlc29sdmUoJ1RJTUVPVVQnKSwgdGhpcy5yZXF1ZXN0VGltZW91dCk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIHJlY29yZFJlcXVlc3RDb21wbGV0aW9uKHN0YXJ0VGltZTogbnVtYmVyLCBzdWNjZXNzOiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIFxuICAgIHRoaXMubWV0cmljcy50b3RhbFJlcXVlc3RzKys7XG4gICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgIHRoaXMubWV0cmljcy5zdWNjZXNzZnVsUmVxdWVzdHMrKztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tZXRyaWNzLmZhaWxlZFJlcXVlc3RzKys7XG4gICAgfVxuICAgIFxuICAgIC8vIFVwZGF0ZSByb2xsaW5nIGF2ZXJhZ2VcbiAgICBjb25zdCB0b3RhbENvbXBsZXRlZCA9IHRoaXMubWV0cmljcy5zdWNjZXNzZnVsUmVxdWVzdHMgKyB0aGlzLm1ldHJpY3MuZmFpbGVkUmVxdWVzdHM7XG4gICAgdGhpcy5tZXRyaWNzLmF2ZXJhZ2VSZXNwb25zZVRpbWUgPSBcbiAgICAgICh0aGlzLm1ldHJpY3MuYXZlcmFnZVJlc3BvbnNlVGltZSAqICh0b3RhbENvbXBsZXRlZCAtIDEpICsgZHVyYXRpb24pIC8gdG90YWxDb21wbGV0ZWQ7XG4gICAgXG4gICAgdGhpcy5tZXRyaWNzQ29sbGVjdG9yLnJlY29yZExhdGVuY3koZHVyYXRpb24pO1xuICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgdGhpcy5tZXRyaWNzQ29sbGVjdG9yLnJlY29yZEVycm9yKCdyZXF1ZXN0X2ZhaWxlZCcpO1xuICAgIH1cbiAgfVxufVxuXG5kZXNjcmliZSgnTUNQIFJlcXVlc3QvUmVzcG9uc2UgSGFuZGxpbmcgLSBMb25kb24gVEREJywgKCkgPT4ge1xuICBcbiAgZGVzY3JpYmUoJ/Cfjq8gQWNjZXB0YW5jZSBUZXN0cyAtIFJlcXVlc3QgUHJvY2Vzc2luZycsICgpID0+IHtcbiAgICBcbiAgICBkZXNjcmliZSgnVXNlciBTdG9yeTogSGFuZGxlIFN0YW5kYXJkIE1DUCBSZXF1ZXN0cycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgcHJvY2VzcyB0b29scy9saXN0IHJlcXVlc3Qgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlIC0gTW9jayB0b29scy9saXN0IGhhbmRsaW5nXG4gICAgICAgIG1vY2tSZXF1ZXN0VmFsaWRhdG9yLnZhbGlkYXRlLm1vY2tSZXR1cm5WYWx1ZSh7IHZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdIH0pO1xuICAgICAgICBtb2NrUmVxdWVzdFJvdXRlci5nZXRIYW5kbGVyLm1vY2tSZXR1cm5WYWx1ZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvb2xzOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBuYW1lOiAndGVzdF90b29sJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgdG9vbCcsXG4gICAgICAgICAgICAgICAgaW5wdXRTY2hlbWE6IHsgdHlwZTogJ29iamVjdCcgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1vY2tSZXNwb25zZUJ1aWxkZXIuYnVpbGRTdWNjZXNzUmVzcG9uc2UubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICBpZDogJ3Rvb2xzLTEnLFxuICAgICAgICAgIHJlc3VsdDoge1xuICAgICAgICAgICAgdG9vbHM6IFt7XG4gICAgICAgICAgICAgIG5hbWU6ICd0ZXN0X3Rvb2wnLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgdG9vbCcsXG4gICAgICAgICAgICAgIGlucHV0U2NoZW1hOiB7IHR5cGU6ICdvYmplY3QnIH1cbiAgICAgICAgICAgIH1dXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbW9ja1Nlc3Npb25NYW5hZ2VyLnVwZGF0ZUFjdGl2aXR5Lm1vY2tSZXR1cm5WYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICAgIGNvbnN0IGhhbmRsZXIgPSBuZXcgTW9ja01DUFJlcXVlc3RIYW5kbGVyKCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0b29sc0xpc3RSZXF1ZXN0OiBNQ1BSZXF1ZXN0ID0ge1xuICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgIGlkOiAndG9vbHMtMScsXG4gICAgICAgICAgbWV0aG9kOiAndG9vbHMvbGlzdCcsXG4gICAgICAgICAgcGFyYW1zOiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNvbnRleHQ6IE1DUENvbnRleHQgPSB7XG4gICAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbi0xMjMnLFxuICAgICAgICAgIGxvZ2dlcjogbW9ja0xvZ2dlclxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAtIEhhbmRsZSB0b29scy9saXN0IHJlcXVlc3RcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyLmhhbmRsZVJlcXVlc3QodG9vbHNMaXN0UmVxdWVzdCwgY29udGV4dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IHJlcXVlc3QgcHJvY2Vzc2luZyBjb252ZXJzYXRpb25cbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ0hhbmRsaW5nIE1DUCByZXF1ZXN0JywgXG4gICAgICAgICAgeyBcbiAgICAgICAgICAgIGlkOiAndG9vbHMtMScsIFxuICAgICAgICAgICAgbWV0aG9kOiAndG9vbHMvbGlzdCcsXG4gICAgICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLTEyMycgXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBleHBlY3QobW9ja1JlcXVlc3RWYWxpZGF0b3IudmFsaWRhdGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHRvb2xzTGlzdFJlcXVlc3QpO1xuICAgICAgICBleHBlY3QobW9ja1JlcXVlc3RSb3V0ZXIuZ2V0SGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Rvb2xzL2xpc3QnKTtcbiAgICAgICAgZXhwZWN0KG1vY2tTZXNzaW9uTWFuYWdlci51cGRhdGVBY3Rpdml0eSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Nlc3Npb24tMTIzJyk7XG4gICAgICAgIGV4cGVjdChtb2NrTWV0cmljc0NvbGxlY3Rvci5yZWNvcmRSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndG9vbHMvbGlzdCcpO1xuICAgICAgICBleHBlY3QobW9ja1Jlc3BvbnNlQnVpbGRlci5idWlsZFN1Y2Nlc3NSZXNwb25zZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ3Rvb2xzLTEnLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgdG9vbHM6IGV4cGVjdC5hbnkoQXJyYXkpIH0pXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBleHBlY3QocmVzcG9uc2UuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5pZCkudG9CZSgndG9vbHMtMScpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcHJvY2VzcyB0b29scy9jYWxsIHJlcXVlc3Qgd2l0aCBwcm9wZXIgZXhlY3V0aW9uIGNvbnRleHQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIHRvb2xzL2NhbGwgaGFuZGxpbmdcbiAgICAgICAgbW9ja1JlcXVlc3RWYWxpZGF0b3IudmFsaWRhdGUubW9ja1JldHVyblZhbHVlKHsgdmFsaWQ6IHRydWUsIGVycm9yczogW10gfSk7XG4gICAgICAgIG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIubW9ja1JldHVyblZhbHVlKGFzeW5jIChwYXJhbXMsIGNvbnRleHQpID0+IHtcbiAgICAgICAgICAvLyBTaW11bGF0ZSB0b29sIGV4ZWN1dGlvblxuICAgICAgICAgIGNvbnN0IHRvb2xSZXN1bHQgPSBhd2FpdCBtb2NrVG9vbEV4ZWN1dG9yLmV4ZWN1dGUocGFyYW1zLm5hbWUsIHBhcmFtcy5hcmd1bWVudHMpO1xuICAgICAgICAgIHJldHVybiB0b29sUmVzdWx0O1xuICAgICAgICB9KTtcbiAgICAgICAgbW9ja1Rvb2xFeGVjdXRvci5leGVjdXRlLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICBjb250ZW50OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgdGV4dDogJ0FuYWx5c2lzIGNvbXBsZXRlOiBGb3VuZCA1IGlzc3VlcyBpbiBjb2RlYmFzZSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBtb2NrUmVzcG9uc2VCdWlsZGVyLmJ1aWxkU3VjY2Vzc1Jlc3BvbnNlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgaWQ6ICd0b29sLWNhbGwtMScsXG4gICAgICAgICAgcmVzdWx0OiB7XG4gICAgICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsXG4gICAgICAgICAgICAgIHRleHQ6ICdBbmFseXNpcyBjb21wbGV0ZTogRm91bmQgNSBpc3N1ZXMgaW4gY29kZWJhc2UnXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHRvb2xDYWxsUmVxdWVzdDogTUNQUmVxdWVzdCA9IHtcbiAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICBpZDogJ3Rvb2wtY2FsbC0xJyxcbiAgICAgICAgICBtZXRob2Q6ICd0b29scy9jYWxsJyxcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIG5hbWU6ICdhbmFseXplX2NvZGUnLFxuICAgICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICAgIGNvZGViYXNlOiAnL3BhdGgvdG8vcHJvamVjdCcsXG4gICAgICAgICAgICAgIGxhbmd1YWdlOiAndHlwZXNjcmlwdCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dDogTUNQQ29udGV4dCA9IHtcbiAgICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLTQ1NicsXG4gICAgICAgICAgYWdlbnRJZDogJ2FnZW50LTc4OScsXG4gICAgICAgICAgbG9nZ2VyOiBtb2NrTG9nZ2VyXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0IC0gSGFuZGxlIHRvb2wgY2FsbFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGhhbmRsZXIuaGFuZGxlUmVxdWVzdCh0b29sQ2FsbFJlcXVlc3QsIGNvbnRleHQpO1xuXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSB0b29sIGV4ZWN1dGlvbiBjb252ZXJzYXRpb25cbiAgICAgICAgZXhwZWN0KG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCd0b29scy9jYWxsJyk7XG4gICAgICAgIGV4cGVjdChtb2NrVG9vbEV4ZWN1dG9yLmV4ZWN1dGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdhbmFseXplX2NvZGUnLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvZGViYXNlOiAnL3BhdGgvdG8vcHJvamVjdCcsXG4gICAgICAgICAgICBsYW5ndWFnZTogJ3R5cGVzY3JpcHQnXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0LmNvbnRlbnRbMF0udGV4dCkudG9Db250YWluKCdBbmFseXNpcyBjb21wbGV0ZScpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnVXNlciBTdG9yeTogSGFuZGxlIFJlcXVlc3QgVmFsaWRhdGlvbiBFcnJvcnMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB2YWxpZGF0aW9uIGVycm9yIGZvciBpbnZhbGlkIHJlcXVlc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIHZhbGlkYXRpb24gZmFpbHVyZVxuICAgICAgICBtb2NrUmVxdWVzdFZhbGlkYXRvci52YWxpZGF0ZS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcnM6IFsnTWV0aG9kIGlzIHJlcXVpcmVkJywgJ0ludmFsaWQgSlNPTi1SUEMgZm9ybWF0J11cbiAgICAgICAgfSk7XG4gICAgICAgIG1vY2tSZXNwb25zZUJ1aWxkZXIuYnVpbGRFcnJvclJlc3BvbnNlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgaWQ6ICdpbnZhbGlkLTEnLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAtMzI2MDIsXG4gICAgICAgICAgICBtZXNzYWdlOiAnSW52YWxpZCBwYXJhbXMnLFxuICAgICAgICAgICAgZGF0YTogWydNZXRob2QgaXMgcmVxdWlyZWQnLCAnSW52YWxpZCBKU09OLVJQQyBmb3JtYXQnXVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGludmFsaWRSZXF1ZXN0OiBNQ1BSZXF1ZXN0ID0ge1xuICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgIGlkOiAnaW52YWxpZC0xJyxcbiAgICAgICAgICBtZXRob2Q6ICcnLCAvLyBJbnZhbGlkOiBlbXB0eSBtZXRob2RcbiAgICAgICAgICBwYXJhbXM6ICdpbnZhbGlkLXBhcmFtcycgLy8gSW52YWxpZDogc2hvdWxkIGJlIG9iamVjdFxuICAgICAgICB9IGFzIGFueTtcblxuICAgICAgICBjb25zdCBjb250ZXh0OiBNQ1BDb250ZXh0ID0ge1xuICAgICAgICAgIHNlc3Npb25JZDogJ3Nlc3Npb24tZXJyb3InLFxuICAgICAgICAgIGxvZ2dlcjogbW9ja0xvZ2dlclxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAtIEhhbmRsZSBpbnZhbGlkIHJlcXVlc3RcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyLmhhbmRsZVJlcXVlc3QoaW52YWxpZFJlcXVlc3QsIGNvbnRleHQpO1xuXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSB2YWxpZGF0aW9uIGVycm9yIGhhbmRsaW5nXG4gICAgICAgIGV4cGVjdChtb2NrUmVxdWVzdFZhbGlkYXRvci52YWxpZGF0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoaW52YWxpZFJlcXVlc3QpO1xuICAgICAgICBleHBlY3QobW9ja1Jlc3BvbnNlQnVpbGRlci5idWlsZEVycm9yUmVzcG9uc2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdpbnZhbGlkLTEnLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvZGU6IC0zMjYwMixcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHBhcmFtcycsXG4gICAgICAgICAgICBkYXRhOiBbJ01ldGhvZCBpcyByZXF1aXJlZCcsICdJbnZhbGlkIEpTT04tUlBDIGZvcm1hdCddXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5jb2RlKS50b0JlKC0zMjYwMik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWV0aG9kIG5vdCBmb3VuZCBlcnJvcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIG1ldGhvZCBub3QgZm91bmRcbiAgICAgICAgbW9ja1JlcXVlc3RWYWxpZGF0b3IudmFsaWRhdGUubW9ja1JldHVyblZhbHVlKHsgdmFsaWQ6IHRydWUsIGVycm9yczogW10gfSk7XG4gICAgICAgIG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIubW9ja1JldHVyblZhbHVlKG51bGwpOyAvLyBObyBoYW5kbGVyIGZvdW5kXG4gICAgICAgIG1vY2tSZXNwb25zZUJ1aWxkZXIuYnVpbGRFcnJvclJlc3BvbnNlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgaWQ6ICdub3QtZm91bmQtMScsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6IC0zMjYwMyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBlcnJvcicsXG4gICAgICAgICAgICBkYXRhOiB7IGVycm9yOiAnTm8gaGFuZGxlciBmb3VuZCBmb3IgbWV0aG9kOiB1bmtub3duL21ldGhvZCcgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVua25vd25NZXRob2RSZXF1ZXN0OiBNQ1BSZXF1ZXN0ID0ge1xuICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgIGlkOiAnbm90LWZvdW5kLTEnLFxuICAgICAgICAgIG1ldGhvZDogJ3Vua25vd24vbWV0aG9kJyxcbiAgICAgICAgICBwYXJhbXM6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dDogTUNQQ29udGV4dCA9IHtcbiAgICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLXVua25vd24nLFxuICAgICAgICAgIGxvZ2dlcjogbW9ja0xvZ2dlclxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAtIEhhbmRsZSB1bmtub3duIG1ldGhvZCByZXF1ZXN0XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlci5oYW5kbGVSZXF1ZXN0KHVua25vd25NZXRob2RSZXF1ZXN0LCBjb250ZXh0KTtcblxuICAgICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgbWV0aG9kIG5vdCBmb3VuZCBoYW5kbGluZ1xuICAgICAgICBleHBlY3QobW9ja1JlcXVlc3RSb3V0ZXIuZ2V0SGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Vua25vd24vbWV0aG9kJyk7XG4gICAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICAnUmVxdWVzdCBoYW5kbGluZyBmYWlsZWQnLFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgICAgICAgIGlkOiAnbm90LWZvdW5kLTEnLFxuICAgICAgICAgICAgZXJyb3I6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdObyBoYW5kbGVyIGZvdW5kJylcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5jb2RlKS50b0JlKC0zMjYwMyk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ/CflJQgQWNjZXB0YW5jZSBUZXN0cyAtIE5vdGlmaWNhdGlvbiBIYW5kbGluZycsICgpID0+IHtcbiAgICBcbiAgICBkZXNjcmliZSgnVXNlciBTdG9yeTogUHJvY2VzcyBNQ1AgTm90aWZpY2F0aW9ucycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG5vdGlmaWNhdGlvbnMgd2l0aG91dCByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZSAtIE1vY2sgbm90aWZpY2F0aW9uIGhhbmRsaW5nXG4gICAgICAgIG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIubW9ja1JldHVyblZhbHVlKGFzeW5jIChwYXJhbXMsIGNvbnRleHQpID0+IHtcbiAgICAgICAgICAvLyBTaW11bGF0ZSBub3RpZmljYXRpb24gcHJvY2Vzc2luZ1xuICAgICAgICAgIG1vY2tMb2dnZXIuaW5mbygnUHJvY2Vzc2luZyBub3RpZmljYXRpb24nLCB7IHBhcmFtcywgc2Vzc2lvbklkOiBjb250ZXh0LnNlc3Npb25JZCB9KTtcbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOyAvLyBOb3RpZmljYXRpb25zIGRvbid0IHJldHVybiByZXNwb25zZXNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGxvZ05vdGlmaWNhdGlvbjogTUNQTm90aWZpY2F0aW9uID0ge1xuICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgIG1ldGhvZDogJ25vdGlmaWNhdGlvbnMvbWVzc2FnZScsXG4gICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICBsZXZlbDogJ2luZm8nLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1Rhc2sgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgICAgICBsb2dnZXI6ICdhZ2VudC1leGVjdXRvcidcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dDogTUNQQ29udGV4dCA9IHtcbiAgICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLW5vdGlmaWNhdGlvbicsXG4gICAgICAgICAgbG9nZ2VyOiBtb2NrTG9nZ2VyXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0IC0gSGFuZGxlIG5vdGlmaWNhdGlvblxuICAgICAgICBhd2FpdCBoYW5kbGVyLmhhbmRsZU5vdGlmaWNhdGlvbihsb2dOb3RpZmljYXRpb24sIGNvbnRleHQpO1xuXG4gICAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSBub3RpZmljYXRpb24gcHJvY2Vzc2luZyBjb252ZXJzYXRpb25cbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZGVidWcpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdIYW5kbGluZyBNQ1Agbm90aWZpY2F0aW9uJyxcbiAgICAgICAgICB7IFxuICAgICAgICAgICAgbWV0aG9kOiAnbm90aWZpY2F0aW9ucy9tZXNzYWdlJyxcbiAgICAgICAgICAgIHNlc3Npb25JZDogJ3Nlc3Npb24tbm90aWZpY2F0aW9uJyBcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChtb2NrU2Vzc2lvbk1hbmFnZXIudXBkYXRlQWN0aXZpdHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzZXNzaW9uLW5vdGlmaWNhdGlvbicpO1xuICAgICAgICBleHBlY3QobW9ja1JlcXVlc3RSb3V0ZXIuZ2V0SGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ25vdGlmaWNhdGlvbnMvbWVzc2FnZScpO1xuICAgICAgICBleHBlY3QobW9ja0xvZ2dlci5kZWJ1ZykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ05vdGlmaWNhdGlvbiBoYW5kbGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgICAgeyBtZXRob2Q6ICdub3RpZmljYXRpb25zL21lc3NhZ2UnIH1cbiAgICAgICAgKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSBub3RpZmljYXRpb25zIGZvciB1bmtub3duIG1ldGhvZHMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZSAtIE1vY2sgdW5rbm93biBub3RpZmljYXRpb24gbWV0aG9kXG4gICAgICAgIG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIubW9ja1JldHVyblZhbHVlKG51bGwpOyAvLyBObyBoYW5kbGVyXG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHVua25vd25Ob3RpZmljYXRpb246IE1DUE5vdGlmaWNhdGlvbiA9IHtcbiAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICBtZXRob2Q6ICd1bmtub3duL25vdGlmaWNhdGlvbicsXG4gICAgICAgICAgcGFyYW1zOiB7IGRhdGE6ICd0ZXN0JyB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dDogTUNQQ29udGV4dCA9IHtcbiAgICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLXVua25vd24tbm90aWZpY2F0aW9uJyxcbiAgICAgICAgICBsb2dnZXI6IG1vY2tMb2dnZXJcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3QgLSBIYW5kbGUgdW5rbm93biBub3RpZmljYXRpb25cbiAgICAgICAgYXdhaXQgaGFuZGxlci5oYW5kbGVOb3RpZmljYXRpb24odW5rbm93bk5vdGlmaWNhdGlvbiwgY29udGV4dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IGdyYWNlZnVsIGhhbmRsaW5nIG9mIHVua25vd24gbm90aWZpY2F0aW9uc1xuICAgICAgICBleHBlY3QobW9ja1JlcXVlc3RSb3V0ZXIuZ2V0SGFuZGxlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3Vua25vd24vbm90aWZpY2F0aW9uJyk7XG4gICAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLndhcm4pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdObyBoYW5kbGVyIGZvciBub3RpZmljYXRpb24nLFxuICAgICAgICAgIHsgbWV0aG9kOiAndW5rbm93bi9ub3RpZmljYXRpb24nIH1cbiAgICAgICAgKTtcbiAgICAgICAgLy8gU2hvdWxkIG5vdCB0aHJvdyBlcnJvciBmb3IgdW5rbm93biBub3RpZmljYXRpb25zXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ+KPse+4jyBBY2NlcHRhbmNlIFRlc3RzIC0gVGltZW91dCBIYW5kbGluZycsICgpID0+IHtcbiAgICBcbiAgICBkZXNjcmliZSgnVXNlciBTdG9yeTogSGFuZGxlIFJlcXVlc3QgVGltZW91dHMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHRpbWVvdXQgbG9uZy1ydW5uaW5nIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlIC0gTW9jayBsb25nLXJ1bm5pbmcgcmVxdWVzdCB0aGF0IHRpbWVzIG91dFxuICAgICAgICBtb2NrUmVxdWVzdFZhbGlkYXRvci52YWxpZGF0ZS5tb2NrUmV0dXJuVmFsdWUoeyB2YWxpZDogdHJ1ZSwgZXJyb3JzOiBbXSB9KTtcbiAgICAgICAgbW9ja1JlcXVlc3RSb3V0ZXIuZ2V0SGFuZGxlci5tb2NrUmV0dXJuVmFsdWUoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIC8vIFNpbXVsYXRlIGxvbmctcnVubmluZyBvcGVyYXRpb24gdGhhdCBleGNlZWRzIHRpbWVvdXRcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7IC8vIFNob3J0IGRlbGF5IGZvciB0ZXN0XG4gICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiAnY29tcGxldGVkJyB9O1xuICAgICAgICB9KTtcbiAgICAgICAgbW9ja1Jlc3BvbnNlQnVpbGRlci5idWlsZEVycm9yUmVzcG9uc2UubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICBpZDogJ3RpbWVvdXQtMScsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6IC0zMjYwMyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBlcnJvcicsXG4gICAgICAgICAgICBkYXRhOiB7IGVycm9yOiAnUmVxdWVzdCB0aW1lb3V0JyB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoYW5kbGVyID0gbmV3IE1vY2tNQ1BSZXF1ZXN0SGFuZGxlcigpO1xuICAgICAgICBoYW5kbGVyLnNldFJlcXVlc3RUaW1lb3V0KDUwKTsgLy8gVmVyeSBzaG9ydCB0aW1lb3V0IGZvciB0ZXN0XG4gICAgICAgIFxuICAgICAgICBjb25zdCBsb25nUnVubmluZ1JlcXVlc3Q6IE1DUFJlcXVlc3QgPSB7XG4gICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgaWQ6ICd0aW1lb3V0LTEnLFxuICAgICAgICAgIG1ldGhvZDogJ2xvbmcvb3BlcmF0aW9uJyxcbiAgICAgICAgICBwYXJhbXM6IHsgZHVyYXRpb246IDEwMDAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGNvbnRleHQ6IE1DUENvbnRleHQgPSB7XG4gICAgICAgICAgc2Vzc2lvbklkOiAnc2Vzc2lvbi10aW1lb3V0JyxcbiAgICAgICAgICBsb2dnZXI6IG1vY2tMb2dnZXJcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3QgLSBIYW5kbGUgcmVxdWVzdCB0aGF0IHNob3VsZCB0aW1lb3V0XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlci5oYW5kbGVSZXF1ZXN0KGxvbmdSdW5uaW5nUmVxdWVzdCwgY29udGV4dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0IC0gVmVyaWZ5IHRpbWVvdXQgaGFuZGxpbmdcbiAgICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdSZXF1ZXN0IGhhbmRsaW5nIGZhaWxlZCcsXG4gICAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgICAgaWQ6ICd0aW1lb3V0LTEnLFxuICAgICAgICAgICAgZXJyb3I6ICdSZXF1ZXN0IHRpbWVvdXQnXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IuZGF0YS5lcnJvcikudG9CZSgnUmVxdWVzdCB0aW1lb3V0Jyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBtZXRyaWNzID0gaGFuZGxlci5nZXRSZXF1ZXN0TWV0cmljcygpO1xuICAgICAgICBleHBlY3QobWV0cmljcy50aW1lb3V0cykudG9CZSgxKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn8J+UlyBDb250cmFjdCBWZXJpZmljYXRpb24gLSBSZXNwb25zZSBCdWlsZGluZycsICgpID0+IHtcbiAgICBcbiAgICBkZXNjcmliZSgnUmVzcG9uc2UgQ29uc3RydWN0aW9uJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBidWlsZCBwcm9wZXIgc3VjY2VzcyByZXNwb25zZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIHJlc3BvbnNlIGJ1aWxkaW5nXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkUmVzdWx0ID0geyBzdGF0dXM6ICdzdWNjZXNzJywgZGF0YTogeyBjb3VudDogNDIgfSB9O1xuICAgICAgICBtb2NrUmVzcG9uc2VCdWlsZGVyLmJ1aWxkU3VjY2Vzc1Jlc3BvbnNlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgaWQ6ICdzdWNjZXNzLTEnLFxuICAgICAgICAgIHJlc3VsdDogZXhwZWN0ZWRSZXN1bHRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgaGFuZGxlciA9IG5ldyBNb2NrTUNQUmVxdWVzdEhhbmRsZXIoKTtcblxuICAgICAgICAvLyBBY3QgLSBCdWlsZCBzdWNjZXNzIHJlc3BvbnNlXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gaGFuZGxlci5jcmVhdGVTdWNjZXNzUmVzcG9uc2UoJ3N1Y2Nlc3MtMScsIGV4cGVjdGVkUmVzdWx0KTtcblxuICAgICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgc3VjY2VzcyByZXNwb25zZSBjb25zdHJ1Y3Rpb25cbiAgICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZUJ1aWxkZXIuYnVpbGRTdWNjZXNzUmVzcG9uc2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgICdzdWNjZXNzLTEnLFxuICAgICAgICAgIGV4cGVjdGVkUmVzdWx0XG4gICAgICAgICk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5qc29ucnBjKS50b0JlKCcyLjAnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmlkKS50b0JlKCdzdWNjZXNzLTEnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnJlc3VsdCkudG9FcXVhbChleHBlY3RlZFJlc3VsdCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBidWlsZCBwcm9wZXIgZXJyb3IgcmVzcG9uc2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlIC0gTW9jayBlcnJvciByZXNwb25zZSBidWlsZGluZ1xuICAgICAgICBjb25zdCBlcnJvckRldGFpbHM6IE1DUEVycm9yID0ge1xuICAgICAgICAgIGNvZGU6IC0zMjAwMCxcbiAgICAgICAgICBtZXNzYWdlOiAnU2VydmVyIGVycm9yJyxcbiAgICAgICAgICBkYXRhOiB7IGNvbnRleHQ6ICdkYXRhYmFzZSBjb25uZWN0aW9uIGZhaWxlZCcgfVxuICAgICAgICB9O1xuICAgICAgICBtb2NrUmVzcG9uc2VCdWlsZGVyLmJ1aWxkRXJyb3JSZXNwb25zZS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgIGlkOiAnZXJyb3ItMScsXG4gICAgICAgICAgZXJyb3I6IGVycm9yRGV0YWlsc1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBoYW5kbGVyID0gbmV3IE1vY2tNQ1BSZXF1ZXN0SGFuZGxlcigpO1xuXG4gICAgICAgIC8vIEFjdCAtIEJ1aWxkIGVycm9yIHJlc3BvbnNlXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gaGFuZGxlci5jcmVhdGVFcnJvclJlc3BvbnNlKCdlcnJvci0xJywgZXJyb3JEZXRhaWxzKTtcblxuICAgICAgICAvLyBBc3NlcnQgLSBWZXJpZnkgZXJyb3IgcmVzcG9uc2UgY29uc3RydWN0aW9uXG4gICAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2VCdWlsZGVyLmJ1aWxkRXJyb3JSZXNwb25zZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICAgJ2Vycm9yLTEnLFxuICAgICAgICAgIGVycm9yRGV0YWlsc1xuICAgICAgICApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5pZCkudG9CZSgnZXJyb3ItMScpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IpLnRvRXF1YWwoZXJyb3JEZXRhaWxzKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgn8J+nqiBMb25kb24gU2Nob29sIFBhdHRlcm5zIC0gUmVxdWVzdCBMaWZlY3ljbGUnLCAoKSA9PiB7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCBkZW1vbnN0cmF0ZSBjb21wbGV0ZSByZXF1ZXN0L3Jlc3BvbnNlIGxpZmVjeWNsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2UgLSBNb2NrIGNvbXBsZXRlIHJlcXVlc3QgbGlmZWN5Y2xlXG4gICAgICBtb2NrUmVxdWVzdFZhbGlkYXRvci52YWxpZGF0ZS5tb2NrUmV0dXJuVmFsdWUoeyB2YWxpZDogdHJ1ZSwgZXJyb3JzOiBbXSB9KTtcbiAgICAgIG1vY2tSZXF1ZXN0Um91dGVyLmdldEhhbmRsZXIubW9ja1JldHVyblZhbHVlKGFzeW5jIChwYXJhbXMsIGNvbnRleHQpID0+IHtcbiAgICAgICAgcmV0dXJuIHsgcHJvY2Vzc2VkOiB0cnVlLCBzZXNzaW9uSWQ6IGNvbnRleHQuc2Vzc2lvbklkIH07XG4gICAgICB9KTtcbiAgICAgIG1vY2tSZXNwb25zZUJ1aWxkZXIuYnVpbGRTdWNjZXNzUmVzcG9uc2UubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiAnbGlmZWN5Y2xlLTEnLFxuICAgICAgICByZXN1bHQ6IHsgcHJvY2Vzc2VkOiB0cnVlLCBzZXNzaW9uSWQ6ICdzZXNzaW9uLWxpZmVjeWNsZScgfVxuICAgICAgfSk7XG4gICAgICBtb2NrU2Vzc2lvbk1hbmFnZXIudXBkYXRlQWN0aXZpdHkubW9ja1JldHVyblZhbHVlKHVuZGVmaW5lZCk7XG5cbiAgICAgIGNvbnN0IGhhbmRsZXIgPSBuZXcgTW9ja01DUFJlcXVlc3RIYW5kbGVyKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IGxpZmVjeWNsZVJlcXVlc3Q6IE1DUFJlcXVlc3QgPSB7XG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogJ2xpZmVjeWNsZS0xJyxcbiAgICAgICAgbWV0aG9kOiAndGVzdC9saWZlY3ljbGUnLFxuICAgICAgICBwYXJhbXM6IHsgdGVzdDogdHJ1ZSB9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBjb250ZXh0OiBNQ1BDb250ZXh0ID0ge1xuICAgICAgICBzZXNzaW9uSWQ6ICdzZXNzaW9uLWxpZmVjeWNsZScsXG4gICAgICAgIGxvZ2dlcjogbW9ja0xvZ2dlclxuICAgICAgfTtcblxuICAgICAgLy8gQWN0IC0gUHJvY2VzcyBjb21wbGV0ZSByZXF1ZXN0IGxpZmVjeWNsZVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyLmhhbmRsZVJlcXVlc3QobGlmZWN5Y2xlUmVxdWVzdCwgY29udGV4dCk7XG5cbiAgICAgIC8vIEFzc2VydCAtIFZlcmlmeSBjb21wbGV0ZSBsaWZlY3ljbGUgY29udmVyc2F0aW9uIChMb25kb24gU2Nob29sIGZvY3VzKVxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgICdIYW5kbGluZyBNQ1AgcmVxdWVzdCcsXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgaWQ6ICdsaWZlY3ljbGUtMScsIG1ldGhvZDogJ3Rlc3QvbGlmZWN5Y2xlJyB9KVxuICAgICAgKTtcbiAgICAgIGV4cGVjdChtb2NrTWV0cmljc0NvbGxlY3Rvci5yZWNvcmRSZXF1ZXN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC9saWZlY3ljbGUnKTtcbiAgICAgIGV4cGVjdChtb2NrU2Vzc2lvbk1hbmFnZXIudXBkYXRlQWN0aXZpdHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdzZXNzaW9uLWxpZmVjeWNsZScpO1xuICAgICAgZXhwZWN0KG1vY2tSZXF1ZXN0VmFsaWRhdG9yLnZhbGlkYXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChsaWZlY3ljbGVSZXF1ZXN0KTtcbiAgICAgIGV4cGVjdChtb2NrUmVxdWVzdFJvdXRlci5nZXRIYW5kbGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgndGVzdC9saWZlY3ljbGUnKTtcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2VCdWlsZGVyLmJ1aWxkU3VjY2Vzc1Jlc3BvbnNlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgJ2xpZmVjeWNsZS0xJyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBwcm9jZXNzZWQ6IHRydWUgfSlcbiAgICAgICk7XG4gICAgICBleHBlY3QobW9ja01ldHJpY3NDb2xsZWN0b3IucmVjb3JkTGF0ZW5jeSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LmFueShOdW1iZXIpKTtcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAnUmVxdWVzdCBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyBpZDogJ2xpZmVjeWNsZS0xJyB9KVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJlc3BvbnNlLnJlc3VsdC5wcm9jZXNzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBoYW5kbGVyLmdldFJlcXVlc3RNZXRyaWNzKCk7XG4gICAgICBleHBlY3QobWV0cmljcy50b3RhbFJlcXVlc3RzKS50b0JlKDEpO1xuICAgICAgZXhwZWN0KG1ldHJpY3Muc3VjY2Vzc2Z1bFJlcXVlc3RzKS50b0JlKDEpO1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBDbGVhbiB0ZXN0IGlzb2xhdGlvbiAtIExvbmRvbiBTY2hvb2wgcHJpbmNpcGxlXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcbiAgXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgamVzdC5yZXN0b3JlQWxsTW9ja3MoKTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=