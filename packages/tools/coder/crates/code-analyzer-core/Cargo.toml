[package]
name = "code-analyzer-core"
version = "0.1.0"
authors = ["claude-code-zen Team"]
edition = "2021"
license = "MIT OR Apache-2.0"
description = "Core code analysis and intelligence engine"

[dependencies]
# Workspace dependencies
serde = { workspace = true }
serde_json = { workspace = true }
thiserror = { workspace = true }
anyhow = { workspace = true }
tokio = { workspace = true, features = ["fs", "io-util", "process"] }

# File system and path handling
walkdir = { workspace = true }
ignore = { workspace = true }
glob = { workspace = true }

# Text processing
regex = { workspace = true }
aho-corasick = { workspace = true }
memchr = { workspace = true }

# AST parsing
tree-sitter = { workspace = true }
tree-sitter-rust = { workspace = true }
tree-sitter-typescript = { workspace = true }
tree-sitter-javascript = { workspace = true }
tree-sitter-python = { workspace = true }
tree-sitter-go = { workspace = true }

# Parallel processing
rayon = { workspace = true }

# Collections and data structures
indexmap = { workspace = true }
dashmap = { workspace = true }

# Database dependencies (for code analysis storage)
rusqlite = { workspace = true }
tempfile = { workspace = true }
chrono = { workspace = true, features = ["serde"] }

# ML and analysis
levenshtein = { workspace = true }
md5 = "0.7"
num_cpus = "1.16"

# Logging and tracing
tracing = { workspace = true }
uuid = { workspace = true }

# File system watching
notify = "6.1"

# Metrics and monitoring
metrics = "0.21"
parking_lot = "0.12"

# ML Dependencies - Production Ready (optional, lightweight for compatibility)
linfa = { version = "0.7", optional = true }
linfa-clustering = { version = "0.7", optional = true }
linfa-preprocessing = { version = "0.7", optional = true }
statrs = { version = "0.17", optional = true }

# Quality gates integration
quality-gates = { path = "../quality-gates" }

[features]
default = ["sqlite", "ml"]
sqlite = []
ml = ["linfa", "linfa-clustering", "linfa-preprocessing", "statrs"]

[lib]
name = "code_analyzer_core"
crate-type = ["rlib"]

[dev-dependencies]
criterion = { workspace = true }
tokio-test = { workspace = true }